(function(){var t={35358:function(t,e,n){var s={"./af":22190,"./af.js":22190,"./ar":7218,"./ar-dz":85785,"./ar-dz.js":85785,"./ar-kw":29417,"./ar-kw.js":29417,"./ar-ly":56904,"./ar-ly.js":56904,"./ar-ma":98617,"./ar-ma.js":98617,"./ar-ps":91318,"./ar-ps.js":91318,"./ar-sa":82699,"./ar-sa.js":82699,"./ar-tn":36789,"./ar-tn.js":36789,"./ar.js":7218,"./az":23050,"./az.js":23050,"./be":8316,"./be.js":8316,"./bg":70310,"./bg.js":70310,"./bm":58884,"./bm.js":58884,"./bn":83469,"./bn-bd":46672,"./bn-bd.js":46672,"./bn.js":83469,"./bo":39118,"./bo.js":39118,"./br":13113,"./br.js":13113,"./bs":23626,"./bs.js":23626,"./ca":40921,"./ca.js":40921,"./cs":17799,"./cs.js":17799,"./cv":12828,"./cv.js":12828,"./cy":93521,"./cy.js":93521,"./da":56962,"./da.js":56962,"./de":93294,"./de-at":16158,"./de-at.js":16158,"./de-ch":95960,"./de-ch.js":95960,"./de.js":93294,"./dv":47963,"./dv.js":47963,"./el":3432,"./el.js":3432,"./en-au":20998,"./en-au.js":20998,"./en-ca":15931,"./en-ca.js":15931,"./en-gb":45930,"./en-gb.js":45930,"./en-ie":58081,"./en-ie.js":58081,"./en-il":71594,"./en-il.js":71594,"./en-in":23904,"./en-in.js":23904,"./en-nz":1507,"./en-nz.js":1507,"./en-sg":19409,"./en-sg.js":19409,"./eo":22177,"./eo.js":22177,"./es":84805,"./es-do":39155,"./es-do.js":39155,"./es-mx":69791,"./es-mx.js":69791,"./es-us":76098,"./es-us.js":76098,"./es.js":84805,"./et":96240,"./et.js":96240,"./eu":20391,"./eu.js":20391,"./fa":20612,"./fa.js":20612,"./fi":4220,"./fi.js":4220,"./fil":65570,"./fil.js":65570,"./fo":5466,"./fo.js":5466,"./fr":14461,"./fr-ca":66306,"./fr-ca.js":66306,"./fr-ch":27081,"./fr-ch.js":27081,"./fr.js":14461,"./fy":73484,"./fy.js":73484,"./ga":76957,"./ga.js":76957,"./gd":72978,"./gd.js":72978,"./gl":89866,"./gl.js":89866,"./gom-deva":65011,"./gom-deva.js":65011,"./gom-latn":84724,"./gom-latn.js":84724,"./gu":71601,"./gu.js":71601,"./he":79802,"./he.js":79802,"./hi":9358,"./hi.js":9358,"./hr":13907,"./hr.js":13907,"./hu":10218,"./hu.js":10218,"./hy-am":20533,"./hy-am.js":20533,"./id":52844,"./id.js":52844,"./is":97353,"./is.js":97353,"./it":6364,"./it-ch":20774,"./it-ch.js":20774,"./it.js":6364,"./ja":6008,"./ja.js":6008,"./jv":68221,"./jv.js":68221,"./ka":92417,"./ka.js":92417,"./kk":42071,"./kk.js":42071,"./km":76149,"./km.js":76149,"./kn":94572,"./kn.js":94572,"./ko":60659,"./ko.js":60659,"./ku":66285,"./ku-kmr":59398,"./ku-kmr.js":59398,"./ku.js":66285,"./ky":81609,"./ky.js":81609,"./lb":119,"./lb.js":119,"./lo":81748,"./lo.js":81748,"./lt":71973,"./lt.js":71973,"./lv":81347,"./lv.js":81347,"./me":53023,"./me.js":53023,"./mi":65747,"./mi.js":65747,"./mk":64341,"./mk.js":64341,"./ml":63840,"./ml.js":63840,"./mn":62058,"./mn.js":62058,"./mr":19182,"./mr.js":19182,"./ms":45197,"./ms-my":89136,"./ms-my.js":89136,"./ms.js":45197,"./mt":36408,"./mt.js":36408,"./my":51683,"./my.js":51683,"./nb":53141,"./nb.js":53141,"./ne":29344,"./ne.js":29344,"./nl":44703,"./nl-be":84641,"./nl-be.js":84641,"./nl.js":44703,"./nn":79873,"./nn.js":79873,"./oc-lnc":61217,"./oc-lnc.js":61217,"./pa-in":24612,"./pa-in.js":24612,"./pl":24457,"./pl.js":24457,"./pt":1089,"./pt-br":79146,"./pt-br.js":79146,"./pt.js":1089,"./ro":45950,"./ro.js":45950,"./ru":27292,"./ru.js":27292,"./sd":56774,"./sd.js":56774,"./se":87493,"./se.js":87493,"./si":3761,"./si.js":3761,"./sk":49711,"./sk.js":49711,"./sl":88558,"./sl.js":88558,"./sq":8633,"./sq.js":8633,"./sr":90688,"./sr-cyrl":47903,"./sr-cyrl.js":47903,"./sr.js":90688,"./ss":31991,"./ss.js":31991,"./sv":27020,"./sv.js":27020,"./sw":15891,"./sw.js":15891,"./ta":45714,"./ta.js":45714,"./te":30206,"./te.js":30206,"./tet":24768,"./tet.js":24768,"./tg":28276,"./tg.js":28276,"./th":57977,"./th.js":57977,"./tk":56928,"./tk.js":56928,"./tl-ph":8046,"./tl-ph.js":8046,"./tlh":41361,"./tlh.js":41361,"./tr":64367,"./tr.js":64367,"./tzl":10627,"./tzl.js":10627,"./tzm":12636,"./tzm-latn":98148,"./tzm-latn.js":98148,"./tzm.js":12636,"./ug-cn":68823,"./ug-cn.js":68823,"./uk":40461,"./uk.js":40461,"./ur":41366,"./ur.js":41366,"./uz":83454,"./uz-latn":18374,"./uz-latn.js":18374,"./uz.js":83454,"./vi":78572,"./vi.js":78572,"./x-pseudo":80464,"./x-pseudo.js":80464,"./yo":93709,"./yo.js":93709,"./zh-cn":65873,"./zh-cn.js":65873,"./zh-hk":17549,"./zh-hk.js":17549,"./zh-mo":52240,"./zh-mo.js":52240,"./zh-tw":90405,"./zh-tw.js":90405};function l(t){var e=a(t);return n(e)}function a(t){if(!n.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}l.keys=function(){return Object.keys(s)},l.resolve=a,t.exports=l,l.id=35358},47930:function(t,e){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.completeCellSelection=e.completeSpecification=e.ValueType=void 0,function(t){t["String"]="TableTidier.String",t["Number"]="TableTidier.Number",t["None"]="TableTidier.None"}(n||(n={})),e.ValueType=n;const s=1,l=1,a="current",i="topLeft",o=0,r=0,c=null,u=null,f="top",d="cellValue",p=[],h=n.String,b=null;function m(t){return{referenceAreaLayer:t.referenceAreaLayer||a,referenceAreaPosi:t.referenceAreaPosi||i,xOffset:t.xOffset||o,yOffset:t.yOffset||r}}function v(t){const e=m(t);return Object.assign(Object.assign({},e),{valueCstr:t.valueCstr||h})}function g(t){return{position:t.position||f,targetCol:t.targetCol||d}}function y(t){var e,n,a,i,o,r;return{startCell:m(t.startCell),size:{width:void 0===(null===(e=t.size)||void 0===e?void 0:e.width)?s:t.size.width,height:void 0===(null===(n=t.size)||void 0===n?void 0:n.height)?l:t.size.height},constraints:(null===(a=t.constraints)||void 0===a?void 0:a.map(v))||[],traverse:{xDirection:void 0===(null===(i=t.traverse)||void 0===i?void 0:i.xDirection)?c:t.traverse.xDirection,yDirection:void 0===(null===(o=t.traverse)||void 0===o?void 0:o.yDirection)?u:t.traverse.yDirection},transform:t.transform?{context:t.transform.context?g(t.transform.context):null,targetCols:t.transform.targetCols||p}:null,fill:void 0===t.fill?b:t.fill,children:(null===(r=t.children)||void 0===r?void 0:r.map(y))||[]}}function j(t){return y(t)}e.completeCellSelection=m,e.completeSpecification=j},92838:function(t,e,n){"use strict";n(44114),e.LR=e.NM=void 0;const s=n(47930),l=n(99160);function a(t,e,n){let s=t.map(((t,e)=>({value:t,index:e})));s.sort(((t,e)=>"asc"===n?t.value-e.value:e.value-t.value));let l=s.map((t=>e[t.index]));return l}function i(t){const e=new WeakSet;return JSON.stringify(t,(function(t,n){if("object"===typeof n&&null!==n){if(e.has(n))return`[Circular reference: ${t}]`;e.add(n)}return n}),2)}e.NM=a;const o=(t,e)=>"function"===typeof e.valueCstr?e.valueCstr(t):e.valueCstr===s.ValueType.String?"string"===typeof t&&""!==t&&isNaN(Number(t)):e.valueCstr===s.ValueType.Number?"number"===typeof t||"string"===typeof t&&""!==t&&!isNaN(Number(t)):e.valueCstr===s.ValueType.None?null===t||""===t:t===e.valueCstr,r=(t,e,n)=>"number"===typeof t?t:t(e,n),c=(t,e,n)=>{let s=e;if("current"===t.referenceAreaLayer)s=e;else if("root"===t.referenceAreaLayer)s=n;else if("parent"===t.referenceAreaLayer)s=e.parent;else{const n=e.areaLayer-t.referenceAreaLayer(e);for(let t=0;t<n;t++)s=s.parent}let a={x:s.x+r(t.xOffset,e,n),y:s.y+r(t.yOffset,e,n)};if("bottomLeft"===t.referenceAreaPosi?a.y+=s.height-1:"topRight"===t.referenceAreaPosi?a.x+=s.width-1:"bottomRight"===t.referenceAreaPosi&&(a.x+=s.width-1,a.y+=s.height-1),a.x<0||a.y<0||a.x>=n.width||a.y>=n.height)throw new l.CustomError(`Invalid cell selection:\n Table size is (width: ${n.width}, height: ${n.height}), Position (${a.x}, ${a.y}) is out of bounds.`,"OutOfBoundsError");return Object.assign(Object.assign({},a),{value:n.areaTbl[a.y][a.x]})},u=(t,e,n,s)=>"number"===typeof t?t:"toParentX"===t?s.width-e:"toParentY"===t?s.height-n:1,f=(t,e,n,s,l)=>{const a=[];for(let i=n;i<n+l;i++){const n=t[i].slice(e,e+s);a.push(n)}return a},d=(t,e)=>{if(null===e)return;const n=Math.max(...Object.values(t).map((t=>t.length)));for(const s in t){const l=t[s],a="forward"===e?l[l.length-1]:{x:-1,y:-1,value:e};while(l.length<n)l.push(a)}},p=(t,e,n,s,l,a,i,o,r,c,u)=>{let f=e,d=e+a-1,p=n,b=n+i-1,m=null;while(b<=l){const n=b-p+1;while(d<=s){const e=d-f+1;if(m=h(t,f,p,e,n,o,r,c,u),null===m)d+=1,null!=t.size.width?f+=1:d===s&&(f+=1,d=f);else{if(o.instanceIndex+=1,null===t.traverse.xDirection)break;o.xIndex+=1,f+=e,d=f+a-1}}if(o.xIndex=0,null===m)b+=1,null!=t.size.height?p+=1:b===l&&(p+=1,b=p);else{if(null===t.traverse.yDirection)break;o.yIndex+=1,p+=n,b=p+i-1}f=e,d=e+a-1}},h=(t,e,n,s,l,a,i,r,u)=>{let d=i.x+e,p=i.y+n;if("current"!==t.startCell.referenceAreaLayer){const e=c(t.startCell,i,r);if(null===e)return null;d=e.x,p=e.y}const h={parent:i,areaLayer:i.areaLayer+1,templateRef:a.templateRef.slice(),instanceIndex:a.instanceIndex,xIndex:a.xIndex,yIndex:a.yIndex,xOffset:e,yOffset:n,x:d,y:p,width:s,height:l,areaTbl:f(r.areaTbl,d,p,s,l),children:[]};for(let f of t.constraints){const t=c(f,h,r);if(null===t)return null;if(!o(t.value,f))return null}return i.children.push(h),b(t,h,r,u),h},b=(t,e,n,l)=>{const a=e.areaTbl.flat();if(t.transform){const i=t.transform.context,o=[],r=[];if(i){const t=[];if("top"===i.position)e.areaTbl.forEach(((e,n)=>{e.forEach(((e,l)=>{t.push([(0,s.completeCellSelection)({xOffset:l,yOffset:n-1})])}))}));else if("bottom"===i.position)e.areaTbl.forEach(((e,n)=>{e.forEach(((e,l)=>{t.push([(0,s.completeCellSelection)({xOffset:l,yOffset:n+1})])}))}));else if("left"===i.position)e.areaTbl.forEach(((e,n)=>{e.forEach(((e,l)=>{t.push([(0,s.completeCellSelection)({xOffset:l-1,yOffset:n})])}))}));else if("right"===i.position)e.areaTbl.forEach(((e,n)=>{e.forEach(((e,l)=>{t.push([(0,s.completeCellSelection)({xOffset:l+1,yOffset:n})])}))}));else{const l=i.position;e.areaTbl.forEach(((a,i)=>{a.forEach(((a,o)=>{const r=l({xOffset:o,yOffset:i,value:a},e,n),c=r.map((t=>(0,s.completeCellSelection)(t)));t.push(c)}))}))}if(t.length>0&&t[0].length>0?t.forEach((t=>{const s=[];t.forEach((t=>{const l=c(t,e,n);if(null===l)return null;s.push(l)})),r.push(s)})):console.log("No context cells found"),"cellValue"===i.targetCol)r.forEach((t=>{o.push(void 0===t[0].value?null:t[0].value.toString())}));else{const t=i.targetCol;r.forEach((e=>{o.push(t(e))}))}}let u;u="object"===typeof t.transform.targetCols?t.transform.targetCols:"context"===t.transform.targetCols?o:t.transform.targetCols(e.areaTbl),u.forEach(((t,n)=>{if(t){const s={x:e.x+n%e.width,y:e.y+Math.floor(n/e.width),value:a[n]};l.hasOwnProperty(t)?l[t].push(s):l[t]=[s]}}))}},m=(t,e,n,s,l=0)=>{const a={templateRef:[...e.templateRef,l],instanceIndex:0,xIndex:0,yIndex:0},i=t.traverse.xDirection,o=t.traverse.yDirection,r=c(t.startCell,e,n);if(null===r)return null;const f=r.x-e.x,h=r.y-e.y,b=u(t.size.width,f,h,e),v=u(t.size.height,f,h,e);let g,y,j,w;if("before"===i?(g=0,j=f):"after"===i?(g=f,j=e.width-1):"whole"===i?(g=0,j=e.width-1):(g=f,j=null===t.size.width?e.width-1:g+b-1),"before"===o?(y=0,w=h):"after"===o?(y=h,w=e.height-1):"whole"===o?(y=0,w=e.height-1):(y=h,w=null===t.size.height?e.height-1:y+v-1),p(t,g,y,j,w,b,v,a,e,n,s),t.children.length>0&&e.children.length>0)if(null===t.transform)for(let c of e.children)t.children.forEach(((t,e)=>{m(t,c,n,s,e)})),null===t.fill&&t.children.length>1?d(s,""):d(s,t.fill);else for(let c of t.children)e.children.forEach(((t,e)=>{m(c,t,n,s,e)})),null===t.fill?d(s,""):d(s,t.fill)};function v(t,e){const n=(0,s.completeSpecification)(e),l={parent:null,areaLayer:0,templateRef:[],instanceIndex:0,xIndex:0,yIndex:0,xOffset:0,yOffset:0,x:0,y:0,width:t[0].length,height:t.length,areaTbl:t,children:[]},a={};return m(n,l,l,a),{rootArea:l,tidyData:a}}e.LR=v},27320:function(t,e,n){"use strict";var s=n(45130),l=n(56768);const a={class:"wrapper"};function i(t,e,n,s,i,o){const r=(0,l.g2)("panel-view");return(0,l.uX)(),(0,l.CE)("div",a,[(0,l.bF)(r)])}var o=n(90144),r=(n(44114),n(14603),n(47566),n(98721),n(30328)),c=(n(19830),n(78945)),u=n(8153),f=n(93367),d=n(14206),p=n(47930),h=n(92838),b=n(99160),m=n(17844),v=n(8230);const g={"posi-mapping":{fill:"#37bc6c",stroke:"#37bc6c",text:"#fff"},"ambiguous-cell":{fill:"#83e4aa",stroke:"#83e4aa",text:"#e91010"},"determined-cell":{fill:"#37bc6c",stroke:"#37bc6c",text:"#e91010",weight:"bold"},default:{fill:"#f9f7ff",stroke:"#cccccc",text:"#000"}},y=(0,f.nY)("table",{state(){return{caseList:["case1","case2","case3","case4","case5"],currentCase:"",caseData:{},editor:{mapping_spec:{code:"",instance:(0,o.IJ)(null)},transform_script:{code:"",instance:(0,o.IJ)(null)}},input_tbl:{instance:{},cells:[],tbl:(0,o.IJ)([]),in2out:(0,o.IJ)({})},output_tbl:{instance:{},cells:[],tbl:(0,o.IJ)([]),cols:(0,o.IJ)([]),out2in:(0,o.IJ)({cells:{},cols:[],rows:[]})}}},actions:{async loadCaseData(t){let e=[],n=`./${t}/`;try{const[s,l,a]=await Promise.all([fetch(n+"data.json"),fetch(n+"spec.js"),fetch(n+"script.py")]),[i,o,r]=await Promise.all([s.ok?s.text():Promise.resolve(null),l.ok?l.text():Promise.resolve(null),a.ok?a.text():Promise.resolve(null)]);this.initTblInfo(),null!==i?(this.caseData=JSON.parse(i),this.input_tbl.tbl=this.caseData.input_tbl,this.input_tbl.instance.updateData(this.input_tbl.tbl)):e.push(`Failed to load data from ${t}`),null!==o?this.editor.mapping_spec.code=o:e.push(`Failed to load spec from ${t}`),null!==r?this.editor.transform_script.code=r:e.push(`Failed to load script from ${t}`)}catch(s){e.push(`Error loading data: ${s}`)}return this.currentCase=t,e},async loadCaseSpec(t){let e=!1,n="";try{const s=await fetch(`/caseSpecs/${t}.js`);s.ok?(e=!0,n=await s.text()):(e=!1,n=`Failed to load script from ${t}`)}catch(s){e=!1,n=`Error loading script: ${s}`}return{status:e,spec:n}},highlightTblCells(t,e){if(this[t].instance.updateSettings({cell:e}),this[t].cells=e.map((t=>[t.row,t.col])),this[t].cells.length){let e=this.startPoint(this[t].cells);this[t].instance.scrollViewportTo({row:e[0],col:e[1],verticalSnap:"top",horizontalSnap:"start"})}},highlightMinimapCells(t){d.Ubm("g.matrix rect.grid-cell").attr("fill",g.default.fill).attr("stroke",g.default.stroke),d.Ubm("g.matrix text.grid-text").attr("fill",g.default.text).attr("font-weight","normal"),t.forEach((t=>{t.className&&(d.Ltv(`g.matrix #grid-${t.row}-${t.col}`).attr("fill",g[t.className].fill).attr("stroke",g[t.className].stroke),d.Ltv(`g.matrix #text-${t.row}-${t.col}`).attr("fill",g[t.className].text).attr("font-weight",g[t.className].weight||"normal"))}))},out2in_mapping(t){this.caseData;let e=[];if(t.row<0)this.output_tbl.out2in.cols[t.col]&&this.output_tbl.out2in.cols[t.col].forEach((t=>{if(t.startsWith("[")&&t.endsWith("]")){let n=JSON.parse(t);e.push({row:n[0],col:n[1],className:"posi-mapping"})}}));else if(t.col<0)this.output_tbl.out2in.rows[t.row].forEach((t=>{if(t.startsWith("[")&&t.endsWith("]")){let n=JSON.parse(t);e.push({row:n[0],col:n[1],className:"posi-mapping"})}}));else{let n=`[${t.row},${t.col}]`,s=this.output_tbl.out2in.cells[n];if(s.startsWith("[")&&s.endsWith("]")){let t=JSON.parse(s);e.push({row:t[0],col:t[1],className:"posi-mapping"})}}return e},in2out_mapping(t){let e=[],n=this.input_tbl.in2out[`[${t.row},${t.col}]`];return n&&n.forEach((t=>{let n=JSON.parse(t);e.push({row:n[0],col:n[1],className:"posi-mapping"})})),e},grid_cell_click(t){const e=this.input_tbl.instance.getCell(t.row,t.col);if(e){let n=[{...t,className:"posi-mapping"}];this.highlightTblCells("input_tbl",n),e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0}))}},startPoint(t){let e=t[0];for(let n=1;n<t.length;n++){let s=t[n];(s[0]<e[0]||s[0]===e[0]&&s[1]<e[1])&&(e=s)}return e},transformTablebyCode(){try{let t=this.editor.mapping_spec.instance.getValue()+"\nreturn option;";const e=v.transpileModule(t,{compilerOptions:{target:v.ScriptTarget.ES2015,module:v.ModuleKind.CommonJS}}),n=new Function("ValueType","sortWithCorrespondingArray",e.outputText),s=n(p.ValueType,h.NM),{rootArea:l,tidyData:a}=(0,h.LR)(this.input_tbl.tbl,s);if(0===Object.keys(a).length)return void m.Ay.warning({content:"The output table is empty based on the specification.",style:{whiteSpace:"pre-line"}});this.derivePosiMapping(a),this.output_tbl.instance.updateData(this.output_tbl.tbl),this.output_tbl.instance.updateSettings({colHeaders:this.output_tbl.cols})}catch(t){let e;console.log(t),e=t instanceof b.CustomError?`Failed to transform the table based on the specification:\n ${t}`:`Failed to parse the specification:\n ${t}`,m.Ay.error({content:e,style:{whiteSpace:"pre-line"}})}},derivePosiMapping(t){this.initTblInfo(!1);const e=Object.keys(t);this.output_tbl.cols=e;const n=Math.max(...e.map((e=>t[e].length)));for(let s=0;s<n;s++){const n=[];this.output_tbl.out2in.rows.push([]);for(let l=0;l<e.length;l++){const a=e[l];let i;i=t[a].length<=s?{x:-1,y:-1,value:void 0}:t[a][s],n.push(i.value);let o=`[${i.y},${i.x}]`;const r=`[${s},${l}]`;i.x<0||i.y<0?o="":this.input_tbl.in2out.hasOwnProperty(o)?this.input_tbl.in2out[o].push(r):this.input_tbl.in2out[o]=[r],this.output_tbl.out2in.cells[r]=o,this.output_tbl.out2in.rows[s].push(o),this.output_tbl.out2in.cols.length<=l?this.output_tbl.out2in.cols.push([o]):this.output_tbl.out2in.cols[l].push(o)}this.output_tbl.tbl.push(n)}},initTblInfo(t=!0){t&&(this.input_tbl.tbl=[],this.input_tbl.instance.updateData(this.input_tbl.tbl)),this.input_tbl.cells=[],this.input_tbl.in2out={},this.output_tbl.tbl=[],this.output_tbl.cols=[],this.output_tbl.cells=[],this.output_tbl.out2in={cells:{},cols:[],rows:[]},this.output_tbl.instance.updateData(this.output_tbl.tbl),this.output_tbl.instance.updateSettings({colHeaders:this.output_tbl.cols})}},getters:{}});var j=n(93230);const w={class:"view"},k={class:"view-title"},x=(0,l.Lk)("span",{class:"head-text"}," Input Table ",-1),_={class:"toolbar",style:{float:"right","margin-right":"5px"}},C={class:"controller"},L=(0,l.Lk)("span",null,"Upload",-1),T={class:"view-content"},O={id:"input-tbl"},S={class:"view"},E={class:"view-title"},M=(0,l.Lk)("span",null,"Output Table",-1),N={style:{float:"right","margin-right":"30px"}},z=(0,l.Lk)("span",null,"Download",-1),A={class:"view-content"},$={id:"output-tbl"};var D=(0,l.pM)({__name:"InOutTable",setup(t){(0,c.um)();const e=y();let n=e.caseData,s=(0,o.KR)(n.output_col),a=(0,o.KR)([]);a.value=e.caseList.map((t=>({value:t,label:t})));let i,f,d=(0,o.KR)(e.caseList[0]);function p(t,e,n,s,l,a,i){u.Ay.renderers.TextRenderer.apply(this,arguments),e.innerHTML=`<div class="truncated">${a}</div>`}const h=(0,o.KR)([]),b=t=>{try{const n=new FileReader;n.onload=n=>{const s=n.target?.result,l=j.LF(s,{type:"array"}),a=l.SheetNames[0],i=l.Sheets[a],o=j.Wp.sheet_to_json(i,{header:1}),r=Math.max(...o.map((t=>t.length))),c=o.map((t=>{while(t.length<r)t.push(void 0);return t}));e.initTblInfo(),e.input_tbl.tbl=c,e.input_tbl.instance.updateData(c),t.onSuccess("ok")},n.readAsArrayBuffer(t.file)}catch(n){m.Ay.error({content:`${t.file.name} file uploaded failed.\n${n}`,style:{whiteSpace:"pre-line"}})}},v=()=>{e.initTblInfo()};function g(t){return t.map((t=>t.map((t=>`${void 0===t?"":t}`)).join(","))).join("\n")}const D=()=>{if(0===e.output_tbl.cols.length)return void m.Ay.warning("The output table is empty.");const t=g([e.output_tbl.cols,...e.output_tbl.tbl]),n=new Blob([t],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(n),l=document.createElement("a");l.href=s,l.download="tidy table.csv",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s),m.Ay.success("The output table has been downloaded successfully.")};function R(t){d.value=t,h.value=[],e.loadCaseData(t)}return(0,l.sV)((()=>{const t=(0,l.nI)()?.proxy;i=t.$refs.inputTbl.hotInstance,f=t.$refs.outputTbl.hotInstance,e.input_tbl.instance=i,e.output_tbl.instance=f,f.updateSettings({outsideClickDeselects:t=>"wtHolder"!==t?.className&&(i.updateSettings({cell:[]}),e.highlightMinimapCells([]),!0)}),f.addHook("afterOnCellMouseDown",(()=>{i.updateSettings({cell:[]})})),f.addHook("afterOnCellMouseUp",((t,n,s)=>{const l=e.out2in_mapping(n);e.highlightTblCells("input_tbl",l),e.highlightMinimapCells(l)})),i.updateSettings({outsideClickDeselects:t=>"wtHolder"!==t?.className&&(f.updateSettings({cell:[]}),!0)}),i.addHook("afterOnCellMouseDown",(()=>{f.updateSettings({cell:[]})})),i.addHook("afterOnCellMouseUp",((t,n,s)=>{const l=e.in2out_mapping(n);e.highlightTblCells("output_tbl",l),e.highlightMinimapCells([{...n,className:"posi-mapping"}])})),R(d.value)})),(t,e)=>{const i=(0,l.g2)("a-select"),c=(0,l.g2)("v-icon"),u=(0,l.g2)("a-button"),f=(0,l.g2)("a-upload"),m=(0,l.g2)("a-space");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",w,[(0,l.Lk)("div",k,[x,(0,l.Lk)("span",_,[(0,l.Lk)("span",C,[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.bF)(i,{ref:"select",value:(0,o.R1)(d),options:(0,o.R1)(a),size:"small",onChange:R},null,8,["value","options"]),(0,l.bF)(f,{"file-list":h.value,"onUpdate:fileList":e[0]||(e[0]=t=>h.value=t),"max-count":1,accept:".csv, .txt, .xls, .xlsx",customRequest:b,onRemove:v},{default:(0,l.k6)((()=>[(0,l.bF)(u,{size:"small"},{default:(0,l.k6)((()=>[(0,l.bF)(c,{name:"bi-upload",scale:"0.85"}),L])),_:1})])),_:1},8,["file-list"])])),_:1})])])]),(0,l.Lk)("div",T,[(0,l.Lk)("div",O,[(0,l.bF)((0,o.R1)(r.sH),{ref:"inputTbl",data:(0,o.R1)(n).input_tbl,rowHeaders:!0,colHeaders:!0,manualColumnResize:!0,renderer:p,contextMenu:!0,licenseKey:"non-commercial-and-evaluation"},null,8,["data"])])])]),(0,l.Lk)("div",S,[(0,l.Lk)("div",E,[M,(0,l.Lk)("span",N,[(0,l.bF)(u,{size:"small",onClick:D},{default:(0,l.k6)((()=>[(0,l.bF)(c,{name:"bi-download",scale:"0.85"}),z])),_:1})])]),(0,l.Lk)("div",A,[(0,l.Lk)("div",$,[(0,l.bF)((0,o.R1)(r.sH),{ref:"outputTbl",data:(0,o.R1)(n).output_tbl,rowHeaders:!0,colHeaders:(0,o.R1)(s),manualColumnResize:!0,renderer:p,contextMenu:!0,licenseKey:"non-commercial-and-evaluation"},null,8,["data","colHeaders"])])])])],64)}}});const R=D;var I=R,F=n(42336),P=n(78626),V=(0,l.pM)({__name:"CodeView",props:{codeType:{}},setup(t){const{codeType:e}=t,n=y(),s={value:"",language:"mapping_spec"===e?"typescript":"python",theme:"vs",fontSize:14,glyphMargin:!1,automaticLayout:!1,autoIndent:"advanced",readOnly:!1,minimap:{enabled:!1},lineNumbersMinChars:1,scrollBeyondLastLine:!1,padding:{bottom:80}},a=(0,o.KR)(null);let i=null;const r=()=>{i&&i.dispose();const t={...s,value:n.editor[e].code};i=F.EN.create(a.value,t)};(0,l.wB)((()=>n.currentCase),(t=>{i?.setValue(n.editor[e].code)}));const c=(0,P.debounce)((()=>{i&&i.layout()}),100),u=new ResizeObserver((()=>{c()}));if("mapping_spec"===e){const t="ts:grammar.ts",e=F.EN.getModels().find((e=>e.uri.toString()===t));e||fetch("./grammar.ts").then((e=>{e.text().then((e=>{F.eo.typescript.javascriptDefaults.setDiagnosticsOptions({noSemanticValidation:!0,noSyntaxValidation:!1}),F.eo.typescript.javascriptDefaults.setCompilerOptions({target:F.eo.typescript.ScriptTarget.ES2015,allowNonTsExtensions:!0}),F.eo.typescript.javascriptDefaults.addExtraLib(e,t),F.EN.createModel(e,"typescript",F.zn.parse(t))}))}))}return(0,l.sV)((()=>{r(),u.observe(a.value),i&&(n.editor[e].instance=i)})),(0,l.hi)((()=>{i&&i.dispose()})),(t,e)=>((0,l.uX)(),(0,l.CE)("div",{ref_key:"editorWrapper",ref:a,class:"editor-container"},null,512))}}),H=n(71241);const K=(0,H.A)(V,[["__scopeId","data-v-67e03b4a"]]);var U=K;const J={class:"view"},B={class:"view-title"},W=(0,l.Lk)("span",null,"Mapping Minimap",-1),X=(0,l.Lk)("span",null,"Reset",-1),q={class:"view-content"};var G=(0,l.pM)({__name:"Minimap",setup(t){const e=y(),n=(0,o.KR)(null);let s,a=0,i=0,r=null;function c(){r&&n.value&&d.Ltv(n.value).select("svg").transition().duration(750).call(r.transform,d.GSI)}function u(t,e){const n=[];for(let s=0;s<t;s++)for(let t=0;t<e;t++)n.push({row:s,col:t});return n}const f=(t,l)=>{if(!n.value)return;d.Ltv(n.value).selectAll("svg").remove();const o=n.value.clientWidth,c=n.value.clientHeight;let f=Math.max(5,Math.min(45,Math.floor(o/l))),p=Math.max(5,Math.min(20,Math.floor(c/t)));f=p=Math.min(f,p),r=d.s_O().on("zoom",(function(t){d.Ltv("g.matrix").attr("transform",`translate(${a+t.transform.x}, ${i+t.transform.y}) scale(${t.transform.k})`),g(t.transform.k)}));const h=d.Ltv(n.value).append("svg").attr("width",o).attr("height",c).call(r),b=h.append("g").classed("matrix",!0);let m=null;const v=u(t,l);b.selectAll("rect").data(v).enter().append("rect").classed("grid-cell",!0).attr("x",(t=>t.col*f)).attr("y",(t=>t.row*p)).attr("id",(t=>`grid-${t.row}-${t.col}`)).attr("width",f).attr("height",p).attr("fill","#f9f7ff").attr("stroke","#cccccc").on("mouseover",(function(){d.Ltv(this).raise().attr("stroke-width",2),m&&m.raise()})).on("mouseout",(function(){d.Ltv(this).attr("stroke-width",1)})).on("click",(function(t,n){e.grid_cell_click({row:n.row,col:n.col})}));a=Math.max((o-b.node().getBBox().width)/2,0),i=Math.max((c-b.node().getBBox().height)/2,0),b.attr("transform",`translate(${a}, ${i})`),s=d.GSI;const g=t=>{const e=f*t,n=p*t;e>=45&&n>=20?m?m.style("display","block"):m=b.selectAll("text").data(v).enter().append("text").classed("grid-text",!0).attr("x",(t=>t.col*f+f/2)).attr("y",(t=>t.row*p+p/2)).attr("id",(t=>`text-${t.row}-${t.col}`)).attr("dy",".30em").attr("font-size",15/t).attr("fill","#000").attr("text-anchor","middle").text((t=>`(${t.row}, ${t.col})`)).style("display","block").style("pointer-events","none"):m&&m.style("display","none")};g(1)},p=(0,P.debounce)((()=>{e.caseData.input_tbl&&f(e.caseData.input_tbl.length,e.caseData.input_tbl[0].length)}),100),h=new ResizeObserver((()=>{p()}));return(0,l.sV)((()=>{n.value&&h.observe(n.value)})),(0,l.wB)((()=>e.input_tbl.tbl),(t=>{f(t.length,t[0].length)})),(t,e)=>{const s=(0,l.g2)("v-icon"),a=(0,l.g2)("a-button");return(0,l.uX)(),(0,l.CE)("div",J,[(0,l.Lk)("div",B,[W,(0,l.bF)(a,{size:"small",style:{float:"right","margin-right":"20px"},onClick:c},{default:(0,l.k6)((()=>[(0,l.bF)(s,{name:"bi-arrow-clockwise",scale:"0.9"}),X])),_:1})]),(0,l.Lk)("div",q,[(0,l.Lk)("div",{ref_key:"container",ref:n,class:"grid-container"},null,512)])])}}});const Y=G;var Q=Y;const Z={id:"panel"},tt=(0,l.Lk)("div",{class:"system-name"},"TableTidier",-1),et={class:"main-views"},nt={class:"column left"},st={class:"column center"},lt=(0,l.Lk)("div",{class:"view"},[(0,l.Lk)("h2",{class:"view-title"},"Mapping Template Visualization"),(0,l.Lk)("div",{class:"view-content"})],-1),at={class:"column right"},it={class:"view"},ot={class:"view-title"},rt=(0,l.Lk)("span",null,"Code Panel",-1),ct={style:{float:"right","margin-right":"30px"}},ut=(0,l.Lk)("span",null,"Run",-1),ft={class:"view-content"},dt=(0,l.Lk)("span",null," Mapping Specification ",-1),pt=(0,l.Lk)("span",null," Transformation Script ",-1);var ht=(0,l.pM)({__name:"PanelView",setup(t){const e=y(),n=(0,o.KR)("1"),s=(0,o.KR)(!1);function a(){s.value=!0,e.transformTablebyCode(),s.value=!1}return(t,e)=>{const i=(0,l.g2)("v-icon"),o=(0,l.g2)("a-button"),r=(0,l.g2)("a-tab-pane"),c=(0,l.g2)("a-tabs");return(0,l.uX)(),(0,l.CE)("div",Z,[tt,(0,l.Lk)("div",et,[(0,l.Lk)("div",nt,[(0,l.bF)(I)]),(0,l.Lk)("div",st,[lt,(0,l.bF)(Q)]),(0,l.Lk)("div",at,[(0,l.Lk)("div",it,[(0,l.Lk)("div",ot,[rt,(0,l.Lk)("span",ct,[(0,l.bF)(o,{size:"small",loading:s.value,onClick:a},{default:(0,l.k6)((()=>[(0,l.bF)(i,{name:"la-rocket-solid",scale:"0.85"}),ut])),_:1},8,["loading"])])]),(0,l.Lk)("div",ft,[(0,l.bF)(c,{activeKey:n.value,"onUpdate:activeKey":e[0]||(e[0]=t=>n.value=t),type:"card"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{key:"1"},{tab:(0,l.k6)((()=>[dt])),default:(0,l.k6)((()=>[(0,l.bF)(U,{codeType:"mapping_spec"})])),_:1}),(0,l.bF)(r,{key:"2"},{tab:(0,l.k6)((()=>[pt])),default:(0,l.k6)((()=>[(0,l.bF)(U,{codeType:"transform_script"})])),_:1})])),_:1},8,["activeKey"])])])])])])}}});const bt=ht;var mt=bt,vt=(0,l.pM)({name:"overView",components:{PanelView:mt}});const gt=(0,H.A)(vt,[["render",i]]);var yt=gt,jt=n(87086),wt=n(8336),kt=n(92278),xt=n(58730),_t=n(35678),Ct=n(91328),Lt=n(73918),Tt=n(25169),Ot=n(6969),St=n(86789),Et=n(90070),Mt=n(58856);const Nt=(0,f.Ey)(),zt=(0,s.Ef)(yt);zt.use(Nt).use(jt.Ay).use(wt.A).use(kt.A).use(xt.A).use(_t.A).use(Ct.A).use(Lt.Ay).use(Tt.A).use(Ot.Ay),(0,St.oe)(Et.tAF,Et.Ah9,Mt.RqA,Et.rLf),zt.component("v-icon",St.Ly),zt.mount("#app")},99160:function(t,e,n){"use strict";n.r(e),n.d(e,{CustomError:function(){return s}});class s extends Error{constructor(t,e="CustomError"){super(t),this.name=e,Object.setPrototypeOf(this,new.target.prototype)}}var l;(function(t){t[t["String"]=0]="String",t[t["Number"]=1]="Number",t[t["None"]=2]="None"})(l||(l={}))},89387:function(t){function e(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=function(){return[]},e.resolve=e,e.id=89387,t.exports=e},530:function(){},72615:function(){},84021:function(){},66247:function(){},82202:function(){},18641:function(){},97664:function(){}},e={};function n(s){var l=e[s];if(void 0!==l)return l.exports;var a=e[s]={id:s,loaded:!1,exports:{}};return t[s].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=t,function(){n.amdO={}}(),function(){var t=[];n.O=function(e,s,l,a){if(!s){var i=1/0;for(u=0;u<t.length;u++){s=t[u][0],l=t[u][1],a=t[u][2];for(var o=!0,r=0;r<s.length;r++)(!1&a||i>=a)&&Object.keys(n.O).every((function(t){return n.O[t](s[r])}))?s.splice(r--,1):(o=!1,a<i&&(i=a));if(o){t.splice(u--,1);var c=l();void 0!==c&&(e=c)}}return e}a=a||0;for(var u=t.length;u>0&&t[u-1][2]>a;u--)t[u]=t[u-1];t[u]=[s,l,a]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){n.f={},n.e=function(t){return Promise.all(Object.keys(n.f).reduce((function(e,s){return n.f[s](t,e),e}),[]))}}(),function(){n.u=function(t){return"js/"+t+"."+{9:"fd8a2580",293:"45b4760c",703:"d33ea673",1034:"9323c35d",1157:"6fe2e17a",1461:"a32c992f",1477:"84b61b84",1813:"cedde620",1915:"2f8a7722",2149:"113ed740",2365:"9aff11c1",2412:"e9c5f83b",2501:"00cbaa4a",2591:"0ffb605e",2689:"a8c8bd92",2709:"919c563d",2799:"b9be7a0f",2965:"2a8378ba",2999:"00957c78",3051:"59f4eaa5",3061:"86c2b7c6",3071:"83f5524d",3445:"9b32cc8e",3473:"8b1bb69f",3577:"5de04f39",3691:"c89ec30b",3717:"53c560c1",3753:"eddc109b",3765:"bea239a3",3775:"9022708c",3948:"f8d2c8a4",4205:"1f80ad6c",4261:"8c96c2e7",4341:"17c8a5da",4373:"951fe271",4485:"64087f25",4605:"42f96e26",4621:"11c3c663",4805:"6dda523c",4977:"7555c323",5077:"b5d3a6d0",5081:"fd6f3a81",5083:"3811bc00",5093:"b8bbee9f",5282:"fb946888",5285:"d5a3964e",5287:"12893b8c",5303:"0c067718",5365:"fc0782ba",5521:"7c1f52a7",5589:"ac687193",5609:"4276cab1",5653:"b6276f81",5749:"3371da93",5841:"fd2e036f",6059:"75881e32",6121:"f6c4df32",6181:"e69ddbec",6229:"3b1d24c8",6309:"88b2d625",6325:"56121ce4",6613:"a4379ca7",6757:"b95032e5",6821:"b6dc9651",6845:"960c9f84",7045:"04ea9095",7217:"58939fdd",7219:"aed014e0",7449:"b51bb089",7461:"6cf9b886",7525:"fc54d812",7623:"76f561e4",7641:"f0c54055",8175:"f70a68f5",8285:"fb2876b9",8329:"2699d74a",8387:"6b51929d",8533:"522850e3",8653:"d3822c81",8981:"864b1e1c",9009:"3e622794",9437:"95b8400c",9445:"65f9c957",9626:"65cf33f5",9717:"9f42a9b5"}[t]+".js"}}(),function(){n.miniCssF=function(t){}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="TableTidier:";n.l=function(s,l,a,i){if(t[s])t[s].push(l);else{var o,r;if(void 0!==a)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var f=c[u];if(f.getAttribute("src")==s||f.getAttribute("data-webpack")==e+a){o=f;break}}o||(r=!0,o=document.createElement("script"),o.charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",e+a),o.src=s),t[s]=[l];var d=function(e,n){o.onerror=o.onload=null,clearTimeout(p);var l=t[s];if(delete t[s],o.parentNode&&o.parentNode.removeChild(o),l&&l.forEach((function(t){return t(n)})),e)return e(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),r&&document.head.appendChild(o)}}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){n.p="/TableTidier/"}(),function(){var t={3524:0};n.f.j=function(e,s){var l=n.o(t,e)?t[e]:void 0;if(0!==l)if(l)s.push(l[2]);else{var a=new Promise((function(n,s){l=t[e]=[n,s]}));s.push(l[2]=a);var i=n.p+n.u(e),o=new Error,r=function(s){if(n.o(t,e)&&(l=t[e],0!==l&&(t[e]=void 0),l)){var a=s&&("load"===s.type?"missing":s.type),i=s&&s.target&&s.target.src;o.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",o.name="ChunkLoadError",o.type=a,o.request=i,l[1](o)}};n.l(i,r,"chunk-"+e,e)}},n.O.j=function(e){return 0===t[e]};var e=function(e,s){var l,a,i=s[0],o=s[1],r=s[2],c=0;if(i.some((function(e){return 0!==t[e]}))){for(l in o)n.o(o,l)&&(n.m[l]=o[l]);if(r)var u=r(n)}for(e&&e(s);c<i.length;c++)a=i[c],n.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return n.O(u)},s=self["webpackChunkTableTidier"]=self["webpackChunkTableTidier"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=n.O(void 0,[504],(function(){return n(27320)}));s=n.O(s)})();
//# sourceMappingURL=app.d231e4ae.js.map