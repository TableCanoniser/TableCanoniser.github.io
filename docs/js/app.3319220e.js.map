{"version":3,"file":"js/app.3319220e.js","mappings":"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","sources":["webpack://TableTidier/./node_modules/moment/locale/ sync ^\\.\\/.*$","webpack://TableTidier/./src/components/PatternVis.vue?27d9","webpack://TableTidier/./src/components/PatternVis.vue","webpack://TableTidier/./src/grammar/grammar.ts","webpack://TableTidier/./src/grammar/handleSpec.ts","webpack://TableTidier/./src/App.vue?d8c0","webpack://TableTidier/./src/App.vue","webpack://TableTidier/./src/components/InOutTable.vue?7f1b","webpack://TableTidier/./src/components/InOutTable.vue","webpack://TableTidier/./src/components/InOutTable.vue?cbe2","webpack://TableTidier/./src/components/CodeView.vue?243d","webpack://TableTidier/./src/components/CodeView.vue","webpack://TableTidier/./src/components/CodeView.vue?33e2","webpack://TableTidier/./src/components/Minimap.vue?557e","webpack://TableTidier/./src/components/Minimap.vue","webpack://TableTidier/./src/components/Minimap.vue?6362","webpack://TableTidier/./src/components/PatternVis.vue?c92c","webpack://TableTidier/./src/components/DraggableModal.vue?c844","webpack://TableTidier/./src/components/DraggableModal.vue","webpack://TableTidier/./src/components/DraggableModal.vue?f84a","webpack://TableTidier/./src/views/PanelView.vue?6324","webpack://TableTidier/./src/views/PanelView.vue","webpack://TableTidier/./src/views/PanelView.vue?f0ad","webpack://TableTidier/./src/App.vue?7ccd","webpack://TableTidier/./src/main.ts","webpack://TableTidier/./src/store/table.ts","webpack://TableTidier/./src/tree/drawTree.ts","webpack://TableTidier/./src/tree/style.ts","webpack://TableTidier/./src/types.ts","webpack://TableTidier/./node_modules/typescript/lib/ sync","webpack://TableTidier/webpack/bootstrap","webpack://TableTidier/webpack/runtime/amd options","webpack://TableTidier/webpack/runtime/chunk loaded","webpack://TableTidier/webpack/runtime/compat get default export","webpack://TableTidier/webpack/runtime/define property getters","webpack://TableTidier/webpack/runtime/ensure chunk","webpack://TableTidier/webpack/runtime/get javascript chunk filename","webpack://TableTidier/webpack/runtime/get mini-css chunk filename","webpack://TableTidier/webpack/runtime/global","webpack://TableTidier/webpack/runtime/hasOwnProperty shorthand","webpack://TableTidier/webpack/runtime/load script","webpack://TableTidier/webpack/runtime/make namespace object","webpack://TableTidier/webpack/runtime/node module decorator","webpack://TableTidier/webpack/runtime/publicPath","webpack://TableTidier/webpack/runtime/jsonp chunk loading","webpack://TableTidier/webpack/startup"],"sourcesContent":["var map = {\n\t\"./af\": 22190,\n\t\"./af.js\": 22190,\n\t\"./ar\": 7218,\n\t\"./ar-dz\": 85785,\n\t\"./ar-dz.js\": 85785,\n\t\"./ar-kw\": 29417,\n\t\"./ar-kw.js\": 29417,\n\t\"./ar-ly\": 56904,\n\t\"./ar-ly.js\": 56904,\n\t\"./ar-ma\": 98617,\n\t\"./ar-ma.js\": 98617,\n\t\"./ar-ps\": 91318,\n\t\"./ar-ps.js\": 91318,\n\t\"./ar-sa\": 82699,\n\t\"./ar-sa.js\": 82699,\n\t\"./ar-tn\": 36789,\n\t\"./ar-tn.js\": 36789,\n\t\"./ar.js\": 7218,\n\t\"./az\": 23050,\n\t\"./az.js\": 23050,\n\t\"./be\": 8316,\n\t\"./be.js\": 8316,\n\t\"./bg\": 70310,\n\t\"./bg.js\": 70310,\n\t\"./bm\": 58884,\n\t\"./bm.js\": 58884,\n\t\"./bn\": 83469,\n\t\"./bn-bd\": 46672,\n\t\"./bn-bd.js\": 46672,\n\t\"./bn.js\": 83469,\n\t\"./bo\": 39118,\n\t\"./bo.js\": 39118,\n\t\"./br\": 13113,\n\t\"./br.js\": 13113,\n\t\"./bs\": 23626,\n\t\"./bs.js\": 23626,\n\t\"./ca\": 40921,\n\t\"./ca.js\": 40921,\n\t\"./cs\": 17799,\n\t\"./cs.js\": 17799,\n\t\"./cv\": 12828,\n\t\"./cv.js\": 12828,\n\t\"./cy\": 93521,\n\t\"./cy.js\": 93521,\n\t\"./da\": 56962,\n\t\"./da.js\": 56962,\n\t\"./de\": 93294,\n\t\"./de-at\": 16158,\n\t\"./de-at.js\": 16158,\n\t\"./de-ch\": 95960,\n\t\"./de-ch.js\": 95960,\n\t\"./de.js\": 93294,\n\t\"./dv\": 47963,\n\t\"./dv.js\": 47963,\n\t\"./el\": 3432,\n\t\"./el.js\": 3432,\n\t\"./en-au\": 20998,\n\t\"./en-au.js\": 20998,\n\t\"./en-ca\": 15931,\n\t\"./en-ca.js\": 15931,\n\t\"./en-gb\": 45930,\n\t\"./en-gb.js\": 45930,\n\t\"./en-ie\": 58081,\n\t\"./en-ie.js\": 58081,\n\t\"./en-il\": 71594,\n\t\"./en-il.js\": 71594,\n\t\"./en-in\": 23904,\n\t\"./en-in.js\": 23904,\n\t\"./en-nz\": 1507,\n\t\"./en-nz.js\": 1507,\n\t\"./en-sg\": 19409,\n\t\"./en-sg.js\": 19409,\n\t\"./eo\": 22177,\n\t\"./eo.js\": 22177,\n\t\"./es\": 84805,\n\t\"./es-do\": 39155,\n\t\"./es-do.js\": 39155,\n\t\"./es-mx\": 69791,\n\t\"./es-mx.js\": 69791,\n\t\"./es-us\": 76098,\n\t\"./es-us.js\": 76098,\n\t\"./es.js\": 84805,\n\t\"./et\": 96240,\n\t\"./et.js\": 96240,\n\t\"./eu\": 20391,\n\t\"./eu.js\": 20391,\n\t\"./fa\": 20612,\n\t\"./fa.js\": 20612,\n\t\"./fi\": 4220,\n\t\"./fi.js\": 4220,\n\t\"./fil\": 65570,\n\t\"./fil.js\": 65570,\n\t\"./fo\": 5466,\n\t\"./fo.js\": 5466,\n\t\"./fr\": 14461,\n\t\"./fr-ca\": 66306,\n\t\"./fr-ca.js\": 66306,\n\t\"./fr-ch\": 27081,\n\t\"./fr-ch.js\": 27081,\n\t\"./fr.js\": 14461,\n\t\"./fy\": 73484,\n\t\"./fy.js\": 73484,\n\t\"./ga\": 76957,\n\t\"./ga.js\": 76957,\n\t\"./gd\": 72978,\n\t\"./gd.js\": 72978,\n\t\"./gl\": 89866,\n\t\"./gl.js\": 89866,\n\t\"./gom-deva\": 65011,\n\t\"./gom-deva.js\": 65011,\n\t\"./gom-latn\": 84724,\n\t\"./gom-latn.js\": 84724,\n\t\"./gu\": 71601,\n\t\"./gu.js\": 71601,\n\t\"./he\": 79802,\n\t\"./he.js\": 79802,\n\t\"./hi\": 9358,\n\t\"./hi.js\": 9358,\n\t\"./hr\": 13907,\n\t\"./hr.js\": 13907,\n\t\"./hu\": 10218,\n\t\"./hu.js\": 10218,\n\t\"./hy-am\": 20533,\n\t\"./hy-am.js\": 20533,\n\t\"./id\": 52844,\n\t\"./id.js\": 52844,\n\t\"./is\": 97353,\n\t\"./is.js\": 97353,\n\t\"./it\": 6364,\n\t\"./it-ch\": 20774,\n\t\"./it-ch.js\": 20774,\n\t\"./it.js\": 6364,\n\t\"./ja\": 6008,\n\t\"./ja.js\": 6008,\n\t\"./jv\": 68221,\n\t\"./jv.js\": 68221,\n\t\"./ka\": 92417,\n\t\"./ka.js\": 92417,\n\t\"./kk\": 42071,\n\t\"./kk.js\": 42071,\n\t\"./km\": 76149,\n\t\"./km.js\": 76149,\n\t\"./kn\": 94572,\n\t\"./kn.js\": 94572,\n\t\"./ko\": 60659,\n\t\"./ko.js\": 60659,\n\t\"./ku\": 66285,\n\t\"./ku-kmr\": 59398,\n\t\"./ku-kmr.js\": 59398,\n\t\"./ku.js\": 66285,\n\t\"./ky\": 81609,\n\t\"./ky.js\": 81609,\n\t\"./lb\": 119,\n\t\"./lb.js\": 119,\n\t\"./lo\": 81748,\n\t\"./lo.js\": 81748,\n\t\"./lt\": 71973,\n\t\"./lt.js\": 71973,\n\t\"./lv\": 81347,\n\t\"./lv.js\": 81347,\n\t\"./me\": 53023,\n\t\"./me.js\": 53023,\n\t\"./mi\": 65747,\n\t\"./mi.js\": 65747,\n\t\"./mk\": 64341,\n\t\"./mk.js\": 64341,\n\t\"./ml\": 63840,\n\t\"./ml.js\": 63840,\n\t\"./mn\": 62058,\n\t\"./mn.js\": 62058,\n\t\"./mr\": 19182,\n\t\"./mr.js\": 19182,\n\t\"./ms\": 45197,\n\t\"./ms-my\": 89136,\n\t\"./ms-my.js\": 89136,\n\t\"./ms.js\": 45197,\n\t\"./mt\": 36408,\n\t\"./mt.js\": 36408,\n\t\"./my\": 51683,\n\t\"./my.js\": 51683,\n\t\"./nb\": 53141,\n\t\"./nb.js\": 53141,\n\t\"./ne\": 29344,\n\t\"./ne.js\": 29344,\n\t\"./nl\": 44703,\n\t\"./nl-be\": 84641,\n\t\"./nl-be.js\": 84641,\n\t\"./nl.js\": 44703,\n\t\"./nn\": 79873,\n\t\"./nn.js\": 79873,\n\t\"./oc-lnc\": 61217,\n\t\"./oc-lnc.js\": 61217,\n\t\"./pa-in\": 24612,\n\t\"./pa-in.js\": 24612,\n\t\"./pl\": 24457,\n\t\"./pl.js\": 24457,\n\t\"./pt\": 1089,\n\t\"./pt-br\": 79146,\n\t\"./pt-br.js\": 79146,\n\t\"./pt.js\": 1089,\n\t\"./ro\": 45950,\n\t\"./ro.js\": 45950,\n\t\"./ru\": 27292,\n\t\"./ru.js\": 27292,\n\t\"./sd\": 56774,\n\t\"./sd.js\": 56774,\n\t\"./se\": 87493,\n\t\"./se.js\": 87493,\n\t\"./si\": 3761,\n\t\"./si.js\": 3761,\n\t\"./sk\": 49711,\n\t\"./sk.js\": 49711,\n\t\"./sl\": 88558,\n\t\"./sl.js\": 88558,\n\t\"./sq\": 8633,\n\t\"./sq.js\": 8633,\n\t\"./sr\": 90688,\n\t\"./sr-cyrl\": 47903,\n\t\"./sr-cyrl.js\": 47903,\n\t\"./sr.js\": 90688,\n\t\"./ss\": 31991,\n\t\"./ss.js\": 31991,\n\t\"./sv\": 27020,\n\t\"./sv.js\": 27020,\n\t\"./sw\": 15891,\n\t\"./sw.js\": 15891,\n\t\"./ta\": 45714,\n\t\"./ta.js\": 45714,\n\t\"./te\": 30206,\n\t\"./te.js\": 30206,\n\t\"./tet\": 24768,\n\t\"./tet.js\": 24768,\n\t\"./tg\": 28276,\n\t\"./tg.js\": 28276,\n\t\"./th\": 57977,\n\t\"./th.js\": 57977,\n\t\"./tk\": 56928,\n\t\"./tk.js\": 56928,\n\t\"./tl-ph\": 8046,\n\t\"./tl-ph.js\": 8046,\n\t\"./tlh\": 41361,\n\t\"./tlh.js\": 41361,\n\t\"./tr\": 64367,\n\t\"./tr.js\": 64367,\n\t\"./tzl\": 10627,\n\t\"./tzl.js\": 10627,\n\t\"./tzm\": 12636,\n\t\"./tzm-latn\": 98148,\n\t\"./tzm-latn.js\": 98148,\n\t\"./tzm.js\": 12636,\n\t\"./ug-cn\": 68823,\n\t\"./ug-cn.js\": 68823,\n\t\"./uk\": 40461,\n\t\"./uk.js\": 40461,\n\t\"./ur\": 41366,\n\t\"./ur.js\": 41366,\n\t\"./uz\": 83454,\n\t\"./uz-latn\": 18374,\n\t\"./uz-latn.js\": 18374,\n\t\"./uz.js\": 83454,\n\t\"./vi\": 78572,\n\t\"./vi.js\": 78572,\n\t\"./x-pseudo\": 80464,\n\t\"./x-pseudo.js\": 80464,\n\t\"./yo\": 93709,\n\t\"./yo.js\": 93709,\n\t\"./zh-cn\": 65873,\n\t\"./zh-cn.js\": 65873,\n\t\"./zh-hk\": 17549,\n\t\"./zh-hk.js\": 17549,\n\t\"./zh-mo\": 52240,\n\t\"./zh-mo.js\": 52240,\n\t\"./zh-tw\": 90405,\n\t\"./zh-tw.js\": 90405\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 35358;","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = {\n  class: \"view\",\n  style: {\"flex\":\"4.5\"}\n}\nconst _hoisted_2 = { class: \"view-title\" }\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Pattern Panel\", -1)\nconst _hoisted_4 = { style: {\"float\":\"right\",\"margin-right\":\"20px\"} }\nconst _hoisted_5 = { style: {\"font-size\":\"15px\"} }\nconst _hoisted_6 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Match + Extract by:\", -1)\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Reset View\", -1)\nconst _hoisted_8 = {\n  class: \"view-content\",\n  style: {\"display\":\"flex\"}\n}\nconst _hoisted_9 = { style: {\"flex\":\"1\"} }\nconst _hoisted_10 = { style: {\"flex\":\"1\",\"margin-left\":\"5px\"} }\n\nimport { computed, onMounted, ref, watch } from 'vue';\n// import * as d3 from 'd3';\n// import { flextree, FlextreeNode } from 'd3-flextree';\nimport { TreeChart } from '@/tree/drawTree';\nimport { message } from 'ant-design-vue';\nimport { AreaBox, TblCell, useTableStore } from \"@/store/table\";\nimport * as d3 from 'd3';\nimport { TypeColor, typeMapColor } from '@/tree/style';\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'PatternVis',\n  setup(__props) {\n\nconst tableStore = useTableStore();\n\n/*\ninterface TreeNode {\n    [key: string]: any;\n    children?: TreeNode[];\n}\n\nconst data: TreeNode = {\n    name: 'Root',\n    children: [\n        { name: 'Child 1' },\n        {\n            name: 'Child 2',\n            children: [\n                { name: 'Grandchild 1' },\n                { name: 'Grandchild 2' },\n                { name: 'Grandchild 3' },\n            ]\n        }\n    ]\n};\n*/\n\nconst menuList = computed(() => tableStore.tree.menuList);\n// const contextMenuVisible = tableStore.tree.contextMenuVisible;\nconst contextMenuVisible = computed(() => tableStore.tree.contextMenuVisible && tableStore.tree.menuList.length > 0);\nconst contextMenuVisibleChange = (value: boolean) => {\n    // if (store.state.selectedNode.length === 0 && value === true) return;\n    // store.commit('setContextMenuVisibility', value);\n    tableStore.tree.contextMenuVisible = value;\n    tableStore.tree.menuList = [];\n    // setTimeout(() => {\n    //     tableStore.tree.menuList = [];\n    // }, 0)\n};\n\nconst closeContextMenu = (e: any) => {\n    // console.log(\"closeContextMenu\", e, e.key);\n    const visNode = tableStore.spec.selectNode.data;\n    let extract: any = null, extractColor: string = '';\n    let triggerCellCursorFlag = false;\n    let messageInfo = \"\\n Press ESC to cancel the selection mode.\";\n    const maxCNum = tableStore.findMaxCNumber() + 1;\n    switch (e.key) {\n        case \"0\":\n            // Reset Area Logic\n            messageInfo = \"Please reselect the template's area in the input table.\" + messageInfo;\n            triggerCellCursorFlag = true;\n            break;\n        case \"1\":\n            // Add Constraints Logic\n            messageInfo = \"Please select the constrained cell in the input table.\" + messageInfo;\n            triggerCellCursorFlag = true;\n            break;\n        case \"2-0\":\n            // Target Cols - Position Based Logic\n            extract = {\n                byPositionToTargetCols: Array.from({ length: visNode.width * visNode.height }, (_, i) => `C${maxCNum + i}`)\n            }\n            extractColor = 'positionShallow';\n            break;\n        case \"2-1\":\n            // Target Cols - Context Based Logic\n            extract = {\n                byContext: {\n                    position: 'above'\n                }\n            }\n            extractColor = 'contextShallow';\n            break;\n        case \"2-2\":\n            // Target Cols - Value Based Logic\n            const createExtract = () => {\n                return eval(`currentAreaTbl => {\n                  // Please replace the default code with the necessary implementation to complete the function.\n                  return currentAreaTbl.flat().map((cell, i) => 'C' + (${maxCNum} + i))\n                  }`)\n            }\n            extract = {\n                byValue: createExtract()\n            }\n            extractColor = 'valueShallow';\n            break;\n        case \"2-3\":\n            // Target Cols - No Extract Logic\n            tableStore.insertNodeOrPropertyIntoSpecs(undefined, \"extract\")\n            break;\n        case \"3\":\n            // Add Sub-Template Logic\n            messageInfo = \"Please select an area in the input table.\" + messageInfo;\n            triggerCellCursorFlag = true;\n            break;\n        case \"4\":\n            tableStore.deleteChildByPath(tableStore.spec.rawSpecs, visNode.path!);\n            tableStore.stringifySpec();\n            break;\n        case \"5\":\n            tableStore.deleteChildByPath(tableStore.spec.rawSpecs, visNode.path!, tableStore.spec.selectConstrIndex);\n            tableStore.stringifySpec();\n    }\n\n    if (extract !== null) {\n        tableStore.insertNodeOrPropertyIntoSpecs(extract, \"extract\")\n        tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine(extract, tableStore.getNodebyPath(tableStore.spec.rawSpecs, visNode.path!)), extractColor];\n    }\n    if (triggerCellCursorFlag) {\n        message.info(messageInfo);\n        tableStore.spec.selectAreaFromNode = e.key;\n        document.body.style.cursor = 'cell';\n        document.documentElement.style.setProperty('--custom-cursor', 'cell');\n        const cells = tableStore.generateHighlightCells(tableStore.spec.selectionsAreaFromLegend, tableStore.spec.selectAreaFromLegend);\n        tableStore.highlightTblCells(\"input_tbl\", cells);\n    }\n    tableStore.tree.contextMenuVisible = false;\n}\n\nconst treeContainer = ref<HTMLDivElement | null>(null);\n\nfunction drawTree2() {\n    drawTree(tableStore.spec.visTree);\n    drawTblTemplate();\n    // if (zoom && tblContainer.value) {\n    //     // 不能对g.matrix元素进行transform操作，因为zoom事件监听器是添加在svg元素上的，所以需要对svg元素进行transform操作\n    //     d3.select(tblContainer.value).select('svg').transition().duration(750)\n    //         .call(zoom.transform as any, d3.zoomIdentity); // 重置缩放和平移状态\n    // }\n}\n\nconst drawTree = (data: any) => {\n    const treeInstance = new TreeChart([2, 1], '.tree-container', data, tableStore, 1.0, 'h');\n    treeInstance.render();\n    tableStore.tree.visInst = treeInstance;\n};\n\nconst typeMap = {\n    \"null\": \"No Extration\",\n    \"position\": \"Position Based\",\n    \"context\": \"Context Based\",\n    \"value\": \"Value Based\",\n}\nconst selectMatchExtractArea = (type: TypeColor) => {\n    d3.selectAll('.legend').classed('legend-selection', false);\n    d3.select(`.legend.legend-${type}`).classed('legend-selection', true);\n    const selectionsFromLegend = tableStore.spec.selectionsAreaFromLegend;\n    const selectFromLegend = tableStore.spec.selectAreaFromLegend;\n    const cells = tableStore.generateHighlightCells(selectionsFromLegend, selectFromLegend);\n    tableStore.highlightTblCells(\"input_tbl\", cells);\n\n    if (selectFromLegend.length > selectionsFromLegend.length) {\n        selectFromLegend[selectFromLegend.length - 1] = type;\n    } else {\n        selectFromLegend.push(type);\n    }\n    // const cursorStyle = `url(${require('@/assets/cell.png')}), auto`;\n    document.body.style.cursor = 'cell';\n    document.documentElement.style.setProperty('--custom-cursor', 'cell');\n    message.info(\"Now is \" + typeMap[type as keyof typeof typeMap] + \" mode. Please select the starting area in the input table.\\n Press ESC to cancel the selection mode.\");\n    // tableStore.input_tbl.instance.rootElement.style.cursor = \"cell\";\n    // (document.querySelector('.truncated') as HTMLElement).style.cursor = \"cell\"\n}\n\n\n\nconst tblContainer = ref<HTMLDivElement | null>(null);\nlet offsetX = 0;\nlet offsetY = 0;\nlet transformStatue: any;\nlet zoom: d3.ZoomBehavior<SVGSVGElement, unknown> | null = null;\n\nconst drawTblTemplate = () => {\n    if (!tblContainer.value) return;\n    // Clear any existing SVG\n    d3.select(tblContainer.value).selectAll('svg').remove();\n\n    try {\n        const visChildren = tableStore.spec.visTree.children\n        if (visChildren === undefined || visChildren.length === 0 || visChildren[0].width === 0 || visChildren[0].height === 0) return;\n\n        const containerWidth = tblContainer.value.clientWidth;\n        const containerHeight = tblContainer.value.clientHeight;\n\n\n        let cellWidth = Math.max(5, Math.min(90, Math.floor(containerWidth / visChildren[0].width)));\n        let cellHeight = Math.max(5, Math.min(30, Math.floor(containerHeight / visChildren[0].height)));\n        // const cellWidth = 90;\n        // const cellHeight = 30;\n\n        zoom = d3.zoom<SVGSVGElement, unknown>()\n            // .scaleExtent([0.5, 3.5])  // set the zoom scale range\n            .on('zoom', function (event) {\n                // svg.attr('transform', event.transform);  // 直接设置svg的transform属性会导致缩放后的坐标系不正确（导致的问题是：用鼠标平移（pan）矩形的时候，矩形会抖动，导致矩形实际平移的距离小于鼠标平移的距离），因此需要在svg内部再添加一个g元素\n                d3.select('g.tbl-template').attr('transform', `translate(${offsetX + event.transform.x}, ${offsetY + event.transform.y}) scale(${event.transform.k})`); // Update the matrix transform based on the zoom event\n                updateCellTextVisibility(event.transform.k); // Update cell text visibility based on the current scale\n                // transformStatue = event.transform;\n            })\n\n        const svg = d3.select(tblContainer.value)\n            .append('svg')\n            .attr('width', containerWidth)\n            .attr('height', containerHeight)\n            .call(zoom)  // 注意，这里添加zoom的是svg元素，而不是g.matrix元素，所以当resetZoom时，需要对svg元素进行transform操作\n\n        const matrix = svg.append('g').classed(\"tbl-template\", true);  // Append a 'g' element for better transform management to avoid jittering\n        let texts: any = null;\n\n        const grids = tableStore.computeTblPatternGrid();\n        // console.log(\"grids\", grids);\n\n        const cells = matrix.selectAll('rect')\n            .data(grids)\n            .enter().append('rect').classed('tbl-template-cell', true)\n            .attr('x', d => d.col * cellWidth)\n            .attr('y', d => d.row * cellHeight)\n            // .attr('id', d => `tbl-template-${d.row}-${d.col}`)\n            .attr('width', cellWidth)\n            .attr('height', cellHeight)\n            .attr('fill', (d) => d.bgColor ? d.bgColor : '#f9f7ff')\n            .attr('stroke', '#cccccc')\n            .on('mouseover', function (this: SVGRectElement) {\n                d3.select(this).raise() // Bring the cell to the front \n                    // .attr('fill', '#ece9e6')\n                    // .attr('stroke', '#4b8aff')\n                    .attr('stroke-width', 2);\n                if (texts) {\n                    texts.raise();\n                }\n            })\n            .on('mouseout', function () {\n                d3.select(this)\n                    // .attr('fill', '#f9f7ff')\n                    // .attr('stroke', '#cccccc')\n                    .attr('stroke-width', 1);\n            })\n            .on('click', function (event, d: TblCell) {\n                // tableStore.grid_cell_click({ row: d.row + visChildren[0].y, col: d.col + visChildren[0].x });\n                const row = d.row + visChildren[0].y;\n                const col = d.col + visChildren[0].x;\n                d3.select(`#grid-${row}-${col}`).dispatch('click');\n                tableStore.highlightNodes([[row, col, row, col]]);\n                tableStore.input_tbl.instance.deselectCell();\n                tableStore.output_tbl.instance.deselectCell();\n            })\n            .append('title').text(d => {\n                if (d.text && d.text.length) {\n                    if (d.bgColor === typeMapColor.position || d.bgColor === typeMapColor.positionShallow) {\n                        return \"The cell's Target Column is:\\n\" + d.text.toString();\n                    } else {\n                        return \"The cell's Target Column may be:\\n\" + d.text.toString();\n                    }\n                } else {\n                    return \"No Target Column\";\n                }\n            });\n\n        // Calculate the offset to center the matrix in the SVG container\n        offsetX = Math.max((containerWidth - matrix.node()!.getBBox().width) / 2, 0);\n        offsetY = Math.max((containerHeight - matrix.node()!.getBBox().height) / 2, 0);\n        matrix.attr('transform', `translate(${offsetX}, ${offsetY})`); // Center the matrix\n        transformStatue = d3.zoomIdentity;\n\n        const updateCellTextVisibility = (scale: number) => {\n            const scaledCellWidth = cellWidth * scale;\n            const scaledCellHeight = cellHeight * scale;\n            // const cellArea = scaledCellWidth * scaledCellHeight;\n            if (scaledCellWidth >= 90 || scaledCellHeight >= 30) {\n                if (texts) {\n                    texts.style('display', 'block');\n                } else {\n                    texts = matrix.selectAll('text')\n                        .data(grids)\n                        .enter().append('text').classed('tbl-template-text', true)\n                        .attr('x', d => d.col * cellWidth + cellWidth / 2)\n                        .attr('y', d => d.row * cellHeight + cellHeight / 2)\n                        .attr('dy', '.30em')\n                        .attr('font-size', 15 / scale)\n                        .attr('fill', (d) => d.textColor ? d.textColor : typeMapColor.cellFill)\n                        .attr('text-anchor', 'middle')\n                        .text(d => d.text ? d.text[0] : '')\n                        .each(function (d) {\n                            const textElement = d3.select(this);\n                            let text = textElement.text();\n                            let textLength = this.getComputedTextLength();\n                            // 如果文本超出最大宽度，进行截断\n                            while (textLength > cellWidth && text.length > 0) {\n                                text = text.slice(0, -1);\n                                textElement.text(text + '…');\n                                textLength = this.getComputedTextLength();\n                            }\n                        })\n                        .style('display', 'block')\n                        .style('pointer-events', 'none'); // Ensure text does not capture mouse events, in order to allow clicking on the cells\n                }\n            } else {\n                if (texts) {\n                    texts.style('display', 'none');\n                }\n            }\n        };\n\n        updateCellTextVisibility(1); // Initial update for default scale 1\n\n        tableStore.tree.tblVisHighlight = matrix.append('g').classed('tbl-template-highlight', true);\n        tableStore.tree.tblVisInfo = {\n            x: visChildren[0].x,\n            y: visChildren[0].y,\n            width: cellWidth,\n            height: cellHeight\n        }\n\n    }\n    catch (e) {\n        console.error(e);\n    }\n}\n\n/*\nimport { debounce } from 'lodash';\n\n// import { TableTidierTemplate } from '@/grammar/grammar';\n\nconst debouncedResize = debounce(() => {\n    drawTree(tableStore.spec.visTree);\n}, 100); // 调整延迟时间，单位为毫秒\n\nconst resizeObserver = new ResizeObserver(() => {\n    debouncedResize();\n});\n*/\n\nwatch(() => tableStore.editor.mappingSpec.code, (newVal) => {\n    // console.log('watch code changed: start');\n    tableStore.editor.mappingSpec.instance?.setValue(newVal);\n    const setFlag = tableStore.prepareDataAfterCodeChange();\n    if (!setFlag) return;\n    tableStore.transformTablebyCode();  // auto run\n    drawTree(tableStore.spec.visTree);\n    drawTblTemplate();\n    // console.log('watch code changed: end');\n});\n\n// watch(() => tableStore.spec.visTree.size.height, (newVal) => {\n//     console.log('watch tbl size changed: start');\n//     const setFlag = tableStore.prepareDataAfterCodeChange();\n//     if (!setFlag) return;\n//     drawTree(tableStore.spec.visTree);\n//     console.log('watch tbl size changed: end');\n// });\n\n\nonMounted(() => {\n    if (treeContainer.value) {\n        // resizeObserver.observe(treeContainer.value);\n    }\n    // drawTree(tableStore.spec.visTree);\n});\n\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_a_button = _resolveComponent(\"a-button\")!\n  const _component_a_button_group = _resolveComponent(\"a-button-group\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_a_menu = _resolveComponent(\"a-menu\")!\n  const _component_a_dropdown = _resolveComponent(\"a-dropdown\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _hoisted_3,\n      _createElementVNode(\"span\", _hoisted_4, [\n        _createElementVNode(\"span\", _hoisted_5, [\n          _hoisted_6,\n          _createVNode(_component_a_button_group, { style: {\"margin\":\"0 20px 0 8px\"} }, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_button, {\n                class: \"legend legend-null\",\n                size: \"small\",\n                onClick: _cache[0] || (_cache[0] = ($event: any) => (selectMatchExtractArea('null'))),\n                title: \"Click to select a starting area in the input table for matching without extraction. Press 'Esc' to cancel the selection mode.\"\n              }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"No Extration\")\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_button, {\n                class: \"legend legend-position\",\n                size: \"small\",\n                onClick: _cache[1] || (_cache[1] = ($event: any) => (selectMatchExtractArea('position'))),\n                title: \"Click to select a starting area in the input table for matching and extracting by position. Press 'Esc' to cancel the selection mode.\"\n              }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"Position\")\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_button, {\n                class: \"legend legend-context\",\n                size: \"small\",\n                onClick: _cache[2] || (_cache[2] = ($event: any) => (selectMatchExtractArea('context'))),\n                title: \"Click to select a starting area in the input table for matching and extracting by context. Press 'Esc' to cancel the selection mode.\"\n              }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"Context\")\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_button, {\n                class: \"legend legend-value\",\n                size: \"small\",\n                onClick: _cache[3] || (_cache[3] = ($event: any) => (selectMatchExtractArea('value'))),\n                title: \"Click to select a starting area in the input table for matching and extracting by value. Press 'Esc' to cancel the selection mode.\"\n              }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"Value\")\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          })\n        ]),\n        _createVNode(_component_a_button, {\n          id: \"draw_tree\",\n          size: \"small\",\n          onClick: drawTree2\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_v_icon, {\n              name: \"bi-arrow-clockwise\",\n              scale: \"0.9\"\n            }),\n            _hoisted_7\n          ]),\n          _: 1\n        })\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_8, [\n      _createElementVNode(\"div\", _hoisted_9, [\n        _createElementVNode(\"div\", {\n          class: \"tbl-container\",\n          ref_key: \"tblContainer\",\n          ref: tblContainer\n        }, null, 512)\n      ]),\n      _createElementVNode(\"div\", _hoisted_10, [\n        _createVNode(_component_a_dropdown, {\n          trigger: ['contextmenu'],\n          open: contextMenuVisible.value,\n          onOpenChange: contextMenuVisibleChange\n        }, {\n          overlay: _withCtx(() => [\n            _createVNode(_component_a_menu, {\n              onClick: closeContextMenu,\n              items: menuList.value\n            }, null, 8, [\"items\"])\n          ]),\n          default: _withCtx(() => [\n            _createElementVNode(\"div\", {\n              class: \"tree-container\",\n              ref_key: \"treeContainer\",\n              ref: treeContainer\n            }, null, 512)\n          ]),\n          _: 1\n        }, 8, [\"open\"])\n      ])\n    ])\n  ]))\n}\n}\n\n})","<template>\n    <div class=\"view\" style=\"flex: 4.5\">\n        <div class=\"view-title\">\n            <span>Pattern Panel</span>\n            <span style=\"float: right; margin-right: 20px; \">\n                <span style=\"font-size: 15px\">\n                    <!-- <span>Match:</span>\n                    <a-button class=\"legend legend-null\" size=\"small\">No Extration</a-button>\n                    <span>Extract by:</span> -->\n                    <span>Match + Extract by:</span>\n                    <a-button-group style=\"margin: 0 20px 0 8px;\">\n                        <a-button class=\"legend legend-null\" size=\"small\" @click=\"selectMatchExtractArea('null')\"\n                            title=\"Click to select a starting area in the input table for matching without extraction. Press 'Esc' to cancel the selection mode.\">No\n                            Extration</a-button>\n                        <a-button class=\"legend legend-position\" size=\"small\"\n                            @click=\"selectMatchExtractArea('position')\"\n                            title=\"Click to select a starting area in the input table for matching and extracting by position. Press 'Esc' to cancel the selection mode.\">Position</a-button>\n                        <a-button class=\"legend legend-context\" size=\"small\" @click=\"selectMatchExtractArea('context')\"\n                            title=\"Click to select a starting area in the input table for matching and extracting by context. Press 'Esc' to cancel the selection mode.\">Context</a-button>\n                        <a-button class=\"legend legend-value\" size=\"small\" @click=\"selectMatchExtractArea('value')\"\n                            title=\"Click to select a starting area in the input table for matching and extracting by value. Press 'Esc' to cancel the selection mode.\">Value</a-button>\n                    </a-button-group>\n                </span>\n                <a-button id=\"draw_tree\" size=\"small\" @click=\"drawTree2\">\n                    <v-icon name=\"bi-arrow-clockwise\" scale=\"0.9\"></v-icon>\n                    <span>Reset View</span>\n                </a-button>\n            </span>\n        </div>\n        <div class=\"view-content\" style=\"display: flex;\">\n            <div style=\"flex: 1;\">\n                <div class=\"tbl-container\" ref=\"tblContainer\"></div>\n            </div>\n            <div style=\"flex: 1; margin-left: 5px\">\n                <a-dropdown :trigger=\"['contextmenu']\" :open=\"contextMenuVisible\"\n                    @openChange=\"contextMenuVisibleChange\">\n                    <template #overlay>\n                        <a-menu @click=\"closeContextMenu\" :items=\"menuList\">\n                        </a-menu>\n                    </template>\n                    <div class=\"tree-container\" ref=\"treeContainer\"></div>\n                </a-dropdown>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onMounted, ref, watch } from 'vue';\n// import * as d3 from 'd3';\n// import { flextree, FlextreeNode } from 'd3-flextree';\nimport { TreeChart } from '@/tree/drawTree';\nimport { message } from 'ant-design-vue';\nimport { AreaBox, TblCell, useTableStore } from \"@/store/table\";\nimport * as d3 from 'd3';\nimport { TypeColor, typeMapColor } from '@/tree/style';\nconst tableStore = useTableStore();\n\n/*\ninterface TreeNode {\n    [key: string]: any;\n    children?: TreeNode[];\n}\n\nconst data: TreeNode = {\n    name: 'Root',\n    children: [\n        { name: 'Child 1' },\n        {\n            name: 'Child 2',\n            children: [\n                { name: 'Grandchild 1' },\n                { name: 'Grandchild 2' },\n                { name: 'Grandchild 3' },\n            ]\n        }\n    ]\n};\n*/\n\nconst menuList = computed(() => tableStore.tree.menuList);\n// const contextMenuVisible = tableStore.tree.contextMenuVisible;\nconst contextMenuVisible = computed(() => tableStore.tree.contextMenuVisible && tableStore.tree.menuList.length > 0);\nconst contextMenuVisibleChange = (value: boolean) => {\n    // if (store.state.selectedNode.length === 0 && value === true) return;\n    // store.commit('setContextMenuVisibility', value);\n    tableStore.tree.contextMenuVisible = value;\n    tableStore.tree.menuList = [];\n    // setTimeout(() => {\n    //     tableStore.tree.menuList = [];\n    // }, 0)\n};\n\nconst closeContextMenu = (e: any) => {\n    // console.log(\"closeContextMenu\", e, e.key);\n    const visNode = tableStore.spec.selectNode.data;\n    let extract: any = null, extractColor: string = '';\n    let triggerCellCursorFlag = false;\n    let messageInfo = \"\\n Press ESC to cancel the selection mode.\";\n    const maxCNum = tableStore.findMaxCNumber() + 1;\n    switch (e.key) {\n        case \"0\":\n            // Reset Area Logic\n            messageInfo = \"Please reselect the template's area in the input table.\" + messageInfo;\n            triggerCellCursorFlag = true;\n            break;\n        case \"1\":\n            // Add Constraints Logic\n            messageInfo = \"Please select the constrained cell in the input table.\" + messageInfo;\n            triggerCellCursorFlag = true;\n            break;\n        case \"2-0\":\n            // Target Cols - Position Based Logic\n            extract = {\n                byPositionToTargetCols: Array.from({ length: visNode.width * visNode.height }, (_, i) => `C${maxCNum + i}`)\n            }\n            extractColor = 'positionShallow';\n            break;\n        case \"2-1\":\n            // Target Cols - Context Based Logic\n            extract = {\n                byContext: {\n                    position: 'above'\n                }\n            }\n            extractColor = 'contextShallow';\n            break;\n        case \"2-2\":\n            // Target Cols - Value Based Logic\n            const createExtract = () => {\n                return eval(`currentAreaTbl => {\n                  // Please replace the default code with the necessary implementation to complete the function.\n                  return currentAreaTbl.flat().map((cell, i) => 'C' + (${maxCNum} + i))\n                  }`)\n            }\n            extract = {\n                byValue: createExtract()\n            }\n            extractColor = 'valueShallow';\n            break;\n        case \"2-3\":\n            // Target Cols - No Extract Logic\n            tableStore.insertNodeOrPropertyIntoSpecs(undefined, \"extract\")\n            break;\n        case \"3\":\n            // Add Sub-Template Logic\n            messageInfo = \"Please select an area in the input table.\" + messageInfo;\n            triggerCellCursorFlag = true;\n            break;\n        case \"4\":\n            tableStore.deleteChildByPath(tableStore.spec.rawSpecs, visNode.path!);\n            tableStore.stringifySpec();\n            break;\n        case \"5\":\n            tableStore.deleteChildByPath(tableStore.spec.rawSpecs, visNode.path!, tableStore.spec.selectConstrIndex);\n            tableStore.stringifySpec();\n    }\n\n    if (extract !== null) {\n        tableStore.insertNodeOrPropertyIntoSpecs(extract, \"extract\")\n        tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine(extract, tableStore.getNodebyPath(tableStore.spec.rawSpecs, visNode.path!)), extractColor];\n    }\n    if (triggerCellCursorFlag) {\n        message.info(messageInfo);\n        tableStore.spec.selectAreaFromNode = e.key;\n        document.body.style.cursor = 'cell';\n        document.documentElement.style.setProperty('--custom-cursor', 'cell');\n        const cells = tableStore.generateHighlightCells(tableStore.spec.selectionsAreaFromLegend, tableStore.spec.selectAreaFromLegend);\n        tableStore.highlightTblCells(\"input_tbl\", cells);\n    }\n    tableStore.tree.contextMenuVisible = false;\n}\n\nconst treeContainer = ref<HTMLDivElement | null>(null);\n\nfunction drawTree2() {\n    drawTree(tableStore.spec.visTree);\n    drawTblTemplate();\n    // if (zoom && tblContainer.value) {\n    //     // 不能对g.matrix元素进行transform操作，因为zoom事件监听器是添加在svg元素上的，所以需要对svg元素进行transform操作\n    //     d3.select(tblContainer.value).select('svg').transition().duration(750)\n    //         .call(zoom.transform as any, d3.zoomIdentity); // 重置缩放和平移状态\n    // }\n}\n\nconst drawTree = (data: any) => {\n    const treeInstance = new TreeChart([2, 1], '.tree-container', data, tableStore, 1.0, 'h');\n    treeInstance.render();\n    tableStore.tree.visInst = treeInstance;\n};\n\nconst typeMap = {\n    \"null\": \"No Extration\",\n    \"position\": \"Position Based\",\n    \"context\": \"Context Based\",\n    \"value\": \"Value Based\",\n}\nconst selectMatchExtractArea = (type: TypeColor) => {\n    d3.selectAll('.legend').classed('legend-selection', false);\n    d3.select(`.legend.legend-${type}`).classed('legend-selection', true);\n    const selectionsFromLegend = tableStore.spec.selectionsAreaFromLegend;\n    const selectFromLegend = tableStore.spec.selectAreaFromLegend;\n    const cells = tableStore.generateHighlightCells(selectionsFromLegend, selectFromLegend);\n    tableStore.highlightTblCells(\"input_tbl\", cells);\n\n    if (selectFromLegend.length > selectionsFromLegend.length) {\n        selectFromLegend[selectFromLegend.length - 1] = type;\n    } else {\n        selectFromLegend.push(type);\n    }\n    // const cursorStyle = `url(${require('@/assets/cell.png')}), auto`;\n    document.body.style.cursor = 'cell';\n    document.documentElement.style.setProperty('--custom-cursor', 'cell');\n    message.info(\"Now is \" + typeMap[type as keyof typeof typeMap] + \" mode. Please select the starting area in the input table.\\n Press ESC to cancel the selection mode.\");\n    // tableStore.input_tbl.instance.rootElement.style.cursor = \"cell\";\n    // (document.querySelector('.truncated') as HTMLElement).style.cursor = \"cell\"\n}\n\n\n\nconst tblContainer = ref<HTMLDivElement | null>(null);\nlet offsetX = 0;\nlet offsetY = 0;\nlet transformStatue: any;\nlet zoom: d3.ZoomBehavior<SVGSVGElement, unknown> | null = null;\n\nconst drawTblTemplate = () => {\n    if (!tblContainer.value) return;\n    // Clear any existing SVG\n    d3.select(tblContainer.value).selectAll('svg').remove();\n\n    try {\n        const visChildren = tableStore.spec.visTree.children\n        if (visChildren === undefined || visChildren.length === 0 || visChildren[0].width === 0 || visChildren[0].height === 0) return;\n\n        const containerWidth = tblContainer.value.clientWidth;\n        const containerHeight = tblContainer.value.clientHeight;\n\n\n        let cellWidth = Math.max(5, Math.min(90, Math.floor(containerWidth / visChildren[0].width)));\n        let cellHeight = Math.max(5, Math.min(30, Math.floor(containerHeight / visChildren[0].height)));\n        // const cellWidth = 90;\n        // const cellHeight = 30;\n\n        zoom = d3.zoom<SVGSVGElement, unknown>()\n            // .scaleExtent([0.5, 3.5])  // set the zoom scale range\n            .on('zoom', function (event) {\n                // svg.attr('transform', event.transform);  // 直接设置svg的transform属性会导致缩放后的坐标系不正确（导致的问题是：用鼠标平移（pan）矩形的时候，矩形会抖动，导致矩形实际平移的距离小于鼠标平移的距离），因此需要在svg内部再添加一个g元素\n                d3.select('g.tbl-template').attr('transform', `translate(${offsetX + event.transform.x}, ${offsetY + event.transform.y}) scale(${event.transform.k})`); // Update the matrix transform based on the zoom event\n                updateCellTextVisibility(event.transform.k); // Update cell text visibility based on the current scale\n                // transformStatue = event.transform;\n            })\n\n        const svg = d3.select(tblContainer.value)\n            .append('svg')\n            .attr('width', containerWidth)\n            .attr('height', containerHeight)\n            .call(zoom)  // 注意，这里添加zoom的是svg元素，而不是g.matrix元素，所以当resetZoom时，需要对svg元素进行transform操作\n\n        const matrix = svg.append('g').classed(\"tbl-template\", true);  // Append a 'g' element for better transform management to avoid jittering\n        let texts: any = null;\n\n        const grids = tableStore.computeTblPatternGrid();\n        // console.log(\"grids\", grids);\n\n        const cells = matrix.selectAll('rect')\n            .data(grids)\n            .enter().append('rect').classed('tbl-template-cell', true)\n            .attr('x', d => d.col * cellWidth)\n            .attr('y', d => d.row * cellHeight)\n            // .attr('id', d => `tbl-template-${d.row}-${d.col}`)\n            .attr('width', cellWidth)\n            .attr('height', cellHeight)\n            .attr('fill', (d) => d.bgColor ? d.bgColor : '#f9f7ff')\n            .attr('stroke', '#cccccc')\n            .on('mouseover', function (this: SVGRectElement) {\n                d3.select(this).raise() // Bring the cell to the front \n                    // .attr('fill', '#ece9e6')\n                    // .attr('stroke', '#4b8aff')\n                    .attr('stroke-width', 2);\n                if (texts) {\n                    texts.raise();\n                }\n            })\n            .on('mouseout', function () {\n                d3.select(this)\n                    // .attr('fill', '#f9f7ff')\n                    // .attr('stroke', '#cccccc')\n                    .attr('stroke-width', 1);\n            })\n            .on('click', function (event, d: TblCell) {\n                // tableStore.grid_cell_click({ row: d.row + visChildren[0].y, col: d.col + visChildren[0].x });\n                const row = d.row + visChildren[0].y;\n                const col = d.col + visChildren[0].x;\n                d3.select(`#grid-${row}-${col}`).dispatch('click');\n                tableStore.highlightNodes([[row, col, row, col]]);\n                tableStore.input_tbl.instance.deselectCell();\n                tableStore.output_tbl.instance.deselectCell();\n            })\n            .append('title').text(d => {\n                if (d.text && d.text.length) {\n                    if (d.bgColor === typeMapColor.position || d.bgColor === typeMapColor.positionShallow) {\n                        return \"The cell's Target Column is:\\n\" + d.text.toString();\n                    } else {\n                        return \"The cell's Target Column may be:\\n\" + d.text.toString();\n                    }\n                } else {\n                    return \"No Target Column\";\n                }\n            });\n\n        // Calculate the offset to center the matrix in the SVG container\n        offsetX = Math.max((containerWidth - matrix.node()!.getBBox().width) / 2, 0);\n        offsetY = Math.max((containerHeight - matrix.node()!.getBBox().height) / 2, 0);\n        matrix.attr('transform', `translate(${offsetX}, ${offsetY})`); // Center the matrix\n        transformStatue = d3.zoomIdentity;\n\n        const updateCellTextVisibility = (scale: number) => {\n            const scaledCellWidth = cellWidth * scale;\n            const scaledCellHeight = cellHeight * scale;\n            // const cellArea = scaledCellWidth * scaledCellHeight;\n            if (scaledCellWidth >= 90 || scaledCellHeight >= 30) {\n                if (texts) {\n                    texts.style('display', 'block');\n                } else {\n                    texts = matrix.selectAll('text')\n                        .data(grids)\n                        .enter().append('text').classed('tbl-template-text', true)\n                        .attr('x', d => d.col * cellWidth + cellWidth / 2)\n                        .attr('y', d => d.row * cellHeight + cellHeight / 2)\n                        .attr('dy', '.30em')\n                        .attr('font-size', 15 / scale)\n                        .attr('fill', (d) => d.textColor ? d.textColor : typeMapColor.cellFill)\n                        .attr('text-anchor', 'middle')\n                        .text(d => d.text ? d.text[0] : '')\n                        .each(function (d) {\n                            const textElement = d3.select(this);\n                            let text = textElement.text();\n                            let textLength = this.getComputedTextLength();\n                            // 如果文本超出最大宽度，进行截断\n                            while (textLength > cellWidth && text.length > 0) {\n                                text = text.slice(0, -1);\n                                textElement.text(text + '…');\n                                textLength = this.getComputedTextLength();\n                            }\n                        })\n                        .style('display', 'block')\n                        .style('pointer-events', 'none'); // Ensure text does not capture mouse events, in order to allow clicking on the cells\n                }\n            } else {\n                if (texts) {\n                    texts.style('display', 'none');\n                }\n            }\n        };\n\n        updateCellTextVisibility(1); // Initial update for default scale 1\n\n        tableStore.tree.tblVisHighlight = matrix.append('g').classed('tbl-template-highlight', true);\n        tableStore.tree.tblVisInfo = {\n            x: visChildren[0].x,\n            y: visChildren[0].y,\n            width: cellWidth,\n            height: cellHeight\n        }\n\n    }\n    catch (e) {\n        console.error(e);\n    }\n}\n\n/*\nimport { debounce } from 'lodash';\n\n// import { TableTidierTemplate } from '@/grammar/grammar';\n\nconst debouncedResize = debounce(() => {\n    drawTree(tableStore.spec.visTree);\n}, 100); // 调整延迟时间，单位为毫秒\n\nconst resizeObserver = new ResizeObserver(() => {\n    debouncedResize();\n});\n*/\n\nwatch(() => tableStore.editor.mappingSpec.code, (newVal) => {\n    // console.log('watch code changed: start');\n    tableStore.editor.mappingSpec.instance?.setValue(newVal);\n    const setFlag = tableStore.prepareDataAfterCodeChange();\n    if (!setFlag) return;\n    tableStore.transformTablebyCode();  // auto run\n    drawTree(tableStore.spec.visTree);\n    drawTblTemplate();\n    // console.log('watch code changed: end');\n});\n\n// watch(() => tableStore.spec.visTree.size.height, (newVal) => {\n//     console.log('watch tbl size changed: start');\n//     const setFlag = tableStore.prepareDataAfterCodeChange();\n//     if (!setFlag) return;\n//     drawTree(tableStore.spec.visTree);\n//     console.log('watch tbl size changed: end');\n// });\n\n\nonMounted(() => {\n    if (treeContainer.value) {\n        // resizeObserver.observe(treeContainer.value);\n    }\n    // drawTree(tableStore.spec.visTree);\n});\n\n\n\n</script>\n\n<style lang=\"less\">\n.tree-container {\n    width: 100%;\n    height: 100%;\n\n    .type-node:hover {\n        stroke: var(--color-selection);\n        stroke-width: 3px;\n    }\n\n    .type-node.selection {\n        stroke: var(--color-selection);\n        stroke-width: 3px;\n    }\n}\n\n.tbl-container {\n    width: 100%;\n    height: 100%;\n\n    .tbl-template-cell:hover {\n        stroke: var(--color-selection);\n        stroke-width: 2px;\n    }\n}\n\n.legend-selection {\n    border-color: #0a58d9 !important; // var(--color-selection);\n}\n\n.legend-null {\n    background: var(--color-null);\n    border-color: var(--color-null);\n    // opacity: 0.5; /* 设置元素的透明度为 0.5 */\n}\n\n.legend-position {\n    background: var(--color-position);\n    border-color: var(--color-position);\n}\n\n// .legend-position:hover {\n//     background: var(--color-position) !important;\n// }\n\n.legend-context {\n    background: var(--color-context);\n    border-color: var(--color-context);\n}\n\n.legend-value {\n    background: var(--color-value);\n    border-color: var(--color-value);\n}\n\n.legend {\n    color: white !important;\n    border-width: 2.5px;\n\n    // 设置 span 标签内的文本水平和垂直居中\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    span {\n        text-align: center;\n        width: 100%;\n        /* 确保文本内容水平居中 */\n    }\n}\n\n.legend:hover {\n    color: white !important;\n    border-color: #0a58d9 !important;\n}\n</style>","// The Declarative Grammar v0.4.3\n\ntype CellValueType = string | number | undefined;\n\n/**\n * Defines a set of keywords used in the TableTidier Grammar.\n *\n * - `String`: Used in `valueCstr` of `constraints` to specify that a cell must contain a string value.\n * - `Number`: Used in `valueCstr` of `constraints` to specify that a cell must contain a numeric value.\n * - `None`: Used in `valueCstr` of `constraints` to specify that a cell must be empty, null, or undefined.\n * - `NotNone`: Used in `valueCstr` of `constraints` to specify that a cell must not be empty, null, or undefined.\n * - `Forward`: Used in the `fill` property to indicate that columns with a length less than the maximum length will be filled with the last available value, ensuring that all columns in the output table have equal lengths.\n * - `Auto`: Used in the `fill` property to indicate that columns with a length less than the maximum length will be automatically filled with null or empty strings, depending on the information of the matching area and pattern.\n * - `pairSort`: Used in user-defined functions to sort array `A` according to the specified order (`asc` or `desc`) and reorders array `B`, so that its elements correspond to the newly sorted order of `A`.\n */\nconst TableTidierKeyWords = {\n    /**\n     * Used in `valueCstr` of `constraints` to specify that a cell must contain a string value.\n     */\n    String: 'TableTidierKeyWords.String',\n    /**\n     * Used in `valueCstr` of `constraints` to specify that a cell must contain a numeric value.\n     */\n    Number: 'TableTidierKeyWords.Number',\n    /**\n     * Used in `valueCstr` of `constraints` to specify that a cell must be empty, null, or undefined.\n     */\n    None: 'TableTidierKeyWords.None',\n    /**\n     * Used in `valueCstr` of `constraints` to specify that a cell must not be empty, null, or undefined.\n     */\n    NotNone: 'TableTidierKeyWords.NotNone',\n    /**\n     * Used in the `fill` property to indicate that columns with a length less than the maximum length will be filled with the last available value, ensuring that all columns in the output table have equal lengths.\n     */\n    Forward: 'TableTidierKeyWords.Forward',\n    /**\n     * Used in the `fill` property to indicate that columns with a length less than the maximum length will be automatically filled with null or empty strings, depending on the information of the matching area and pattern.\n     */\n    Auto: 'TableTidierKeyWords.Auto',\n    /**\n     * Used in user-defined functions to sort array `A` according to the specified order (`asc` or `desc`) and reorders array `B`\n     * so that its elements correspond to the newly sorted order of `A`.\n     *\n     * @param {any[]} A - The array whose elements determine the sort order.\n     * @param {any[]} B - The array to be reordered based on the sorted order of `A`.\n     * @param {'asc' | 'desc'} sortOrder - The sorting order: 'asc' for ascending, 'desc' for descending.\n     * @returns {any[]} - The reordered array `B` with elements corresponding to the sorted order of `A`.\n     *\n     * @example\n     * ```typeScript\n     * const A = [3, 1, 2];\n     * const B = ['Col1', 'Col2', 'Col3'];\n     * const correspondingB_Asc = TableTidierKeyWords.pairSort(A, B, 'asc');\n     * // ['Col3', 'Col1', 'Col2']\n     * const correspondingB_Desc = TableTidierKeyWords.pairSort(A, B, 'desc');\n     * // ['Col1', 'Col3', 'Col2']\n     * ```\n     */\n    pairSort: sortWithCorrespondingArray,\n};\n\n/**\n * Represents the matched index of a matched area\n * - `templateRef`: The template reference that matches this area\n * - `instanceIndex`: The instance index of this area that matches the templateRef within the parent area\n * - `xIndex`: The x-axis index of this area within the parent area\n * - `yIndex`: The y-axis index of this area within the parent area\n */\ninterface MatchedIndex {\n    /**\n     * The template reference that matches this area\n     */\n    templateRef: number[];\n    /**\n     * The instance index of this area that matches the templateRef within the parent area\n     */\n    instanceIndex: number;\n    /**\n     * The x-axis index of this area within the parent area\n     */\n    xIndex: number;\n    /**\n     * The y-axis index of this area within the parent area\n     */\n    yIndex: number;\n}\n\n/**\n * Represents a single cell within an area\n * - `xOffset`: The x-axis offset of the cell within the area\n * - `yOffset`: The y-axis offset of the cell within the area\n * - `value`: The value of the cell\n */\ninterface AreaCell {\n    /**\n     * The x-axis offset of the cell within the area\n     */\n    xOffset: number;\n    /**\n     * The y-axis offset of the cell within the area\n     */\n    yOffset: number;\n    /**\n     * The value of the cell\n     */\n    value: CellValueType;\n}\n\n/**\n * Represents the position of a cell\n */\ninterface CellPosi {\n    /**\n     * The x-coordinate of the cell\n     */\n    x: number;\n    /**\n     * The y-coordinate of the cell\n     */\n    y: number;\n}\n\n/**\n * Represents information about a cell\n * - `x`: The x-coordinate of the cell\n * - `y`: The y-coordinate of the cell\n * - `value`: The value of the cell\n */\ninterface CellInfo extends CellPosi {\n    /**\n     * The value of the cell\n     */\n    value: CellValueType;\n}\n\ntype Table2D = CellValueType[][];\n\n// Function types\n\n/**\n * A function that calculates an offset based on the current area information and the root area information.\n * @param currentArea - The current area information.\n * @param rootArea - The root area information.\n * @returns The calculated offset.\n */\ntype offsetFn = (currentArea: AreaInfo, rootArea: AreaInfo) => number;\n\n/**\n * A function that checks if a cell value meets a custom condition.\n * @param value - The value of the constrained cell.\n * @returns A boolean indicating whether the cell value meets the condition.\n */\ntype checkValueFn = (value: CellValueType) => boolean;\n\n/**\n * A function that maps the cells in an area to their corresponding target columns.\n * @param currentAreaTbl - The current area table.\n * @returns An array of target column names or null values.\n */\ntype mapColsFn = (currentAreaTbl: Table2D) => (CellValueType | null)[];\n\n/**\n * A function that maps the context cells to a specific target column.\n * @param ctxCells - The info (position and value) of the context cells.\n * @returns The name of the target column or null.\n */\ntype mapColbyContextFn = (ctxCells: CellInfo[]) => CellValueType | null;\n\n/**\n * A function that defines the position of a cell's context based on the current area information and the root area information.\n * @param cell - The current cell's value and its position relative to the current area.\n * @param currentArea - The current area information.\n * @param rootArea - The root area information.\n * @returns An array of cell selections that define the positions of the cell's context.\n */\ntype contextPosiFn = (\n    cell: AreaCell,\n    currentArea: AreaInfo,\n    rootArea: AreaInfo\n) => CellSelection[];\n\n/**\n * A function that determines the layer of an area based on its current area information.\n * @param currentArea - The current area information.\n * @returns The layer number of the area.\n */\ntype areaLayerFn = (currentArea: AreaInfo) => number;\n\n/**\n * Represents the information of a selected area within the table\n * - `parent`: The parent area of this area\n * - `areaLayer`: The layer level of this area within the root area\n * - `templateRef`: The template reference that matches this area\n * - `instanceIndex`: The instance index of this area that matches the templateRef within the parent area\n * - `xIndex`: The x-axis index of this area within the parent area\n * - `yIndex`: The y-axis index of this area within the parent area\n * - `xOffset`: The x-axis offset of this area within the parent area\n * - `yOffset`: The y-axis offset of this area within the parent area\n * - `x`: The x-coordinate of this area within the entire table\n * - `y`: The y-coordinate of this area within the entire table\n * - `width`: The width of this area\n * - `height`: The height of this area\n * - `areaTbl`: All cells within this area\n * - `children`: The child areas of this area\n */\ninterface AreaInfo extends MatchedIndex {\n    /**\n     * The parent area of this area\n     */\n    parent: AreaInfo | null;\n    /**\n     * The layer level of this area within the root area\n     */\n    areaLayer: number;\n    /**\n     * The x-axis offset of this area within the parent area\n     */\n    xOffset: number;\n    /**\n     * The y-axis offset of this area within the parent area\n     */\n    yOffset: number;\n    /**\n     * The x-coordinate of this area within the entire table\n     */\n    x: number;\n    /**\n     * The y-coordinate of this area within the entire table\n     */\n    y: number;\n    /**\n     * The width of this area\n     */\n    width: number;\n    /**\n     * The height of this area\n     */\n    height: number;\n    /**\n     * All cells within this area\n     */\n    areaTbl: Table2D;\n    /**\n     * The child areas of this area\n     */\n    children: AreaInfo[];\n}\n\n/**\n * Represents the selection of a cell within the table\n * - `referenceAreaLayer`: The reference area layer for selection, default is 'current'\n * - `referenceAreaPosi`: The reference area position for selection, default is 'topLeft'\n * - `xOffset`: The x-axis offset relative to the reference area, default is 0\n * - `yOffset`: The y-axis offset relative to the reference area, default is 0\n */\ninterface CellSelection {\n    /**\n     * The reference area layer for selection, default is 'current'\n     * - `areaLayerFn` (currentArea: AreaInfo) => number: A function that determines the layer of an area based on its current area information.\n     *   - `currentArea` : The current area information.\n     *   @example\n     *   (currentArea) => currentArea.areaLayer - 2\n     */\n    referenceAreaLayer?: 'current' | 'parent' | 'root' | areaLayerFn;\n    /**\n     * The reference area position for selection, default is 'topLeft'\n     */\n    referenceAreaPosi?: 'topLeft' | 'bottomLeft' | 'topRight' | 'bottomRight';\n    /**\n     * The x-axis offset relative to the reference area, default is 0\n     * - `offsetFn` (currentArea: AreaInfo, rootArea: AreaInfo) => number: A function that returns the x-axis offset\n     *   - `currentArea` : The current area information.\n     *   - `rootArea` : The root area information.\n     *   @example\n     *   (currentArea, rootArea) => currentArea.x - rootArea.x\n     */\n    xOffset?: number | offsetFn;\n    /**\n     * The y-axis offset relative to the reference area, default is 0\n     * - `offsetFn` (currentArea: AreaInfo, rootArea: AreaInfo) => number: A function that returns the y-axis offset\n     *   - `currentArea` : The current area information.\n     *   - `rootArea` : The root area information.\n     *   @example\n     *   (currentArea, rootArea) => currentArea.y - rootArea.y\n     */\n    yOffset?: number | offsetFn;\n}\n\n/**\n * Represents a constraint on a cell's value\n * - `valueCstr`: The value constraint\n *   - `TableTidierKeyWords.String` (default): Specifies that the cell's value must be a string.\n *   - `TableTidierKeyWords.Number`: Specifies that the cell's value must be a number.\n *   - `TableTidierKeyWords.None`: Specifies that the cell must be empty, null, or undefined.\n *   - `TableTidierKeyWords.NotNone`: Specifies that the cell must not be empty, null, or undefined.\n *   - `CellValueType`: Specifies that the cell's value must be equal to the provided value.\n *   - `checkValueFn`: Specifies a custom function to check if the cell's value meets certain conditions.\n * - `ignoreOutOfBounds` - Determines whether to ignore the constraint when the specified cell exceeds the table boundaries.\n *   - `true` (default) means that if the specified cell is out of bounds, the constraint will be ignored, and the search will continue with other checks.\n *   - `false` means that if the specified cell is out of bounds, the pattern will be considered as not matching, even if other conditions are satisfied.\n */\ninterface CellConstraint extends CellSelection {\n    /**\n     * The value constraint\n     * - `TableTidierKeyWords.String` (default): Specifies that the cell's value must be a string.\n     * - `TableTidierKeyWords.Number`: Specifies that the cell's value must be a number.\n     * - `TableTidierKeyWords.None`: Specifies that the cell must be empty, null, or undefined.\n     * - `TableTidierKeyWords.NotNone`: Specifies that the cell must not be empty, null, or undefined.\n     * - `CellValueType`: Specifies that the cell's value must be equal to the provided value.\n     * - `checkValueFn` (value: CellValueType) => boolean: Specifies a custom function to check if the cell's value meets certain conditions.\n     *   - `value` : The value of the constrained cell.\n     *   @example\n     *   (value) => typeof value === 'number' && value > 0\n     *   // The cell's value must be a number and greater than 0\n     */\n    valueCstr?: CellValueType | checkValueFn;\n    /**\n     * Determines whether to ignore the constraint when the specified cell exceeds the table boundaries.\n     * - `true` (default) means that if the specified cell is out of bounds, the constraint will be ignored, and the search will continue with other checks.\n     * - `false` means that if the specified cell is out of bounds, the pattern will be considered as not matching, even if other conditions are satisfied.\n     */\n    ignoreOutOfBounds?: boolean;\n}\n\n/**\n * ContextTransform specifies how to derive the target column for a cell based on its context cell.\n *\n * - `position`: Defines the location of the context cell relative to the current cell.\n *   - 'above' (default): The context cell is located directly above the current cell.\n *   - 'below': The context cell is located directly below the current cell.\n *   - 'left': The context cell is located directly to the left of the current cell.\n *   - 'right': The context cell is located directly to the right of the current cell.\n *   - `contextPosiFn`: A custom function to determine the position of a cell's context.\n *\n * - `toTargetCol`: Determines how to derive the target column based on the context cell(s).\n *   - `mapColbyContextFn` (ctxCells: CellInfo[]) => CellValueType | null: A custom function to map the context cells to a specific target column. If the function returns null, the cell will not be transformed to the output table. This function will return the first context cell's value as the target column by default (i.e., `(ctxCells) => ctxCells[0].value`).\n */\ninterface ContextTransform {\n    /**\n       * Defines the location of the context cell relative to the current cell.\n       * - 'above' (default): The context cell is located directly above the current cell.\n       * - 'below': The context cell is located directly below the current cell.\n       * - 'left': The context cell is located directly to the left of the current cell.\n       * - 'right': The context cell is located directly to the right of the current cell.\n       * - `contextPosiFn` (cell: AreaCell, currentArea: AreaInfo, rootArea: AreaInfo) => CellSelection[]: A custom function to determine the position of a cell's context\n       *   - `cell`: The current cell's value and its position relative to the current area.\n       *   - `currentArea`: The current area information.\n       *   - `rootArea`: The root area information.\n       *   - returns — An array of cell selections that define the positions of the cell's context. (A cell's context can be defined by multiple selections)\n       *   @example\n       *   (cell, currentArea, rootArea) => {\n                  return [{\n                      xOffset: cell.xOffset,\n                      yOffset: cell.yOffset - (currentArea.yIndex + 1) * currentArea.height,\n                  }];\n              }\n       */\n    position?: \"above\" | \"below\" | \"left\" | \"right\" | contextPosiFn;\n    /**\n       * Determines how to derive the target column based on the context cell(s).\n       * - `mapColbyContextFn` (ctxCells: CellInfo[]) => CellValueType | null: A custom function to map the context cells to a specific target column. If the function returns null, the cell will not be transformed to the output table. This function will return the first context cell's value as the target column by default (i.e., `(ctxCells) => ctxCells[0].value`).\n       *   - `ctxCells`: The info (position and value) of the context cells.\n       *   @example\n       *   (ctxCells) => {\n           if (typeof ctxCells[0].value === \"number\") {\n               if (ctxCells[0].value > 0) {\n                   return \"positive\";\n               } else {\n                   return \"negative\";\n               }\n           }\n           return null;\n       }\n       */\n    toTargetCol?: mapColbyContextFn;\n}\n\n/**\n * The main template for defining the transformation rules\n * - `match`: The matching criteria for a selecting area\n *   - `startCell`: The starting cell for the selection\n *     - `referenceAreaLayer`: The reference area layer for selection, default is 'current'\n *     - `referenceAreaPosi`: The reference area position for selection, default is 'topLeft'\n *     - `xOffset`: The x-axis offset relative to the reference area, default is 0\n *     - `yOffset`: The y-axis offset relative to the reference area, default is 0\n *   - `size`: The size of the selected area\n *     - `width`: The width of the selected area; 'toParentX' means the distance from the startCell to the parent's x-axis end; `null` means no fixed width, default is 1\n *     - `height`: The height of the selected area; 'toParentY' means the distance from the startCell to the parent's y-axis end; `null` means no fixed height, default is 1\n *   - `constraints`: Constraints to apply to the cells within the selected area\n *     - `referenceAreaLayer`: The reference area layer for the constrainted cell, default is 'current'\n *     - `referenceAreaPosi`: The reference area position for the constrainted cell, default is 'topLeft'\n *     - `xOffset`: The x-axis offset relative to the reference area, default is 0\n *     - `yOffset`: The y-axis offset relative to the reference area, default is 0\n *     - `valueCstr`: The value constraint, default is `TableTidierKeyWords.String`\n *     - `ignoreOutOfBounds`: Determines whether to ignore the constraint when the specified cell exceeds the table boundaries, default is true\n *   - `traverse`: The traversal direction for the selected area\n *     - `xDirection`: The x-axis traversal direction; 'after' means traversing after the startCell; 'before' means traversing before the startCell; 'whole' means traversing the entire area; default is null, meaning no traversal\n *     - `yDirection`: The y-axis traversal direction; 'after' means traversing after the startCell; 'before' means traversing before the startCell; 'whole' means traversing the entire area; default is null, meaning no traversal\n * - `extract`: The extraction rules for transforming the selected area\n *   - `byContext`: The context-based transformation for the selected area\n *     - `position`: Defines the location of the context cell relative to the current cell, default is 'above'\n *     - `toTargetCol`: Determines how to derive the target column based on the context cell(s). This function will return the first context cell's value as the target column by default.\n *   - `byPositionToTargetCols`: The target columns for the transformation, which is an array (position-based transformation)\n *   - `byValue`: The custom function for value-based transformation\n * - `fill`: Specifies how to handle columns in the output table that have different lengths after extracting values from the matched region.\n *   - `TableTidierKeyWords.Auto` (default) means that columns with a length less than the maximum length will be automatically filled with null or empty strings, depending on the information of the matching area and pattern.\n *   - `TableTidierKeyWords.Forward` means that columns with a length less than the maximum length will be filled with the last available value, ensuring that all columns in the output table have equal lengths.\n *   - `null` means no filling will occur, and columns can have different lengths.\n *   - `CellValueType`: A custom value can also be provided, which will be used to fill the column to match the length of the longest column.\n * - `children`: The child templates for nested selections\n */\ninterface TableTidierTemplate {\n    /**\n     * The matching criteria for a selecting area\n     */\n    match?: {\n        /**\n         * The starting cell for the selection\n         * - `referenceAreaLayer`: The reference area layer for selection, default is 'current'\n         * - `referenceAreaPosi`: The reference area position for selection, default is 'topLeft'\n         * - `xOffset`: The x-axis offset relative to the reference area, default is 0\n         * - `yOffset`: The y-axis offset relative to the reference area, default is 0\n         */\n        startCell?: CellSelection;\n        /**\n         * The size of the selected area\n         */\n        size?: {\n            /**\n             * The width of the selected area; 'toParentX' means the distance from the startCell to the parent's x-axis end; `null` means that the selected area does not have a fixed width (its width depends on the constraints), default is 1\n             */\n            width?: number | \"toParentX\" | null;\n            /**\n             * The height of the selected area; 'toParentY' means the distance from the startCell to the parent's y-axis end; `null` means that the selected area does not have a fixed height (its height depends on the constraints), default is 1\n             */\n            height?: number | \"toParentY\" | null;\n        };\n        /**\n         * Constraints to apply to the cells within the selected area\n         * - `referenceAreaLayer`: The reference area layer for the constrainted cell, default is 'current'\n         * - `referenceAreaPosi`: The reference area position for the constrainted cell, default is 'topLeft'\n         * - `xOffset`: The x-axis offset relative to the reference area, default is 0\n         * - `yOffset`: The y-axis offset relative to the reference area, default is 0\n         * - `valueCstr`: The value constraint, default is `TableTidierKeyWords.String`\n         * - `ignoreOutOfBounds`: Determines whether to ignore the constraint when the specified cell exceeds the table boundaries, default is true\n         */\n        constraints?: CellConstraint[];\n        /**\n         * The traversal direction for the selected area\n         */\n        traverse?: {\n            /**\n             * The x-axis traversal direction; 'after' means traversing after the startCell; 'before' means traversing before the startCell; 'whole' means traversing the entire area; default is null, meaning no traversal\n             */\n            xDirection?: null | \"after\" | \"before\" | \"whole\";\n            /**\n             * The y-axis traversal direction; 'after' means traversing after the startCell; 'before' means traversing before the startCell; 'whole' means traversing the entire area; default is null, meaning no traversal\n             */\n            yDirection?: null | \"after\" | \"before\" | \"whole\";\n        };\n    };\n    /**\n     * The extraction rules for transforming the selected area\n     */\n    extract?: {\n        /**\n         * The context-based transformation for the selected area\n         * - `position`: Defines the location of the context cell relative to the current cell, default is 'above'\n         * - `toTargetCol`: Determines how to derive the target column based on the context cell(s). This function will return the first context cell's value as the target column by default.\n         */\n        byContext?: ContextTransform;\n        /**\n         * The target columns for the transformation, which is an array (position-based transformation)\n         */\n        byPositionToTargetCols?: (CellValueType | null)[];\n        /**\n         * The custom function for value-based transformation.\n         * - `mapColsFn` (currentAreaTbl: Table2D) => (CellValueType | null)[]: Map the cells in an area to their corresponding target columns.\n         * @param currentAreaTbl - The current area table.\n         * @example\n         * (currentAreaTbl) => currentAreaTbl.flat().map((cell, i) => 'Col' + (i + 1));\n         * // => ['Col1', 'Col2', 'Col3', ...]\n         */\n        byValue?: mapColsFn;\n    } | null;\n    /**\n     * Specifies how to handle columns in the output table that have different lengths after extracting values from the matched region.\n     * - `TableTidierKeyWords.Auto` (default) means that columns with a length less than the maximum length will be automatically filled with null or empty strings, depending on the information of the matching area and pattern.\n     * - `TableTidierKeyWords.Forward` means that columns with a length less than the maximum length will be filled with the last available value, ensuring that all columns in the output table have equal lengths.\n     * - `null` means no filling will occur, and columns can have different lengths.\n     * - `CellValueType`: A custom value can also be provided, which will be used to fill the column to match the length of the longest column.\n     */\n    fill?: CellValueType | null;\n    /**\n     * The child templates for nested selections\n     */\n    children?: TableTidierTemplate[];\n}\n\n// TableTidierTemplate 是我定义的一个转换表格的语法，我现在想为这个语法写注释，目的是为了让用户在前端使用我的语法时，鼠标悬浮在语法的属性上，能看到这个属性的完整数据类型，以及解释说明，如果这个属性可以是自定义函数的数据类型，则一定要展示这个自定义函数的参数（包括其解释和数据类型）以及返回值，并根据这个函数定义再提供一个example，让用户更好地理解。\n// 因此，请帮我重新组织一下我的语法comment，以方便用户悬浮在语法上，看到完整的数据类型，以及解释说明。\n\n/**\n * Sorts array `A` according to the specified order (`asc` or `desc`) and reorders array `B`\n * so that its elements correspond to the newly sorted order of `A`.\n *\n * @param {any[]} A - The array whose elements determine the sort order.\n * @param {any[]} B - The array to be reordered based on the sorted order of `A`.\n * @param {'asc' | 'desc'} sortOrder - The sorting order: 'asc' for ascending, 'desc' for descending.\n * @returns {any[]} - The reordered array `B` with elements corresponding to the sorted order of `A`.\n *\n * @example\n * const A = [3, 1, 2];\n * const B = ['Col1', 'Col2', 'Col3'];\n * const correspondingB_Asc = sortWithCorrespondingArray(A, B, 'asc');  // ['Col3', 'Col1', 'Col2']\n * const correspondingB_Desc = sortWithCorrespondingArray(A, B, 'desc'); // ['Col1', 'Col3', 'Col2']\n */\nfunction sortWithCorrespondingArray(A: any[], B: any[], sortOrder: 'asc' | 'desc'): any[] {\n    let indexedA = A.map((value, index) => ({ value, index }));\n    indexedA.sort((a, b) => {\n        if (sortOrder === 'asc') {\n            return a.value < b.value ? -1 : a.value > b.value ? 1 : 0;\n        } else {\n            return a.value > b.value ? -1 : a.value < b.value ? 1 : 0;\n        }\n    });\n    const sortedB = new Array(B.length);\n    indexedA.forEach((e, i) => sortedB[e.index] = B[i]);\n    return sortedB;\n}\n\n/********************************************************************************/\n\n// Ensure all properties are defined\ntype NonUndefined<T> = T extends undefined ? never : T;\ntype AllParams<T> = {\n    [K in keyof T]-?: NonUndefined<T[K]> extends object\n    ? AllParams<NonUndefined<T[K]>>\n    : NonUndefined<T[K]>;\n};\n\n/*\ninterface Test {\n    param1?: string;\n    param2?: number;\n    param3?: { \"P1\": boolean, \"P2\"?: number };\n}\nlet aInfo: Test = {\n    param1: 'value1',\n    param2: 42,\n    param3: {\n        P1: true\n    },\n};\nlet aa = aInfo as AllParams<Test>;\nconsole.log(aa.param3.P2);\n*/\n\n// Construct a specification with default values\n\n// default values\nconst DEFAULT_WIDTH = 1;\nconst DEFAULT_HEIGHT = 1;\nconst DEFAULT_REFERENCE_AREA_LAYER = \"current\";\nconst DEFAULT_REFERENCE_AREA_POSI = \"topLeft\";\nconst DEFAULT_X_OFFSET = 0;\nconst DEFAULT_Y_OFFSET = 0;\nconst DEFAULT_X_DIRECTION = null;\nconst DEFAULT_Y_DIRECTION = null;\nconst DEFAULT_CONTEXT_POSITION = \"above\";\nconst DEFAULT_TARGET_COL = (ctxCells => ctxCells[0].value) as mapColbyContextFn; // null;\nconst DEFAULT_VALUE_CSTR = TableTidierKeyWords.String;\nconst DEFAULT_IGNORE_OUT_OF_BOUNDS = true;\nconst DEFAULT_FILL = TableTidierKeyWords.Auto; // null;\n\nfunction completeCellSelection(\n    selection: CellSelection | undefined\n): CellSelection {\n    if (!selection) {\n        return {\n            referenceAreaLayer: DEFAULT_REFERENCE_AREA_LAYER,\n            referenceAreaPosi: DEFAULT_REFERENCE_AREA_POSI,\n            xOffset: DEFAULT_X_OFFSET,\n            yOffset: DEFAULT_Y_OFFSET,\n        };\n    }\n    return {\n        referenceAreaLayer:\n            selection.referenceAreaLayer || DEFAULT_REFERENCE_AREA_LAYER,\n        referenceAreaPosi:\n            selection.referenceAreaPosi || DEFAULT_REFERENCE_AREA_POSI,\n        xOffset:\n            selection.xOffset === undefined ? DEFAULT_X_OFFSET : selection.xOffset,\n        yOffset:\n            selection.yOffset === undefined ? DEFAULT_Y_OFFSET : selection.yOffset,\n    };\n}\n\nfunction completeCellConstraint(\n    constraint: CellConstraint\n): AllParams<CellConstraint> {\n    const completedSelection = completeCellSelection(constraint);\n    return {\n        ...completedSelection,\n        valueCstr:\n            constraint.valueCstr === undefined\n                ? DEFAULT_VALUE_CSTR\n                : constraint.valueCstr,\n        ignoreOutOfBounds:\n            constraint.ignoreOutOfBounds === undefined\n                ? DEFAULT_IGNORE_OUT_OF_BOUNDS\n                : constraint.ignoreOutOfBounds,\n    } as AllParams<CellConstraint>;\n}\n\nfunction completeContextTransform(\n    transform: ContextTransform\n): ContextTransform {\n    return {\n        position: transform.position || DEFAULT_CONTEXT_POSITION,\n        toTargetCol: transform.toTargetCol || DEFAULT_TARGET_COL,\n    };\n}\n\n/*\nfunction completeSpecification(template: TableTidierTemplate): AllParams<TableTidierTemplate> {\n    return {\n        startCell: completeCellSelection(template.startCell),\n        size: {\n            width: template.size?.width === undefined ? DEFAULT_WIDTH : template.size.width,\n            height: template.size?.height === undefined ? DEFAULT_HEIGHT : template.size.height\n        },\n        constraints: template.constraints?.map(completeCellConstraint) || [],\n        traverse: {\n            xDirection: template.traverse?.xDirection === undefined ? DEFAULT_X_DIRECTION : template.traverse.xDirection,\n            yDirection: template.traverse?.yDirection === undefined ? DEFAULT_Y_DIRECTION : template.traverse.yDirection\n        },\n        transform: template.transform\n            ? {\n                context: template.transform.context ? completeContextTransform(template.transform.context) : null,\n                targetCols: template.transform.targetCols || DEFAULT_TARGET_COLS\n            }\n            : null,\n        fill: template.fill === undefined ? DEFAULT_FILL : template.fill,\n        children: template.children?.map(completeSpecification) || []\n    } as AllParams<TableTidierTemplate>;\n}\n*/\n\nfunction completeSpecification(\n    template: TableTidierTemplate\n): AllParams<TableTidierTemplate> {\n    return {\n        match: {\n            startCell: completeCellSelection(template.match?.startCell),\n            size: {\n                width:\n                    template.match?.size?.width === undefined\n                        ? DEFAULT_WIDTH\n                        : template.match.size.width,\n                height:\n                    template.match?.size?.height === undefined\n                        ? DEFAULT_HEIGHT\n                        : template.match.size.height,\n            },\n            constraints:\n                template.match?.constraints?.map(completeCellConstraint) || [],\n            traverse: {\n                xDirection:\n                    template.match?.traverse?.xDirection === undefined\n                        ? DEFAULT_X_DIRECTION\n                        : template.match.traverse.xDirection,\n                yDirection:\n                    template.match?.traverse?.yDirection === undefined\n                        ? DEFAULT_Y_DIRECTION\n                        : template.match.traverse.yDirection,\n            },\n        },\n        extract: template.extract\n            ? {\n                byPositionToTargetCols:\n                    template.extract.byPositionToTargetCols || undefined,\n                byContext: template.extract.byContext\n                    ? completeContextTransform(template.extract.byContext)\n                    : undefined,\n                byValue: template.extract.byValue || undefined,\n            }\n            : null,\n        fill: template.fill === undefined ? DEFAULT_FILL : template.fill,\n        children: template.children?.map(completeSpecification) || [],\n    } as AllParams<TableTidierTemplate>;\n}\n\n// Complete the specification with default values\n// function completeSpecification(specification: TableTidierTemplate): AllParams<TableTidierTemplate> {\n//     return completeTemplate(specification) as AllParams<TableTidierTemplate>;\n// }\n\nexport {\n    Table2D,\n    TableTidierTemplate,\n    CellValueType,\n    CellConstraint,\n    ContextTransform,\n    CellPosi,\n    TableTidierKeyWords,\n    CellInfo,\n    AllParams,\n    AreaInfo,\n    MatchedIndex,\n    CellSelection,\n    offsetFn,\n    completeSpecification,\n    completeCellSelection,\n    completeCellConstraint,\n};\n","import { Table2D, TableTidierTemplate, CellValueType, CellConstraint, CellPosi, TableTidierKeyWords, CellInfo, AllParams, AreaInfo, MatchedIndex, CellSelection, offsetFn, completeCellSelection, completeSpecification, ContextTransform } from \"./grammar\";\n\nimport { CustomError } from \"../types\";\n\nexport function serialize(obj: any): string {\n    const seen = new WeakSet();\n\n    return JSON.stringify(obj, function (key, value) {\n        if (typeof value === 'object' && value !== null) {\n            if (seen.has(value)) {\n                // 如果之前见过这个对象，则返回一个标记字符串\n                return `[Circular reference: ${key}]`;\n            }\n            seen.add(value);\n        }\n        return value;\n    }, 2);\n}\n\n// Helper function to evaluate constraints\nconst evaluateConstraint = (cellValue: CellValueType, constraint: CellConstraint): boolean => {\n    if (typeof constraint.valueCstr === 'function') {\n        return constraint.valueCstr(cellValue);\n    }\n    if (constraint.valueCstr === TableTidierKeyWords.String) {\n        return typeof cellValue === 'string' && cellValue !== '' && isNaN(Number(cellValue));\n    }\n    if (constraint.valueCstr === TableTidierKeyWords.Number) {\n        return typeof cellValue === 'number' || (typeof cellValue === 'string' && cellValue !== '' && !isNaN(Number(cellValue)));\n    }\n    if (constraint.valueCstr === TableTidierKeyWords.None) {\n        return cellValue === null || cellValue === '' || cellValue === undefined;\n    }\n    if (constraint.valueCstr === TableTidierKeyWords.NotNone) {\n        return cellValue !== null && cellValue !== '' && cellValue !== undefined;\n    }\n    return cellValue === constraint.valueCstr;\n};\n\nconst calculateOffset = (offset: number | offsetFn, currentArea: AreaInfo, rootArea: AreaInfo): number => {\n    return typeof offset === 'number' ? offset : offset(currentArea, rootArea);\n};\n\nexport const getCellBySelect = (select: AllParams<CellSelection>, currentArea: AreaInfo, rootArea: AreaInfo, constrFlag: boolean = false): CellInfo | null => {\n    let area: AreaInfo = currentArea;\n    if (select.referenceAreaLayer === 'current') {\n        area = currentArea;\n    } else if (select.referenceAreaLayer === 'root') {\n        area = rootArea;\n    } else if (select.referenceAreaLayer === 'parent') {\n        area = currentArea.parent!;\n    } else {\n        const layer = currentArea.areaLayer - select.referenceAreaLayer(currentArea);\n        for (let li = 0; li < layer; li++) {\n            area = area.parent!;\n        }\n    }\n\n    let cellPosi: CellPosi = {\n        x: area.x + calculateOffset(select.xOffset, currentArea, rootArea),\n        y: area.y + calculateOffset(select.yOffset, currentArea, rootArea)\n    };  // topLeft\n\n    if (select.referenceAreaPosi === 'bottomLeft') {\n        cellPosi.y += area.height - 1\n    }\n    else if (select.referenceAreaPosi === 'topRight') {\n        cellPosi.x += area.width - 1\n    }\n    else if (select.referenceAreaPosi === 'bottomRight') {\n        cellPosi.x += area.width - 1\n        cellPosi.y += area.height - 1\n    }\n\n    // 判断是否越界\n    if (cellPosi.x < 0 || cellPosi.y < 0 || cellPosi.x >= rootArea.width || cellPosi.y >= rootArea.height) {\n        const errorMessage = `Invalid cell selection:\\n Table size is (width: ${rootArea.width}, height: ${rootArea.height}), Position (${cellPosi.x}, ${cellPosi.y}) is out of bounds.`\n        if (constrFlag) {\n            // console.error(errorMessage); \n            return null;\n        }\n        else { throw new CustomError(errorMessage, 'OutOfBoundsError'); }\n    }\n    return {\n        ...cellPosi,\n        value: rootArea.areaTbl[cellPosi.y][cellPosi.x],\n    };\n\n};\n\nconst calculateSize = (size: number | 'toParentX' | 'toParentY' | null, startX: number, startY: number, currentArea: AreaInfo): number => {\n    if (typeof size === 'number') {\n        return size;\n    }\n    if (size === 'toParentX') {\n        return currentArea.width - startX;\n    }\n    if (size === 'toParentY') {\n        return currentArea.height - startY;\n    }\n    // 如果为 null，返回 1\n    return 1;\n};\n\nconst getSubArea = (table: Table2D, x: number, y: number, width: number, height: number): Table2D => {\n    const subArea: Table2D = [];\n    for (let i = y; i < y + height; i++) {\n        const row = table[i].slice(x, x + width);\n        subArea.push(row);\n    }\n    return subArea;\n}\n\n// 如果tidyData中的列长短不一样，则使用 template.fill 填充所有短的列，使每一列都有相同的长度\nconst fillColumns = (tidyData: { [key: string]: CellInfo[] }, fill: CellValueType | null) => {\n    if (fill === null) return;\n    // 获取所有列的最大长度\n    const maxLength = Math.max(...Object.values(tidyData).map(column => column.length));\n    // 对每一列进行填充处理\n    for (const key in tidyData) {\n        const column = tidyData[key];\n        const fillValue = fill === TableTidierKeyWords.Forward ? column[column.length - 1] : {\n            x: -1,\n            y: -1,\n            value: fill\n        } as CellInfo;\n\n        // 如果列长度小于最大长度，则进行填充\n        while (column.length < maxLength) {\n            column.push(fillValue);\n        }\n    }\n}\n\nconst traverseArea = (template: AllParams<TableTidierTemplate>, startX: number, startY: number, endX: number, endY: number, width: number, height: number, index: MatchedIndex, currentArea: AreaInfo, rootArea: AreaInfo, tidyData: { [key: string]: CellInfo[] }, traverseFlag: boolean = true) => {\n\n    let currentStartX = startX;\n    let currentEndX = startX + width - 1;\n    let currentStartY = startY;\n    let currentEndY = startY + height - 1;\n    let tmpArea: AreaInfo | null = null;\n\n    while (currentEndY <= endY) {\n        const areaHeight = currentEndY - currentStartY + 1;\n        while (currentEndX <= endX) {\n            const areaWidth = currentEndX - currentStartX + 1;\n            tmpArea = matchArea(template, currentStartX, currentStartY, areaWidth, areaHeight, index, currentArea, rootArea, tidyData);\n            // if (currentArea.templateRef.length === 0)\n            // console.log(\"after match\", [currentStartX, currentStartY, currentEndX, currentEndY], areaWidth, areaHeight, tmpArea != null);\n            if (tmpArea === null) {\n                // 如果没有找到，则移动到下一列\n                if (template.match.size.width != null) {\n                    // 宽度固定\n                    currentStartX += 1;\n                    currentEndX += 1\n                } else if (currentEndX === endX) {\n                    // 宽度可变且已经到了最后一列\n                    currentStartX += 1\n                    currentEndX = currentStartX\n                } else {\n                    // 宽度可变没有到最后一列\n                    currentEndX += 1\n                }\n            } else {\n                index.instanceIndex += 1;\n                if (!traverseFlag) return;\n                if (template.match.traverse.xDirection === null) break;\n                index.xIndex += 1;\n                currentStartX += areaWidth\n                currentEndX = currentStartX + width - 1;\n            }\n        }\n        index.xIndex = 0;\n        // 换行，列从 0 开始\n        if (tmpArea === null) {\n            // 如果没有找到，则移动到下一行\n            if (template.match.size.height != null) {\n                currentStartY += 1\n                currentEndY += 1\n            } else if (currentEndY === endY) {\n                // 高度可变且已经到了最后一行\n                currentStartY += 1\n                currentEndY = currentStartY\n            } else {\n                currentEndY += 1\n            }\n        } else {\n            if (!traverseFlag) return;\n            if (template.match.traverse.yDirection === null) break;\n            index.yIndex += 1;\n            currentStartY += areaHeight\n            currentEndY = currentStartY + height - 1;\n        }\n        currentStartX = startX;\n        currentEndX = startX + width - 1;\n    }\n    // console.log(\"match over\");\n}\n\n\nconst matchArea = (template: AllParams<TableTidierTemplate>, xOffset: number, yOffset: number, width: number, height: number, index: MatchedIndex, currentArea: AreaInfo, rootArea: AreaInfo, tidyData: { [key: string]: CellInfo[] }): AreaInfo | null => {\n\n    let x = currentArea.x + xOffset, y = currentArea.y + yOffset;\n\n    if (template.match.startCell.referenceAreaLayer !== \"current\") {\n        const cellInfo = getCellBySelect(template.match.startCell, currentArea, rootArea);\n        if (cellInfo === null) {\n            return null;\n        };\n        x = cellInfo.x;\n        y = cellInfo.y;\n    }\n\n    const tmpArea: AreaInfo = {\n        parent: currentArea,\n        areaLayer: currentArea.areaLayer + 1,\n        templateRef: index.templateRef.slice(),  // copy\n        instanceIndex: index.instanceIndex,\n        xIndex: index.xIndex,\n        yIndex: index.yIndex,\n        xOffset,\n        yOffset,\n        x,\n        y,\n        width,\n        height,\n        areaTbl: getSubArea(rootArea.areaTbl, x, y, width, height),\n        children: []\n    }\n    for (let cstr of template.match.constraints) {\n        try {  // constraint 里的数组超界不会报错，而是根据 ignoreOutOfBounds 来判断\n            const cellInfo = getCellBySelect(cstr, tmpArea, rootArea);\n            if (cellInfo === null) {\n                return null;\n            }\n            if (!evaluateConstraint(cellInfo.value, cstr)) return null;\n        } catch (e) {\n            if (cstr.ignoreOutOfBounds) continue;\n            return null;\n        }\n    }\n    currentArea.children.push(tmpArea);\n\n    transformArea(template, tmpArea, rootArea, tidyData);\n    return tmpArea;\n};\n\n\nconst transformArea = (template: AllParams<TableTidierTemplate>, currentArea: AreaInfo, rootArea: AreaInfo, tidyData: { [key: string]: CellInfo[] }) => {\n\n    const cellArray = currentArea.areaTbl.flat();\n    if (template.extract) {\n        let transformedCols: (CellValueType | null)[];\n        if (template.extract.byPositionToTargetCols !== undefined) {\n            transformedCols = template.extract.byPositionToTargetCols\n        } else if (template.extract.byContext !== undefined) {\n            const context = template.extract.byContext; // as AllParams<ContextTransform>;\n            const ctxCols: (CellValueType | null)[] = []\n            const ctxCellsInfo: CellInfo[][] = [];\n\n            const ctxSelections: CellSelection[][] = [];\n            if (context.position === 'above') {\n                currentArea.areaTbl.forEach((row, ri) => {\n                    row.forEach((cell, ci) => {\n                        ctxSelections.push([completeCellSelection({\n                            xOffset: ci,\n                            yOffset: ri - 1,\n                        })]);\n                    })\n                })\n            } else if (context.position === 'below') {\n                currentArea.areaTbl.forEach((row, ri) => {\n                    row.forEach((cell, ci) => {\n                        ctxSelections.push([completeCellSelection({\n                            xOffset: ci,\n                            yOffset: ri + 1,\n                        })]);\n                    })\n                })\n            } else if (context.position === 'left') {\n                currentArea.areaTbl.forEach((row, ri) => {\n                    row.forEach((cell, ci) => {\n                        ctxSelections.push([completeCellSelection({\n                            xOffset: ci - 1,\n                            yOffset: ri,\n                        })]);\n                    })\n                })\n            } else if (context.position === 'right') {\n                currentArea.areaTbl.forEach((row, ri) => {\n                    row.forEach((cell, ci) => {\n                        ctxSelections.push([completeCellSelection({\n                            xOffset: ci + 1,\n                            yOffset: ri,\n                        })]);\n                    })\n                })\n            } else {\n                const ctxPosiFn = context.position!;\n                currentArea.areaTbl.forEach((row, ri) => {\n                    row.forEach((cell, ci) => {\n                        const customSelections = ctxPosiFn({\n                            xOffset: ci,\n                            yOffset: ri,\n                            value: cell\n                        }, currentArea, rootArea);\n                        const customSelectionsWithDefaults = customSelections.map(selection => completeCellSelection(selection));\n                        ctxSelections.push(customSelectionsWithDefaults);\n                    })\n                })\n            }\n\n            if (ctxSelections.length > 0 && ctxSelections[0].length > 0) {\n                ctxSelections.forEach((cellCtxs) => {\n                    const cellCtxsInfo: CellInfo[] = [];\n                    cellCtxs.forEach((selection) => {\n                        const cell = getCellBySelect(selection as AllParams<CellSelection>, currentArea, rootArea);\n                        if (cell === null) {\n                            return null;\n                        }\n                        cellCtxsInfo.push(cell);\n                    })\n                    ctxCellsInfo.push(cellCtxsInfo);\n                });\n            } else {\n                console.log('No context cells found');\n            }\n\n            const customMapColbyCxt = context.toTargetCol!\n            ctxCellsInfo.forEach(ctxCells => {\n                ctxCols.push(customMapColbyCxt(ctxCells));\n            })\n\n            /*\n        if (context.toTargetCol === null) {\n            ctxCellsInfo.forEach((cellCtxsInfo) => {\n                // ctxCols.push(cellCtxsInfo[0].value === undefined ? null : cellCtxsInfo[0].value.toString());\n                ctxCols.push(cellCtxsInfo[0].value);\n            })\n        } else {\n            const customMapColbyCxt = context.toTargetCol\n            ctxCellsInfo.forEach((ctxCells) => {\n                ctxCols.push(customMapColbyCxt(ctxCells));\n            })\n        }*/\n            transformedCols = ctxCols\n        } else if (template.extract.byValue !== undefined) {\n            transformedCols = template.extract.byValue(currentArea.areaTbl);\n        } else {\n            throw new CustomError(`Please specify 'byPositionToTargetCols', 'byContext', or 'byValue' for extraction`, 'NoExtractionSpecified');\n        }\n        transformedCols.forEach((targetCol, index) => {\n            if (targetCol !== null && targetCol !== undefined && targetCol !== '') {\n                const cellInfo: CellInfo = {\n                    x: currentArea.x + index % currentArea.width,\n                    y: currentArea.y + Math.floor(index / currentArea.width),\n                    value: cellArray[index],\n                };\n                if (tidyData.hasOwnProperty(targetCol)) {\n                    tidyData[targetCol].push(cellInfo);\n                } else {\n                    tidyData[targetCol] = [cellInfo];\n                }\n            }\n        })\n    }\n    /*\n    console.log(JSON.stringify(tidyData, (key, value) => {\n        if (key === 'x' || key === 'y') {\n            return undefined;\n        }\n        return value\n    }, 2));\n    console.log(\"-----------------\");*/\n}\n\n\n// Recursive function to process a template\nconst processTemplate = (template: AllParams<TableTidierTemplate>, currentArea: AreaInfo, rootArea: AreaInfo, tidyData: { [key: string]: CellInfo[] }, templateIndex: number = 0, traverseFlag: boolean = true) => {\n\n    const index: MatchedIndex = {\n        templateRef: [...currentArea.templateRef, templateIndex],\n        instanceIndex: 0,\n        xIndex: 0,\n        yIndex: 0\n    };\n\n    const xDirection = template.match.traverse.xDirection;\n    const yDirection = template.match.traverse.yDirection;\n\n\n    const startCell = getCellBySelect(template.match.startCell, currentArea, rootArea);\n    if (startCell === null) {\n        return null;\n    };\n\n    const xOffset = startCell.x - currentArea.x;\n    const yOffset = startCell.y - currentArea.y;\n\n    // Calculate size\n    const width = calculateSize(template.match.size.width, xOffset, yOffset, currentArea);\n    const height = calculateSize(template.match.size.height, xOffset, yOffset, currentArea);\n\n    let startX, startY, endX, endY;\n\n    if (xDirection === null || !traverseFlag) {\n        startX = xOffset;\n        if (template.match.size.width === null) endX = currentArea.width - 1;\n        else endX = startX + width - 1;\n    } else if (xDirection === 'before') {\n        startX = 0;\n        endX = xOffset;\n    } else if (xDirection === 'after') {\n        startX = xOffset;\n        endX = currentArea.width - 1;\n    } else {  //  if (xDirection === 'whole')\n        startX = 0;\n        endX = currentArea.width - 1;\n    }\n\n    if (yDirection === null || !traverseFlag) {\n        startY = yOffset;\n        if (template.match.size.height === null) endY = currentArea.height - 1;\n        else endY = startY + height - 1;\n    } else if (yDirection === 'before') {\n        startY = 0;\n        endY = yOffset;\n    } else if (yDirection === 'after') {\n        startY = yOffset;\n        endY = currentArea.height - 1;\n    } else {  // if (yDirection === 'whole')\n        startY = 0;\n        endY = currentArea.height - 1;\n    }\n\n    // console.log(startX, startY, endX, endY, width, height);\n\n    traverseArea(template, startX, startY, endX, endY, width, height, index, currentArea, rootArea, tidyData, traverseFlag);\n\n    const matchTemplateArea = currentArea.children.filter((area) => area.templateRef.toString() === index.templateRef.toString());\n\n    if (template.children.length > 0 && matchTemplateArea.length > 0) {\n        matchTemplateArea.forEach((areaChild) => {\n            template.children.forEach((templateChild, ti) => {\n                processTemplate(templateChild, areaChild, rootArea, tidyData, ti, traverseFlag);\n            });\n            if (template.fill === TableTidierKeyWords.Auto) {\n                if (index.templateRef.length > 1) {\n                    fillColumns(tidyData, null);\n                } else {\n                    fillColumns(tidyData, \"\");\n                }\n            } else {\n                fillColumns(tidyData, template.fill);\n            }\n        })\n\n        /*\n        if (template.extract === null) {\n            // 父区域没有 transform\n            matchTemplateArea.forEach((areaChild, ai) => {\n                template.children.forEach((templateChild, ti) => {\n                    processTemplate(templateChild, areaChild, rootArea, tidyData, ti, traverseFlag);\n                    console.log(\"templateChild\", ti);\n                });\n                console.log(template.children.length, \"areaChild\", ai, \"fillColumns:\", areaChild.x, areaChild.y, areaChild.width, areaChild.height);\n                // fillColumns(tidyData, template.fill);\n                // if (template.fill === null && template.children.length > 1) {\n                // if (template.fill === undefined && template.children.length > 1) {\n                //     fillColumns(tidyData, \"\");\n                // } else {\n                //     fillColumns(tidyData, template.fill);\n                // }\n            })\n        } else {\n            // 父区域有 transform\n            template.children.forEach((templateChild, ti) => {\n                matchTemplateArea.forEach((areaChild) => {\n                    processTemplate(templateChild, areaChild, rootArea, tidyData, ti, traverseFlag);\n                });\n                fillColumns(tidyData, template.fill);\n                // if (template.fill === null) {\n                // if (template.fill === undefined) {\n                //     fillColumns(tidyData, \"\");\n                // } else {\n                //     fillColumns(tidyData, template.fill);\n                // }\n            })\n        }\n        */\n    }\n\n\n}\n\nexport function transformTable(table: Table2D, specs: TableTidierTemplate[], traverseFlag: boolean = true) {\n\n    // const specWithDefaults = completeSpecification(spec);\n    // console.log(JSON.stringify(specWithDefaults, null, 2));\n\n    // Create initial AreaInfo for the root\n    const rootArea: AreaInfo = {\n        parent: null,\n        areaLayer: 0,\n        templateRef: [],\n        instanceIndex: 0,\n        xIndex: 0,\n        yIndex: 0,\n        xOffset: 0,\n        yOffset: 0,\n        x: 0,\n        y: 0,\n        width: table.length > 0 ? table[0].length : 0,\n        height: table.length,\n        areaTbl: table,\n        children: []\n    };\n\n    const tidyData: { [key: string]: CellInfo[] } = {}\n\n    specs.forEach((template, ti) => {\n        const specWithDefaults = completeSpecification(template);\n        processTemplate(specWithDefaults, rootArea, rootArea, tidyData, ti, traverseFlag);\n        // fillColumns(tidyData, specWithDefaults.fill);\n        // if (specWithDefaults.fill === undefined && specWithDefaults.children.length > 1) {\n        //     fillColumns(tidyData, \"\");\n        // } else {\n        //     fillColumns(tidyData, specWithDefaults.fill);\n        // }\n    });\n\n    return { rootArea, tidyData };\n}","import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, createStaticVNode as _createStaticVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"wrapper\" }\nconst _hoisted_2 = /*#__PURE__*/_createStaticVNode(\"<div class=\\\"filing-container\\\" style=\\\"display:none;\\\"><span class=\\\"item\\\" id=\\\"busuanzi_container_site_pv\\\"> 本站总访问量<span id=\\\"busuanzi_value_site_pv\\\"></span>次 </span><span class=\\\"item\\\" id=\\\"busuanzi_container_site_uv\\\"> 本站访客数<span id=\\\"busuanzi_value_site_uv\\\"></span>人 </span><span class=\\\"item\\\" id=\\\"busuanzi_container_page_pv\\\"> 本文总阅读量<span id=\\\"busuanzi_value_page_pv\\\"></span>次 </span></div>\", 1)\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_panel_view = _resolveComponent(\"panel-view\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _createVNode(_component_panel_view)\n    ]),\n    _hoisted_2\n  ], 64))\n}","<template>\n  <div class=\"wrapper\">\n    <panel-view />\n  </div>\n  <div class=\"filing-container\" style=\"display: none;\">\n    <span class=\"item\" id=\"busuanzi_container_site_pv\">\n      本站总访问量<span id=\"busuanzi_value_site_pv\"></span>次\n    </span>\n    <span class=\"item\" id=\"busuanzi_container_site_uv\">\n      本站访客数<span id=\"busuanzi_value_site_uv\"></span>人\n    </span>\n    <span class=\"item\" id=\"busuanzi_container_page_pv\">\n      本文总阅读量<span id=\"busuanzi_value_page_pv\"></span>次\n    </span>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport PanelView from \"./views/PanelView.vue\";\n\nexport default defineComponent({\n  name: \"overView\",\n  components: {\n    PanelView,\n  },\n});\n</script>\n\n<style lang=\"less\">\n* {\n  margin: 0;\n  padding: 0;\n}\n\n.wrapper {\n  display: flex;\n  flex-flow: column;\n  background-color: #fffffe;\n  height: 100vh;\n  width: 100vw;\n  overflow-x: hidden;\n  overflow-y: hidden;\n}\n</style>\n","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, unref as _unref, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"view\" }\nconst _hoisted_2 = { class: \"view-title\" }\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"span\", { class: \"head-text\" }, \"Input Table\", -1)\nconst _hoisted_4 = { style: {\"float\":\"right\",\"margin-right\":\"20px\"} }\nconst _hoisted_5 = { class: \"controller\" }\nconst _hoisted_6 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Upload\", -1)\nconst _hoisted_7 = { class: \"view-content\" }\nconst _hoisted_8 = { id: \"input-tbl\" }\nconst _hoisted_9 = { class: \"view\" }\nconst _hoisted_10 = { class: \"view-title\" }\nconst _hoisted_11 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Output Table\", -1)\nconst _hoisted_12 = { style: {\"float\":\"right\",\"margin-right\":\"20px\"} }\nconst _hoisted_13 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Download\", -1)\nconst _hoisted_14 = { class: \"view-content\" }\nconst _hoisted_15 = { id: \"output-tbl\" }\n\nimport {\n  getCurrentInstance,\n  ComponentPublicInstance,\n  ref,\n  onMounted,\n  watch,\n} from \"vue\";\nimport { HotTable } from \"@handsontable/vue3\";\nimport \"handsontable/dist/handsontable.full.css\";\nimport { registerAllModules } from \"handsontable/registry\";\nimport Handsontable from \"handsontable\";\nimport { useTableStore, Selection } from \"@/store/table\";\n// import Papa from 'papaparse';  // parse csv data\nimport * as XLSX from 'xlsx';  // parse excel data\nimport { Table2D, TableTidierTemplate } from \"@/grammar/grammar\"\nimport { message } from \"ant-design-vue\";\n\n// import { ArrowUpTrayIcon } from '@heroicons/vue/24/solid'\n\n// register Handsontable's modules\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'InOutTable',\n  setup(__props) {\n\nregisterAllModules();\n\nconst tableStore = useTableStore();\n// const tblCases: { [key: string]: TblVisData } = tableStore.cases;\n\nconst output_col = ref(tableStore.output_tbl.cols);\nconst output_tbl = ref(tableStore.output_tbl.tbl);\nconst input_tbl = ref(tableStore.input_tbl.tbl);\n\nlet inHotInst: Handsontable;\nlet outHotInst: Handsontable;\n\nfunction renderTblCell(instance: Handsontable,\n  td: HTMLElement,\n  row: number,\n  col: number,\n  prop: any,\n  value: any,\n  cellProperties: any) {\n  // @ts-ignore\n  Handsontable.renderers.TextRenderer.apply(this, arguments);\n  td.innerHTML = `<div class=\"truncated\">${value}</div>`\n}\n\n// const handleUploadChange = (info: any) => {\n//   if (info.file.status === 'done') {\n//     message.success(`${info.file.name} file uploaded successfully`);\n//   } else if (info.file.status === 'error') {\n//     message.error(`${info.file.name} file upload failed.`);\n//   }\n// };\n\nconst fileList = ref([]);\n// const fileList = ref<UploadProps['fileList']>([{\n//     uid: '1',\n//     name: 'xxx.png',\n//     status: 'done',\n//     response: 'Server Error 500', // custom error message to show\n//     url: 'http://www.baidu.com/xxx.png',\n//   },]);\nlet fileTblData: Table2D = [];\n\nconst handleUpload = (request: any) => {\n  // console.log(request.file);\n  // setTimeout(() => {\n  //   request.onSuccess(\"ok\");\n  // }, 0);\n  try {\n    const reader = new FileReader();\n    // if (request.file.type === 'text/csv' || request.file.type === 'text/plain') {\n    //   reader.onload = (e) => {\n    //     console.log(e);\n    //     const data = e.target?.result;\n    //     parseCsvData(data as string);\n    //   }\n    //   reader.readAsText(request.file);\n    // } else if (request.file.type.endsWith('sheet') || request.file.type.endsWith('excel')) {\n\n    reader.onload = (e) => {\n      const arrayBuffer = e.target?.result;\n      const workbook = XLSX.read(arrayBuffer, { type: 'array' });\n      const firstSheetName = workbook.SheetNames[0];\n      const worksheet = workbook.Sheets[firstSheetName];\n      const rawData: Table2D = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\n      // Determine the maximum number of columns\n      const maxColumns = Math.max(...rawData.map(row => row.length));\n\n      // Ensure all rows have the same number of columns\n      fileTblData = rawData.map(row => {\n        while (row.length < maxColumns) {\n          row.push(undefined); // Fill missing cells with an empty string or a placeholder\n        }\n        return row;\n      });\n      handlePreview()\n      request.onSuccess(\"ok\");\n      // message.success(`${request.file.name} file uploaded successfully`);\n    };\n    reader.readAsArrayBuffer(request.file);\n  } catch (error) {\n    message.error(`${request.file.name} file uploaded failed.\\n${error}`);\n  }\n};\n\nlet saveLastCase = \"\"\n\nconst handleRemove = () => {\n  tableStore.initTblInfo()\n  tableStore.transformTblUpdateRootArea();\n  tableStore.currentCase = saveLastCase ? saveLastCase : tableStore.caseList[0];\n  saveLastCase = \"\"\n  tableStore.caseList.pop();\n};\n\nconst handlePreview = () => {\n  // executed when file link or preview icon is clicked.\n  tableStore.initTblInfo()\n  tableStore.input_tbl.tbl = fileTblData;\n  tableStore.input_tbl.instance.updateData(fileTblData);\n  tableStore.input_tbl.instance.render();\n  tableStore.transformTblUpdateRootArea();\n  if (!tableStore.currentCase.startsWith(\"Custom\")) {\n    saveLastCase = tableStore.currentCase\n  }\n  if (!tableStore.caseList.includes(\"Custom File\")) {\n    tableStore.caseList.push(\"Custom File\");\n  }\n  tableStore.currentCase = \"Custom File\";\n};\n\nwatch(() => tableStore.currentCase, (newVal) => {\n  if (newVal.startsWith(\"Custom\")) handlePreview();\n  else tableStore.loadCaseData(newVal);\n});\n\n\n// 函数用于将二维数组转换为 CSV 格式\nfunction arrayToCSV(array: Table2D) {\n  return array.map(row => row.map(cell => `${cell === undefined ? '' : cell}`).join(',')).join('\\n');\n}\n\nconst handleDownload = () => {\n  if (tableStore.output_tbl.cols.length === 0) {\n    message.warning('The output table is empty.');\n    return;\n  }\n  const csv = arrayToCSV([tableStore.output_tbl.cols, ...tableStore.output_tbl.tbl]);\n  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = 'tidy table.csv'; // 下载文件的名称\n  document.body.appendChild(a);\n  a.click();\n  document.body.removeChild(a);\n  URL.revokeObjectURL(url); // 释放内存\n\n  message.success('The output table has been downloaded successfully.');\n};\n\nfunction normalizeSelection(selections: Selection[]): Selection[] {\n  return selections.map(([row1, col1, row2, col2]) => {\n    // 修正负数坐标为0\n    if (row1 < 0) row1 = 0;\n    if (col1 < 0) col1 = 0;\n    if (row2 < 0) row2 = 0;\n    if (col2 < 0) col2 = 0;\n\n    // 确保startRow <= endRow 和 startCol <= endCol\n    const startRow = Math.min(row1, row2);\n    const endRow = Math.max(row1, row2);\n    const startCol = Math.min(col1, col2);\n    const endCol = Math.max(col1, col2);\n\n    return [startRow, startCol, endRow, endCol];\n  });\n}\n\nfunction initEventsForTbl(tbl: \"input_tbl\" | \"output_tbl\") {\n  let tblInst1: Handsontable, tblInst2: Handsontable;\n  const tbl2 = tbl === \"input_tbl\" ? \"output_tbl\" : \"input_tbl\";\n  if (tbl === \"input_tbl\") {\n    tblInst1 = inHotInst;\n    tblInst2 = outHotInst;\n  } else {\n    tblInst1 = outHotInst;\n    tblInst2 = inHotInst;\n  }\n  tblInst1.updateSettings({\n    outsideClickDeselects: (targetEle) => {\n      const targetClassName = targetEle?.className;\n      if (typeof targetClassName !== \"string\") {\n        tblInst2.updateSettings({ cell: [] });\n        return true;\n      }\n      if (tblInst1 === outHotInst && [\"relative\", \"rowHeader\", \"current\", \"truncated\"].some((c) => targetClassName.split(\" \").includes(c))) {\n        // 如果在 input 表格内点击：\n        if (document.body.style.cursor !== 'cell') {\n          tblInst2.updateSettings({ cell: [] });\n        }\n      } else {\n        tableStore.clearStatus(\"matchArea\");\n        tblInst2.updateSettings({ cell: [] });\n      }\n      tableStore.highlightMinimapCells([]);\n      tableStore.clearStatus(\"tree\");\n\n      if (tbl === \"input_tbl\") {\n        if (!(targetClassName.startsWith(\"mtk\") || targetClassName === \"view-line\"))\n          tableStore.editor.mappingSpec.decorations?.clear();\n      }\n\n      return true;\n    },\n  });\n  tblInst1.addHook(\"afterOnCellMouseDown\", () => {\n    tblInst2.updateSettings({ cell: [] });\n  });\n  tblInst1.addHook(\"afterOnCellMouseUp\", (event, coords, TD) => {\n    if (tableStore.specMode) return;\n    const selected = normalizeSelection(tblInst1.getSelected() || []);\n    // key 表示所选区域，value 表示所选区域所有单元格的坐标\n    const { selectedCoords, hightedCells } = tableStore.getHightlightedCells(selected);\n\n    // 打印所有坐标\n    // console.log(selectedCoords);\n\n    const cells = tableStore.in_out_mapping(selectedCoords, tbl);\n    tableStore.highlightTblCells(tbl2, cells);\n    // tableStore.highlightMinimapCells([{ ...coords, className: \"posi-mapping\" }]);\n\n    if (tbl === \"input_tbl\") {\n      tableStore.highlightMinimapCells(hightedCells);\n      // console.log(document.body.style.cursor, tableStore.spec.selectAreaFromNode, tableStore.spec.selectAreaFromLegend.length);\n      if (document.body.style.cursor === 'cell') {\n        if (tableStore.spec.selectAreaFromNode) {\n          // 说明需要重新为某个节点选择区域\n          const selectType = tableStore.spec.selectAreaFromNode;\n          const visNode = selectType === \"0\" ? tableStore.spec.selectNode.parent!.data : tableStore.spec.selectNode.data;\n          const nx = visNode.x, ny = visNode.y, nw = visNode.width, nh = visNode.height;\n          const [startRow, startCol, endRow, endCol] = selected[0];\n          const xOffset = startCol - nx, yOffset = startRow - ny;\n          let match: TableTidierTemplate[\"match\"] = {};\n          switch (selectType) {\n            case \"0\":\n            // Reset Area Logic\n            case \"3\":\n              // Add Sub-Template Logic\n              const width = endCol - startCol + 1;\n              const height = endRow - startRow + 1;\n              const traverse = {\n                xDirection: nw >= 2 * width ? 'after' as const : undefined,\n                yDirection: nh >= 2 * height ? 'after' as const : undefined\n              }\n              match = {\n                startCell: {\n                  // referenceAreaLayer: \"current\",\n                  // referenceAreaPosi: \"topLeft\",\n                  xOffset,\n                  yOffset\n                },\n                size: { width, height },\n                traverse\n              }\n              if (selectType === \"0\") {\n                tableStore.insertNodeOrPropertyIntoSpecs(match, \"match\");\n                const currentSpec = tableStore.getNodebyPath(tableStore.spec.rawSpecs, tableStore.spec.selectNode.data.path!) as TableTidierTemplate;\n                tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine(currentSpec.match, currentSpec), `${tableStore.spec.selectNode.data.type}Shallow`];\n              } else {\n                tableStore.insertNodeOrPropertyIntoSpecs(match, \"children\");\n                tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine({ match: match }), 'nullShallow'];\n              }\n              break;\n            case \"1\":\n              // Add Constraints Logic\n              const cellValue = inHotInst.getDataAtCell(startRow, startCol);\n              match = {\n                constraints: [{\n                  xOffset,\n                  yOffset,\n                  valueCstr: tableStore.getCellDataType(cellValue) // TableTidierKeyWords.String,\n                }]\n              }\n              const constraint = match.constraints![0]\n              tableStore.insertNodeOrPropertyIntoSpecs(constraint, \"constraints\");\n              tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine(constraint, tableStore.getNodebyPath(tableStore.spec.rawSpecs, visNode.path!)), `${visNode.type}Shallow`];\n              break;\n          }\n          tableStore.spec.selectAreaFromNode = \"\";\n          tableStore.clearStatus(\"matchArea\");\n          /*\n          const areaConfig = tableStore.spec.areaConfig;\n          areaConfig.match!.startCell = {\n            referenceAreaLayer: \"root\",\n            referenceAreaPosi: \"topLeft\",\n            xOffset: selected[0][1] < 0 ? 0 : selected[0][1],\n            yOffset: selected[0][0] < 0 ? 0 : selected[0][0]\n          }\n          areaConfig.match!.size = {\n            width: selected[0][3] - selected[0][1] + 1,\n            height: selected[0][2] - selected[0][0] + 1\n          }\n          areaConfig.match!.traverse = {\n            xDirection: \"after\",\n            yDirection: \"after\"\n          }\n          const areaFormData = tableStore.spec.areaFormData;\n          areaFormData.referenceAreaLayer = areaConfig.match!.startCell?.referenceAreaLayer;\n          areaFormData.referenceAreaPosi = areaConfig.match!.startCell?.referenceAreaPosi;\n          areaFormData.position = {\n            x: areaConfig.match!.startCell?.xOffset,\n            y: areaConfig.match!.startCell?.yOffset\n          }\n          areaFormData.traverse = {\n            xDirection: areaConfig.match!.traverse?.xDirection,\n            yDirection: areaConfig.match!.traverse?.yDirection\n          }\n          areaFormData.size = {\n            width: areaConfig.match!.size?.width,\n            height: areaConfig.match!.size?.height\n          }\n          tableStore.spec.dragConfigOpen = true;\n          */\n        } else if (tableStore.spec.selectAreaFromLegend.length) {\n          // 说明从legend处选择区域\n          inHotInst.updateSettings({ cell: [] });\n          const selectFromLegend = tableStore.spec.selectAreaFromLegend;\n          tableStore.spec.selectionsAreaFromLegend.push(selected[0]);\n          tableStore.spec.selectionsPath.push([]);\n          if (selectFromLegend.length < tableStore.spec.selectionsAreaFromLegend.length) {\n            selectFromLegend.push(selectFromLegend[selectFromLegend.length - 1])\n          }\n          const cells = tableStore.generateHighlightCells(tableStore.spec.selectionsAreaFromLegend, selectFromLegend);\n          tableStore.highlightTblCells(tbl, cells);\n          // document.body.style.cursor = 'default';\n          // document.documentElement.style.setProperty('--custom-cursor', 'default');\n\n          const { specs } = tableStore.buildTree(tableStore.spec.selectionsAreaFromLegend, selectFromLegend, tableStore.spec.selectionsPath);\n\n          tableStore.stringifySpec(specs);\n        }\n      }\n\n      tableStore.highlightNodes(selected);\n    } else {\n      tableStore.highlightMinimapCells(cells);\n    }\n  });\n}\n\nonMounted(() => {\n\n  const proxy = getCurrentInstance()?.proxy as ComponentPublicInstance;\n  inHotInst = (proxy.$refs.inputTbl as any).hotInstance as Handsontable;\n  outHotInst = (proxy.$refs.outputTbl as any).hotInstance as Handsontable;\n\n  tableStore.input_tbl.instance = inHotInst;\n  tableStore.output_tbl.instance = outHotInst;\n\n  initEventsForTbl(\"input_tbl\");\n  initEventsForTbl(\"output_tbl\");\n});\n\n// function showDropdown() {\n//   //   isOpen = true;\n// }\n// function hideDropdown() {\n//   //   isOpen = false;\n// }\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_a_button = _resolveComponent(\"a-button\")!\n  const _component_a_upload = _resolveComponent(\"a-upload\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _createElementVNode(\"div\", _hoisted_2, [\n        _hoisted_3,\n        _createElementVNode(\"span\", _hoisted_4, [\n          _createElementVNode(\"span\", _hoisted_5, [\n            _createVNode(_component_a_upload, {\n              \"file-list\": fileList.value,\n              \"onUpdate:fileList\": _cache[0] || (_cache[0] = ($event: any) => ((fileList).value = $event)),\n              \"max-count\": 1,\n              accept: \".csv, .txt, .xls, .xlsx\",\n              customRequest: handleUpload,\n              onRemove: handleRemove,\n              onPreview: handlePreview,\n              showUploadList: {\n              showRemoveIcon: true,\n            }\n            }, {\n              default: _withCtx(() => [\n                _createVNode(_component_a_button, { size: \"small\" }, {\n                  default: _withCtx(() => [\n                    _createVNode(_component_v_icon, {\n                      name: \"bi-upload\",\n                      scale: \"0.85\"\n                    }),\n                    _hoisted_6\n                  ]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            }, 8, [\"file-list\"])\n          ])\n        ])\n      ]),\n      _createElementVNode(\"div\", _hoisted_7, [\n        _createElementVNode(\"div\", _hoisted_8, [\n          _createVNode(_unref(HotTable), {\n            ref: \"inputTbl\",\n            data: input_tbl.value,\n            rowHeaders: true,\n            colHeaders: true,\n            manualColumnResize: true,\n            autoWrapRow: true,\n            autoWrapCol: true,\n            contextMenu: true,\n            renderer: renderTblCell,\n            licenseKey: \"non-commercial-and-evaluation\"\n          }, null, 8, [\"data\"])\n        ])\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_9, [\n      _createElementVNode(\"div\", _hoisted_10, [\n        _hoisted_11,\n        _createElementVNode(\"span\", _hoisted_12, [\n          _createVNode(_component_a_button, {\n            size: \"small\",\n            onClick: handleDownload\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_v_icon, {\n                name: \"bi-download\",\n                scale: \"0.85\"\n              }),\n              _hoisted_13\n            ]),\n            _: 1\n          })\n        ])\n      ]),\n      _createElementVNode(\"div\", _hoisted_14, [\n        _createElementVNode(\"div\", _hoisted_15, [\n          _createVNode(_unref(HotTable), {\n            ref: \"outputTbl\",\n            data: output_tbl.value,\n            rowHeaders: true,\n            colHeaders: output_col.value,\n            manualColumnResize: true,\n            renderer: renderTblCell,\n            contextMenu: true,\n            autoWrapRow: true,\n            autoWrapCol: true,\n            licenseKey: \"non-commercial-and-evaluation\"\n          }, null, 8, [\"data\", \"colHeaders\"])\n        ])\n      ])\n    ])\n  ], 64))\n}\n}\n\n})","<template>\n  <div class=\"view\">\n    <div class=\"view-title\">\n      <span class=\"head-text\">Input Table</span>\n      <span style=\"float: right; margin-right: 20px\">\n        <span class=\"controller\">\n          <a-upload v-model:file-list=\"fileList\" :max-count=\"1\" accept=\".csv, .txt, .xls, .xlsx\"\n            :customRequest=\"handleUpload\" @remove=\"handleRemove\" @preview=\"handlePreview\" :showUploadList=\"{\n              showRemoveIcon: true,\n            }\">\n            <a-button size=\"small\">\n              <v-icon name=\"bi-upload\" scale=\"0.85\" />\n              <span>Upload</span>\n            </a-button>\n          </a-upload>\n        </span>\n      </span>\n    </div>\n    <div class=\"view-content\">\n      <div id=\"input-tbl\">\n        <hot-table ref=\"inputTbl\" :data=\"input_tbl\" :rowHeaders=\"true\" :colHeaders=\"true\" :manualColumnResize=\"true\"\n          :autoWrapRow=\"true\" :autoWrapCol=\"true\" :contextMenu=\"true\" :renderer=\"renderTblCell\"\n          licenseKey=\"non-commercial-and-evaluation\"></hot-table>\n      </div>\n    </div>\n  </div>\n  <div class=\"view\">\n    <div class=\"view-title\">\n      <span>Output Table</span>\n      <span style=\"float: right; margin-right: 20px\">\n        <a-button size=\"small\" @click=\"handleDownload\">\n          <v-icon name=\"bi-download\" scale=\"0.85\"></v-icon>\n          <span>Download</span>\n        </a-button>\n      </span>\n    </div>\n    <div class=\"view-content\">\n      <div id=\"output-tbl\">\n        <hot-table ref=\"outputTbl\" :data=\"output_tbl\" :rowHeaders=\"true\" :colHeaders=\"output_col\"\n          :manualColumnResize=\"true\" :renderer=\"renderTblCell\" :contextMenu=\"true\" :autoWrapRow=\"true\"\n          :autoWrapCol=\"true\" licenseKey=\"non-commercial-and-evaluation\"></hot-table>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  getCurrentInstance,\n  ComponentPublicInstance,\n  ref,\n  onMounted,\n  watch,\n} from \"vue\";\nimport { HotTable } from \"@handsontable/vue3\";\nimport \"handsontable/dist/handsontable.full.css\";\nimport { registerAllModules } from \"handsontable/registry\";\nimport Handsontable from \"handsontable\";\nimport { useTableStore, Selection } from \"@/store/table\";\n// import Papa from 'papaparse';  // parse csv data\nimport * as XLSX from 'xlsx';  // parse excel data\nimport { Table2D, TableTidierTemplate } from \"@/grammar/grammar\"\nimport { message } from \"ant-design-vue\";\n\n// import { ArrowUpTrayIcon } from '@heroicons/vue/24/solid'\n\n// register Handsontable's modules\nregisterAllModules();\n\nconst tableStore = useTableStore();\n// const tblCases: { [key: string]: TblVisData } = tableStore.cases;\n\nconst output_col = ref(tableStore.output_tbl.cols);\nconst output_tbl = ref(tableStore.output_tbl.tbl);\nconst input_tbl = ref(tableStore.input_tbl.tbl);\n\nlet inHotInst: Handsontable;\nlet outHotInst: Handsontable;\n\nfunction renderTblCell(instance: Handsontable,\n  td: HTMLElement,\n  row: number,\n  col: number,\n  prop: any,\n  value: any,\n  cellProperties: any) {\n  // @ts-ignore\n  Handsontable.renderers.TextRenderer.apply(this, arguments);\n  td.innerHTML = `<div class=\"truncated\">${value}</div>`\n}\n\n// const handleUploadChange = (info: any) => {\n//   if (info.file.status === 'done') {\n//     message.success(`${info.file.name} file uploaded successfully`);\n//   } else if (info.file.status === 'error') {\n//     message.error(`${info.file.name} file upload failed.`);\n//   }\n// };\n\nconst fileList = ref([]);\n// const fileList = ref<UploadProps['fileList']>([{\n//     uid: '1',\n//     name: 'xxx.png',\n//     status: 'done',\n//     response: 'Server Error 500', // custom error message to show\n//     url: 'http://www.baidu.com/xxx.png',\n//   },]);\nlet fileTblData: Table2D = [];\n\nconst handleUpload = (request: any) => {\n  // console.log(request.file);\n  // setTimeout(() => {\n  //   request.onSuccess(\"ok\");\n  // }, 0);\n  try {\n    const reader = new FileReader();\n    // if (request.file.type === 'text/csv' || request.file.type === 'text/plain') {\n    //   reader.onload = (e) => {\n    //     console.log(e);\n    //     const data = e.target?.result;\n    //     parseCsvData(data as string);\n    //   }\n    //   reader.readAsText(request.file);\n    // } else if (request.file.type.endsWith('sheet') || request.file.type.endsWith('excel')) {\n\n    reader.onload = (e) => {\n      const arrayBuffer = e.target?.result;\n      const workbook = XLSX.read(arrayBuffer, { type: 'array' });\n      const firstSheetName = workbook.SheetNames[0];\n      const worksheet = workbook.Sheets[firstSheetName];\n      const rawData: Table2D = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\n      // Determine the maximum number of columns\n      const maxColumns = Math.max(...rawData.map(row => row.length));\n\n      // Ensure all rows have the same number of columns\n      fileTblData = rawData.map(row => {\n        while (row.length < maxColumns) {\n          row.push(undefined); // Fill missing cells with an empty string or a placeholder\n        }\n        return row;\n      });\n      handlePreview()\n      request.onSuccess(\"ok\");\n      // message.success(`${request.file.name} file uploaded successfully`);\n    };\n    reader.readAsArrayBuffer(request.file);\n  } catch (error) {\n    message.error(`${request.file.name} file uploaded failed.\\n${error}`);\n  }\n};\n\nlet saveLastCase = \"\"\n\nconst handleRemove = () => {\n  tableStore.initTblInfo()\n  tableStore.transformTblUpdateRootArea();\n  tableStore.currentCase = saveLastCase ? saveLastCase : tableStore.caseList[0];\n  saveLastCase = \"\"\n  tableStore.caseList.pop();\n};\n\nconst handlePreview = () => {\n  // executed when file link or preview icon is clicked.\n  tableStore.initTblInfo()\n  tableStore.input_tbl.tbl = fileTblData;\n  tableStore.input_tbl.instance.updateData(fileTblData);\n  tableStore.input_tbl.instance.render();\n  tableStore.transformTblUpdateRootArea();\n  if (!tableStore.currentCase.startsWith(\"Custom\")) {\n    saveLastCase = tableStore.currentCase\n  }\n  if (!tableStore.caseList.includes(\"Custom File\")) {\n    tableStore.caseList.push(\"Custom File\");\n  }\n  tableStore.currentCase = \"Custom File\";\n};\n\nwatch(() => tableStore.currentCase, (newVal) => {\n  if (newVal.startsWith(\"Custom\")) handlePreview();\n  else tableStore.loadCaseData(newVal);\n});\n\n\n// 函数用于将二维数组转换为 CSV 格式\nfunction arrayToCSV(array: Table2D) {\n  return array.map(row => row.map(cell => `${cell === undefined ? '' : cell}`).join(',')).join('\\n');\n}\n\nconst handleDownload = () => {\n  if (tableStore.output_tbl.cols.length === 0) {\n    message.warning('The output table is empty.');\n    return;\n  }\n  const csv = arrayToCSV([tableStore.output_tbl.cols, ...tableStore.output_tbl.tbl]);\n  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = 'tidy table.csv'; // 下载文件的名称\n  document.body.appendChild(a);\n  a.click();\n  document.body.removeChild(a);\n  URL.revokeObjectURL(url); // 释放内存\n\n  message.success('The output table has been downloaded successfully.');\n};\n\nfunction normalizeSelection(selections: Selection[]): Selection[] {\n  return selections.map(([row1, col1, row2, col2]) => {\n    // 修正负数坐标为0\n    if (row1 < 0) row1 = 0;\n    if (col1 < 0) col1 = 0;\n    if (row2 < 0) row2 = 0;\n    if (col2 < 0) col2 = 0;\n\n    // 确保startRow <= endRow 和 startCol <= endCol\n    const startRow = Math.min(row1, row2);\n    const endRow = Math.max(row1, row2);\n    const startCol = Math.min(col1, col2);\n    const endCol = Math.max(col1, col2);\n\n    return [startRow, startCol, endRow, endCol];\n  });\n}\n\nfunction initEventsForTbl(tbl: \"input_tbl\" | \"output_tbl\") {\n  let tblInst1: Handsontable, tblInst2: Handsontable;\n  const tbl2 = tbl === \"input_tbl\" ? \"output_tbl\" : \"input_tbl\";\n  if (tbl === \"input_tbl\") {\n    tblInst1 = inHotInst;\n    tblInst2 = outHotInst;\n  } else {\n    tblInst1 = outHotInst;\n    tblInst2 = inHotInst;\n  }\n  tblInst1.updateSettings({\n    outsideClickDeselects: (targetEle) => {\n      const targetClassName = targetEle?.className;\n      if (typeof targetClassName !== \"string\") {\n        tblInst2.updateSettings({ cell: [] });\n        return true;\n      }\n      if (tblInst1 === outHotInst && [\"relative\", \"rowHeader\", \"current\", \"truncated\"].some((c) => targetClassName.split(\" \").includes(c))) {\n        // 如果在 input 表格内点击：\n        if (document.body.style.cursor !== 'cell') {\n          tblInst2.updateSettings({ cell: [] });\n        }\n      } else {\n        tableStore.clearStatus(\"matchArea\");\n        tblInst2.updateSettings({ cell: [] });\n      }\n      tableStore.highlightMinimapCells([]);\n      tableStore.clearStatus(\"tree\");\n\n      if (tbl === \"input_tbl\") {\n        if (!(targetClassName.startsWith(\"mtk\") || targetClassName === \"view-line\"))\n          tableStore.editor.mappingSpec.decorations?.clear();\n      }\n\n      return true;\n    },\n  });\n  tblInst1.addHook(\"afterOnCellMouseDown\", () => {\n    tblInst2.updateSettings({ cell: [] });\n  });\n  tblInst1.addHook(\"afterOnCellMouseUp\", (event, coords, TD) => {\n    if (tableStore.specMode) return;\n    const selected = normalizeSelection(tblInst1.getSelected() || []);\n    // key 表示所选区域，value 表示所选区域所有单元格的坐标\n    const { selectedCoords, hightedCells } = tableStore.getHightlightedCells(selected);\n\n    // 打印所有坐标\n    // console.log(selectedCoords);\n\n    const cells = tableStore.in_out_mapping(selectedCoords, tbl);\n    tableStore.highlightTblCells(tbl2, cells);\n    // tableStore.highlightMinimapCells([{ ...coords, className: \"posi-mapping\" }]);\n\n    if (tbl === \"input_tbl\") {\n      tableStore.highlightMinimapCells(hightedCells);\n      // console.log(document.body.style.cursor, tableStore.spec.selectAreaFromNode, tableStore.spec.selectAreaFromLegend.length);\n      if (document.body.style.cursor === 'cell') {\n        if (tableStore.spec.selectAreaFromNode) {\n          // 说明需要重新为某个节点选择区域\n          const selectType = tableStore.spec.selectAreaFromNode;\n          const visNode = selectType === \"0\" ? tableStore.spec.selectNode.parent!.data : tableStore.spec.selectNode.data;\n          const nx = visNode.x, ny = visNode.y, nw = visNode.width, nh = visNode.height;\n          const [startRow, startCol, endRow, endCol] = selected[0];\n          const xOffset = startCol - nx, yOffset = startRow - ny;\n          let match: TableTidierTemplate[\"match\"] = {};\n          switch (selectType) {\n            case \"0\":\n            // Reset Area Logic\n            case \"3\":\n              // Add Sub-Template Logic\n              const width = endCol - startCol + 1;\n              const height = endRow - startRow + 1;\n              const traverse = {\n                xDirection: nw >= 2 * width ? 'after' as const : undefined,\n                yDirection: nh >= 2 * height ? 'after' as const : undefined\n              }\n              match = {\n                startCell: {\n                  // referenceAreaLayer: \"current\",\n                  // referenceAreaPosi: \"topLeft\",\n                  xOffset,\n                  yOffset\n                },\n                size: { width, height },\n                traverse\n              }\n              if (selectType === \"0\") {\n                tableStore.insertNodeOrPropertyIntoSpecs(match, \"match\");\n                const currentSpec = tableStore.getNodebyPath(tableStore.spec.rawSpecs, tableStore.spec.selectNode.data.path!) as TableTidierTemplate;\n                tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine(currentSpec.match, currentSpec), `${tableStore.spec.selectNode.data.type}Shallow`];\n              } else {\n                tableStore.insertNodeOrPropertyIntoSpecs(match, \"children\");\n                tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine({ match: match }), 'nullShallow'];\n              }\n              break;\n            case \"1\":\n              // Add Constraints Logic\n              const cellValue = inHotInst.getDataAtCell(startRow, startCol);\n              match = {\n                constraints: [{\n                  xOffset,\n                  yOffset,\n                  valueCstr: tableStore.getCellDataType(cellValue) // TableTidierKeyWords.String,\n                }]\n              }\n              const constraint = match.constraints![0]\n              tableStore.insertNodeOrPropertyIntoSpecs(constraint, \"constraints\");\n              tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine(constraint, tableStore.getNodebyPath(tableStore.spec.rawSpecs, visNode.path!)), `${visNode.type}Shallow`];\n              break;\n          }\n          tableStore.spec.selectAreaFromNode = \"\";\n          tableStore.clearStatus(\"matchArea\");\n          /*\n          const areaConfig = tableStore.spec.areaConfig;\n          areaConfig.match!.startCell = {\n            referenceAreaLayer: \"root\",\n            referenceAreaPosi: \"topLeft\",\n            xOffset: selected[0][1] < 0 ? 0 : selected[0][1],\n            yOffset: selected[0][0] < 0 ? 0 : selected[0][0]\n          }\n          areaConfig.match!.size = {\n            width: selected[0][3] - selected[0][1] + 1,\n            height: selected[0][2] - selected[0][0] + 1\n          }\n          areaConfig.match!.traverse = {\n            xDirection: \"after\",\n            yDirection: \"after\"\n          }\n          const areaFormData = tableStore.spec.areaFormData;\n          areaFormData.referenceAreaLayer = areaConfig.match!.startCell?.referenceAreaLayer;\n          areaFormData.referenceAreaPosi = areaConfig.match!.startCell?.referenceAreaPosi;\n          areaFormData.position = {\n            x: areaConfig.match!.startCell?.xOffset,\n            y: areaConfig.match!.startCell?.yOffset\n          }\n          areaFormData.traverse = {\n            xDirection: areaConfig.match!.traverse?.xDirection,\n            yDirection: areaConfig.match!.traverse?.yDirection\n          }\n          areaFormData.size = {\n            width: areaConfig.match!.size?.width,\n            height: areaConfig.match!.size?.height\n          }\n          tableStore.spec.dragConfigOpen = true;\n          */\n        } else if (tableStore.spec.selectAreaFromLegend.length) {\n          // 说明从legend处选择区域\n          inHotInst.updateSettings({ cell: [] });\n          const selectFromLegend = tableStore.spec.selectAreaFromLegend;\n          tableStore.spec.selectionsAreaFromLegend.push(selected[0]);\n          tableStore.spec.selectionsPath.push([]);\n          if (selectFromLegend.length < tableStore.spec.selectionsAreaFromLegend.length) {\n            selectFromLegend.push(selectFromLegend[selectFromLegend.length - 1])\n          }\n          const cells = tableStore.generateHighlightCells(tableStore.spec.selectionsAreaFromLegend, selectFromLegend);\n          tableStore.highlightTblCells(tbl, cells);\n          // document.body.style.cursor = 'default';\n          // document.documentElement.style.setProperty('--custom-cursor', 'default');\n\n          const { specs } = tableStore.buildTree(tableStore.spec.selectionsAreaFromLegend, selectFromLegend, tableStore.spec.selectionsPath);\n\n          tableStore.stringifySpec(specs);\n        }\n      }\n\n      tableStore.highlightNodes(selected);\n    } else {\n      tableStore.highlightMinimapCells(cells);\n    }\n  });\n}\n\nonMounted(() => {\n\n  const proxy = getCurrentInstance()?.proxy as ComponentPublicInstance;\n  inHotInst = (proxy.$refs.inputTbl as any).hotInstance as Handsontable;\n  outHotInst = (proxy.$refs.outputTbl as any).hotInstance as Handsontable;\n\n  tableStore.input_tbl.instance = inHotInst;\n  tableStore.output_tbl.instance = outHotInst;\n\n  initEventsForTbl(\"input_tbl\");\n  initEventsForTbl(\"output_tbl\");\n});\n\n// function showDropdown() {\n//   //   isOpen = true;\n// }\n// function hideDropdown() {\n//   //   isOpen = false;\n// }\n</script>\n\n<style lang=\"less\">\n.ant-upload-wrapper {\n  position: relative;\n\n  .ant-upload {\n    display: inline-block;\n    // margin-right: 60px;\n  }\n\n  .ant-upload-list {\n    position: absolute;\n    top: -11px;\n    right: 81px;\n    cursor: pointer;\n  }\n\n  .ant-upload-list-item-name {\n    color: #1677ff;\n    padding: 0 0 0 2px !important;\n    max-width: 150px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n}\n\n.handsontable {\n  .truncated {\n    max-width: 140px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n\n  div.relative,\n  td {\n    cursor: var(--custom-cursor) !important;\n  }\n\n  td.htRight {\n    background-color: #3498db;\n  }\n\n  td.position {\n    color: #fff !important;\n    background-color: var(--color-position);\n  }\n\n  td.positionShallow {\n    color: #fff !important;\n    background-color: var(--color-positionShallow);\n  }\n\n  td.context {\n    color: #fff !important;\n    background-color: var(--color-context);\n  }\n\n  td.contextShallow {\n    color: #fff !important;\n    background-color: var(--color-contextShallow);\n  }\n\n  td.value {\n    color: #fff !important;\n    background-color: var(--color-value);\n  }\n\n  td.valueShallow {\n    color: #fff !important;\n    background-color: var(--color-valueShallow);\n  }\n\n  td.null {\n    color: #fff !important;\n    background-color: var(--color-null);\n  }\n\n  td.nullShallow {\n    color: #fff !important;\n    background-color: var(--color-nullShallow);\n  }\n\n  td.selection {\n    color: #fff !important;\n    background-color: var(--color-selection);\n  }\n\n  td.selectionShallow {\n    color: #fff !important;\n    background-color: var(--color-selectionShallow);\n  }\n}\n</style>\n","import script from \"./InOutTable.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InOutTable.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InOutTable.vue?vue&type=style&index=0&id=3ae9985a&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nimport * as monaco from \"monaco-editor\";\nimport { onMounted, onUnmounted, ref, watch } from \"vue\";\nimport { useTableStore } from \"@/store/table\";\n\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'CodeView',\n  props: {\n    codeType: {}\n  },\n  setup(__props: any) {\n\nconst { codeType } = __props;  // | \"transformScript\"\n\nconst tableStore = useTableStore();\n\nconst editorDefaultOptions = {\n    value: '',\n    language: tableStore.editor[codeType].language,\n    theme: 'vs',\n    fontSize: 14,\n    glyphMargin: false,\n    automaticLayout: false, // Automatic layout may cause \"ResizeObserver loop completed with undelivered notifications.\" warning. To avoid this, set automaticLayout to false\n    autoIndent: 'advanced',\n    readOnly: false, // codeType === \"rootArea\" ? true : false,\n    minimap: {\n        enabled: codeType === \"rootArea\" ? true : false,\n    },\n    lineNumbersMinChars: 1,\n    scrollBeyondLastLine: false, // Prevent scrolling beyond the last line\n    padding: {\n        bottom: 80, // Adjust the bottom padding to 80px\n    },\n};\n\nconst editorWrapper = ref<HTMLElement | null>(null);\n\nlet editor: monaco.editor.IStandaloneCodeEditor | null = null;\n\n// let mappingSpec: string = \"\"\n\nconst regex = /\\s+/g;\nconst areStringEqual = (str1: string, str2: string) => (str1.replace(regex, '') === str2.replace(regex, ''));\n\nconst initEditor = () => {\n    if (editor) { // if editor is already initialized, dispose it first\n        editor.dispose();\n    }\n    const editorOptions = {\n        ...editorDefaultOptions,\n        value: tableStore.editor[codeType].code,\n    };\n    editor = monaco.editor.create(editorWrapper.value!, editorOptions as monaco.editor.IEditorConstructionOptions);  // ! means that editorWrapper.value is not null\n\n    editor.onDidBlurEditorText(() => {\n        // 失焦事件优先于别的按钮的点击事件\n        if (codeType === \"mappingSpec\") {\n            tableStore.checkGrammarError();\n            if (tableStore.editor.mappingSpec.errorMark !== null) return\n        }\n        const value = editor!.getValue();\n        if (areStringEqual(tableStore.editor[codeType].code, value)) return; // 忽略换行还有空格之后比较字符串是否相等\n        if (codeType === \"mappingSpec\") {\n            tableStore.spec.undoHistory.push(tableStore.editor.mappingSpec.code);\n            // 当执行新的操作时，重做历史应当清空\n            tableStore.spec.redoHistory = [];\n        }\n        tableStore.editor[codeType].code = value;\n    });\n    if (codeType === \"mappingSpec\") {\n        // 编辑器内容变化时取消高亮\n        editor.onDidChangeModelContent(() => {\n            tableStore.editor.mappingSpec.decorations?.clear();\n        })\n    }\n};\n\nwatch(() => tableStore.editor.rootArea.code, (newVal) => {\n    // console.log(\"watch editor code\", codeType);\n    tableStore.editor.rootArea.instance?.setValue(newVal);  // update editor content; ? means if editor is not null then call setValue, else do nothing\n});\n\n/*\nwatch(() => tableStore.editor[codeType].code, (newVal) => {\n    // console.log(\"watch editor code\", codeType);\n    editor?.setValue(newVal);  // update editor content; ? means if editor is not null then call setValue, else do nothing\n});\n\n\nimport { debounce } from 'lodash';\nconst handleResize = debounce(() => {\n    if (editor) {\n        editor.layout();\n    }\n}, 100); // Adjust the delay time, in milliseconds\n\n// 监听整个窗口的大小变化，通常会引发更多不必要的回调执行，可能会影响性能。\n// window.addEventListener('resize', handleResize);\n\nconst resizeObserver = new ResizeObserver(() => {\n    // console.log(\"Resize observed\", entries);\n    handleResize();\n});\n*/\n\nif (codeType === \"mappingSpec\") {\n\n    // https://microsoft.github.io/monaco-editor/playground.html?source=v0.50.0#example-extending-language-services-configure-javascript-defaults\n\n    const libUri = \"ts:grammar.ts\";\n    // Check if model already exists\n    const existingModel = monaco.editor.getModels().find(model => model.uri.toString() === libUri);\n\n    if (!existingModel) {\n        fetch('./grammar.ts').then((response) => {\n            response.text().then((tsContent) => {\n\n                // validation settings\n                monaco.languages.typescript.javascriptDefaults.setDiagnosticsOptions({\n                    noSemanticValidation: true,\n                    noSyntaxValidation: false,\n                });\n\n                // compiler options\n                monaco.languages.typescript.javascriptDefaults.setCompilerOptions({\n                    target: monaco.languages.typescript.ScriptTarget.ES2015,\n                    allowNonTsExtensions: true,\n                });\n                monaco.languages.typescript.javascriptDefaults.addExtraLib(tsContent, libUri);\n\n                // When resolving definitions and references, the editor will try to use created models.\n                // Creating a model for the library allows \"peek definition/references\" commands to work with the library.\n                monaco.editor.createModel(tsContent, \"typescript\", monaco.Uri.parse(libUri));\n            });\n        });\n    }\n}\n\nonMounted(() => {\n    initEditor();\n    // 可以精确地监听元素大小变化，避免了全局 resize 事件可能带来的性能问题，尤其是当页面上有多个需要监听大小变化的元素时。\n    // resizeObserver.observe(editorWrapper.value!);\n    if (editor) {\n        tableStore.editor[codeType].instance = editor;\n        if (codeType === \"mappingSpec\") {\n            tableStore.editor.mappingSpec.decorations = editor.createDecorationsCollection([]);\n        }\n    }\n});\n\nonUnmounted(() => {\n    // 没有这段代码会导致Code Panel 中的const option 重复被声明\n    if (editor) {\n        editor.dispose();\n    }\n});\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    ref_key: \"editorWrapper\",\n    ref: editorWrapper,\n    class: \"editor-container\"\n  }, null, 512))\n}\n}\n\n})","<template>\n    <div ref=\"editorWrapper\" class=\"editor-container\"></div>\n</template>\n\n<!-- <script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nexport default defineComponent({\n    name: \"CodeView\",\n});\n</script> -->\n\n<script setup lang=\"ts\">\nimport * as monaco from \"monaco-editor\";\nimport { onMounted, onUnmounted, ref, watch } from \"vue\";\nimport { useTableStore } from \"@/store/table\";\n\n\nconst { codeType } = defineProps<{ codeType: \"mappingSpec\" | \"rootArea\" }>();  // | \"transformScript\"\n\nconst tableStore = useTableStore();\n\nconst editorDefaultOptions = {\n    value: '',\n    language: tableStore.editor[codeType].language,\n    theme: 'vs',\n    fontSize: 14,\n    glyphMargin: false,\n    automaticLayout: false, // Automatic layout may cause \"ResizeObserver loop completed with undelivered notifications.\" warning. To avoid this, set automaticLayout to false\n    autoIndent: 'advanced',\n    readOnly: false, // codeType === \"rootArea\" ? true : false,\n    minimap: {\n        enabled: codeType === \"rootArea\" ? true : false,\n    },\n    lineNumbersMinChars: 1,\n    scrollBeyondLastLine: false, // Prevent scrolling beyond the last line\n    padding: {\n        bottom: 80, // Adjust the bottom padding to 80px\n    },\n};\n\nconst editorWrapper = ref<HTMLElement | null>(null);\n\nlet editor: monaco.editor.IStandaloneCodeEditor | null = null;\n\n// let mappingSpec: string = \"\"\n\nconst regex = /\\s+/g;\nconst areStringEqual = (str1: string, str2: string) => (str1.replace(regex, '') === str2.replace(regex, ''));\n\nconst initEditor = () => {\n    if (editor) { // if editor is already initialized, dispose it first\n        editor.dispose();\n    }\n    const editorOptions = {\n        ...editorDefaultOptions,\n        value: tableStore.editor[codeType].code,\n    };\n    editor = monaco.editor.create(editorWrapper.value!, editorOptions as monaco.editor.IEditorConstructionOptions);  // ! means that editorWrapper.value is not null\n\n    editor.onDidBlurEditorText(() => {\n        // 失焦事件优先于别的按钮的点击事件\n        if (codeType === \"mappingSpec\") {\n            tableStore.checkGrammarError();\n            if (tableStore.editor.mappingSpec.errorMark !== null) return\n        }\n        const value = editor!.getValue();\n        if (areStringEqual(tableStore.editor[codeType].code, value)) return; // 忽略换行还有空格之后比较字符串是否相等\n        if (codeType === \"mappingSpec\") {\n            tableStore.spec.undoHistory.push(tableStore.editor.mappingSpec.code);\n            // 当执行新的操作时，重做历史应当清空\n            tableStore.spec.redoHistory = [];\n        }\n        tableStore.editor[codeType].code = value;\n    });\n    if (codeType === \"mappingSpec\") {\n        // 编辑器内容变化时取消高亮\n        editor.onDidChangeModelContent(() => {\n            tableStore.editor.mappingSpec.decorations?.clear();\n        })\n    }\n};\n\nwatch(() => tableStore.editor.rootArea.code, (newVal) => {\n    // console.log(\"watch editor code\", codeType);\n    tableStore.editor.rootArea.instance?.setValue(newVal);  // update editor content; ? means if editor is not null then call setValue, else do nothing\n});\n\n/*\nwatch(() => tableStore.editor[codeType].code, (newVal) => {\n    // console.log(\"watch editor code\", codeType);\n    editor?.setValue(newVal);  // update editor content; ? means if editor is not null then call setValue, else do nothing\n});\n\n\nimport { debounce } from 'lodash';\nconst handleResize = debounce(() => {\n    if (editor) {\n        editor.layout();\n    }\n}, 100); // Adjust the delay time, in milliseconds\n\n// 监听整个窗口的大小变化，通常会引发更多不必要的回调执行，可能会影响性能。\n// window.addEventListener('resize', handleResize);\n\nconst resizeObserver = new ResizeObserver(() => {\n    // console.log(\"Resize observed\", entries);\n    handleResize();\n});\n*/\n\nif (codeType === \"mappingSpec\") {\n\n    // https://microsoft.github.io/monaco-editor/playground.html?source=v0.50.0#example-extending-language-services-configure-javascript-defaults\n\n    const libUri = \"ts:grammar.ts\";\n    // Check if model already exists\n    const existingModel = monaco.editor.getModels().find(model => model.uri.toString() === libUri);\n\n    if (!existingModel) {\n        fetch('./grammar.ts').then((response) => {\n            response.text().then((tsContent) => {\n\n                // validation settings\n                monaco.languages.typescript.javascriptDefaults.setDiagnosticsOptions({\n                    noSemanticValidation: true,\n                    noSyntaxValidation: false,\n                });\n\n                // compiler options\n                monaco.languages.typescript.javascriptDefaults.setCompilerOptions({\n                    target: monaco.languages.typescript.ScriptTarget.ES2015,\n                    allowNonTsExtensions: true,\n                });\n                monaco.languages.typescript.javascriptDefaults.addExtraLib(tsContent, libUri);\n\n                // When resolving definitions and references, the editor will try to use created models.\n                // Creating a model for the library allows \"peek definition/references\" commands to work with the library.\n                monaco.editor.createModel(tsContent, \"typescript\", monaco.Uri.parse(libUri));\n            });\n        });\n    }\n}\n\nonMounted(() => {\n    initEditor();\n    // 可以精确地监听元素大小变化，避免了全局 resize 事件可能带来的性能问题，尤其是当页面上有多个需要监听大小变化的元素时。\n    // resizeObserver.observe(editorWrapper.value!);\n    if (editor) {\n        tableStore.editor[codeType].instance = editor;\n        if (codeType === \"mappingSpec\") {\n            tableStore.editor.mappingSpec.decorations = editor.createDecorationsCollection([]);\n        }\n    }\n});\n\nonUnmounted(() => {\n    // 没有这段代码会导致Code Panel 中的const option 重复被声明\n    if (editor) {\n        editor.dispose();\n    }\n});\n\n\n</script>\n\n\n<style lang=\"less\">\n.editor-container {\n    width: 100%;\n    height: 100%;\n    /* You can adjust the height as needed */\n\n    .nullShallow {\n        // background-color: var(--color-null);\n        background-color: var(--color-nullRGBA); // var(--color-nullShallow);\n    }\n\n    .positionShallow {\n        // background-color: var(--color-position);\n        background-color: var(--color-positionRGBA); // var(--color-positionShallow);\n    }\n\n    .valueShallow {\n        // background-color: var(--color-value);\n        background-color: var(--color-valueRGBA); // var(--color-valueShallow);\n    }\n\n    .contextShallow {\n        // background-color: var(--color-context);\n        background-color: var(--color-contextRGBA); // var(--color-contextShallow);\n    }\n\n    .selectionShallow {\n        // background-color: var(--color-selection);\n        background-color: var(--color-selectionRGBA); // var(--color-selectionShallow);\n    }\n\n}\n</style>","import script from \"./CodeView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CodeView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CodeView.vue?vue&type=style&index=0&id=6a9b63be&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"view\" }\nconst _hoisted_2 = { class: \"view-title\" }\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Minimap\", -1)\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Reset View\", -1)\nconst _hoisted_5 = { class: \"view-content\" }\n\nimport { onMounted, ref, watch } from 'vue';\nimport * as d3 from 'd3';\nimport { useTableStore } from \"@/store/table\";\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'Minimap',\n  setup(__props) {\n\nconst tableStore = useTableStore();\n\nconst container = ref<HTMLDivElement | null>(null);\n\nlet offsetX = 0;\nlet offsetY = 0;\nlet transformStatue: any;\nlet zoom: d3.ZoomBehavior<SVGSVGElement, unknown> | null = null;\n\nfunction resetZoom() {\n    if (zoom && container.value) {\n        // 不能对g.matrix元素进行transform操作，因为zoom事件监听器是添加在svg元素上的，所以需要对svg元素进行transform操作\n        d3.select(container.value).select('svg').transition().duration(750)\n            .call(zoom.transform as any, d3.zoomIdentity); // 重置缩放和平移状态\n    }\n}\n\nconst drawGrid = (rows: number, cols: number) => {\n    if (!container.value) return;\n\n    // Clear any existing SVG\n    d3.select(container.value).selectAll('svg').remove();\n\n    const containerWidth = container.value.clientWidth;\n    const containerHeight = container.value.clientHeight;\n    let cellWidth = Math.max(5, Math.min(45, Math.floor(containerWidth / cols)));\n    let cellHeight = Math.max(5, Math.min(20, Math.floor(containerHeight / rows)));\n    cellWidth = cellHeight = Math.min(cellWidth, cellHeight)\n\n    zoom = d3.zoom<SVGSVGElement, unknown>()\n        // .scaleExtent([0.5, 3.5])  // set the zoom scale range\n        .on('zoom', function (event) {\n            // svg.attr('transform', event.transform);  // 直接设置svg的transform属性会导致缩放后的坐标系不正确（导致的问题是：用鼠标平移（pan）矩形的时候，矩形会抖动，导致矩形实际平移的距离小于鼠标平移的距离），因此需要在svg内部再添加一个g元素\n            // d3.select('g.matrix').attr('transform', event.transform);\n            d3.select('g.matrix').attr('transform', `translate(${offsetX + event.transform.x}, ${offsetY + event.transform.y}) scale(${event.transform.k})`); // Update the matrix transform based on the zoom event\n            // updateCellTextVisibility(event.transform.k); // Update cell text visibility based on the current scale\n            // transformStatue = event.transform;\n        })\n\n    const svg = d3.select(container.value)\n        .append('svg')\n        .attr('width', containerWidth)\n        .attr('height', containerHeight)\n        .call(zoom)  // 注意，这里添加zoom的是svg元素，而不是g.matrix元素，所以当resetZoom时，需要对svg元素进行transform操作\n\n    const matrix = svg.append('g').classed(\"matrix\", true);  // Append a 'g' element for better transform management to avoid jittering\n    // let texts: any = null;\n\n    const grids = tableStore.generateGrid(rows, cols);\n\n    const cells = matrix.selectAll('rect')\n        .data(grids)\n        .enter().append('rect').classed('grid-cell', true)\n        .attr('x', d => d.col * cellWidth)\n        .attr('y', d => d.row * cellHeight)\n        .attr('id', d => `grid-${d.row}-${d.col}`)\n        .attr('width', cellWidth)\n        .attr('height', cellHeight)\n        // .on('mouseover', function () {\n        //     d3.select(this).raise() // Bring the cell to the front \n        //         // .attr('fill', '#ece9e6')\n        //         // .attr('stroke', '#4b8aff')\n        //         .attr('stroke-width', 2);\n        //     if (texts) {\n        //         texts.raise();\n        //     }\n        // })\n        // .on('mouseout', function () {\n        //     d3.select(this)\n        //         // .attr('fill', '#f9f7ff')\n        //         // .attr('stroke', '#cccccc')\n        //         .attr('stroke-width', 1);\n        // })\n        .on('click', function (event, d) {\n            d3.selectAll('rect.grid-cell').attr('class', 'grid-cell');\n            d3.select(this).raise().classed('selection', true);\n            tableStore.grid_cell_click({ row: d.row, col: d.col })\n            tableStore.input_tbl.instance.deselectCell();\n            tableStore.output_tbl.instance.deselectCell();\n        })\n        .append('title').text(d => `Position: (${d.row}, ${d.col})`);\n\n    // Calculate the offset to center the matrix in the SVG container\n    offsetX = Math.max((containerWidth - matrix.node()!.getBBox().width) / 2, 0);\n    offsetY = Math.max((containerHeight - matrix.node()!.getBBox().height) / 2, 0);\n    matrix.attr('transform', `translate(${offsetX}, ${offsetY})`); // Center the matrix\n    transformStatue = d3.zoomIdentity;\n\n    /*\n    const updateCellTextVisibility = (scale: number) => {\n        const scaledCellWidth = cellWidth * scale;\n        const scaledCellHeight = cellHeight * scale;\n        // const cellArea = scaledCellWidth * scaledCellHeight;\n        if (scaledCellWidth >= 45 && scaledCellHeight >= 20) {\n            if (texts) {\n                texts.style('display', 'block');\n            } else {\n                texts = matrix.selectAll('text')\n                    .data(grids)\n                    .enter().append('text').classed('grid-text', true)\n                    .attr('x', d => d.col * cellWidth + cellWidth / 2)\n                    .attr('y', d => d.row * cellHeight + cellHeight / 2)\n                    .attr('id', d => `text-${d.row}-${d.col}`)\n                    .attr('dy', '.30em')\n                    .attr('font-size', 15 / scale)\n                    .attr('fill', '#000')\n                    .attr('text-anchor', 'middle')\n                    .text(d => `(${d.row}, ${d.col})`)\n                    .style('display', 'block')\n                    .style('pointer-events', 'none'); // Ensure text does not capture mouse events, in order to allow clicking on the cells\n            }\n        } else {\n            if (texts) {\n                texts.style('display', 'none');\n            }\n        }\n    };\n\n    updateCellTextVisibility(1); // Initial update for default scale 1\n    */\n};\n\n/*\nimport { debounce } from 'lodash';\n\nconst debouncedResize = debounce(() => {\n    // requestAnimationFrame(() => {\n    //     drawGrid();\n    // });\n    if (tableStore.input_tbl.tbl.length === 0) {\n        d3.select(container.value).selectAll('svg').remove();\n    } else {\n        drawGrid(tableStore.input_tbl.tbl.length, tableStore.input_tbl.tbl[0].length);\n    }\n}, 100); // 调整延迟时间，单位为毫秒\n\nconst resizeObserver = new ResizeObserver(() => {\n    debouncedResize();\n});\n*/\n\nonMounted(() => {\n    if (container.value) {\n        // resizeObserver.observe(container.value);\n    }\n});\n\n\nwatch(() => tableStore.input_tbl.tbl, (newVal) => {\n    // console.log('watch: tbl changed: start');\n    if (newVal.length === 0) {\n        d3.select(container.value).selectAll('svg').remove();\n    } else {\n        drawGrid(newVal.length, newVal[0].length);\n    }\n});\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_a_button = _resolveComponent(\"a-button\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _hoisted_3,\n      _createVNode(_component_a_button, {\n        size: \"small\",\n        style: {\"float\":\"right\",\"margin-right\":\"5px\"},\n        onClick: resetZoom\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_icon, {\n            name: \"bi-arrow-clockwise\",\n            scale: \"0.9\"\n          }),\n          _hoisted_4\n        ]),\n        _: 1\n      })\n    ]),\n    _createElementVNode(\"div\", _hoisted_5, [\n      _createElementVNode(\"div\", {\n        ref_key: \"container\",\n        ref: container,\n        class: \"grid-container\"\n      }, null, 512)\n    ])\n  ]))\n}\n}\n\n})","<template>\n    <div class=\"view\">\n        <div class=\"view-title\">\n            <span>Minimap</span>\n            <a-button size=\"small\" style=\"float: right; margin-right: 5px\" @click=\"resetZoom\">\n                <v-icon name=\"bi-arrow-clockwise\" scale=\"0.9\"></v-icon>\n                <span>Reset View</span>\n            </a-button>\n        </div>\n        <div class=\"view-content\">\n            <div ref=\"container\" class=\"grid-container\"></div>\n        </div>\n    </div>\n\n</template>\n\n<script setup lang=\"ts\">\nimport { onMounted, ref, watch } from 'vue';\nimport * as d3 from 'd3';\nimport { useTableStore } from \"@/store/table\";\n\nconst tableStore = useTableStore();\n\nconst container = ref<HTMLDivElement | null>(null);\n\nlet offsetX = 0;\nlet offsetY = 0;\nlet transformStatue: any;\nlet zoom: d3.ZoomBehavior<SVGSVGElement, unknown> | null = null;\n\nfunction resetZoom() {\n    if (zoom && container.value) {\n        // 不能对g.matrix元素进行transform操作，因为zoom事件监听器是添加在svg元素上的，所以需要对svg元素进行transform操作\n        d3.select(container.value).select('svg').transition().duration(750)\n            .call(zoom.transform as any, d3.zoomIdentity); // 重置缩放和平移状态\n    }\n}\n\nconst drawGrid = (rows: number, cols: number) => {\n    if (!container.value) return;\n\n    // Clear any existing SVG\n    d3.select(container.value).selectAll('svg').remove();\n\n    const containerWidth = container.value.clientWidth;\n    const containerHeight = container.value.clientHeight;\n    let cellWidth = Math.max(5, Math.min(45, Math.floor(containerWidth / cols)));\n    let cellHeight = Math.max(5, Math.min(20, Math.floor(containerHeight / rows)));\n    cellWidth = cellHeight = Math.min(cellWidth, cellHeight)\n\n    zoom = d3.zoom<SVGSVGElement, unknown>()\n        // .scaleExtent([0.5, 3.5])  // set the zoom scale range\n        .on('zoom', function (event) {\n            // svg.attr('transform', event.transform);  // 直接设置svg的transform属性会导致缩放后的坐标系不正确（导致的问题是：用鼠标平移（pan）矩形的时候，矩形会抖动，导致矩形实际平移的距离小于鼠标平移的距离），因此需要在svg内部再添加一个g元素\n            // d3.select('g.matrix').attr('transform', event.transform);\n            d3.select('g.matrix').attr('transform', `translate(${offsetX + event.transform.x}, ${offsetY + event.transform.y}) scale(${event.transform.k})`); // Update the matrix transform based on the zoom event\n            // updateCellTextVisibility(event.transform.k); // Update cell text visibility based on the current scale\n            // transformStatue = event.transform;\n        })\n\n    const svg = d3.select(container.value)\n        .append('svg')\n        .attr('width', containerWidth)\n        .attr('height', containerHeight)\n        .call(zoom)  // 注意，这里添加zoom的是svg元素，而不是g.matrix元素，所以当resetZoom时，需要对svg元素进行transform操作\n\n    const matrix = svg.append('g').classed(\"matrix\", true);  // Append a 'g' element for better transform management to avoid jittering\n    // let texts: any = null;\n\n    const grids = tableStore.generateGrid(rows, cols);\n\n    const cells = matrix.selectAll('rect')\n        .data(grids)\n        .enter().append('rect').classed('grid-cell', true)\n        .attr('x', d => d.col * cellWidth)\n        .attr('y', d => d.row * cellHeight)\n        .attr('id', d => `grid-${d.row}-${d.col}`)\n        .attr('width', cellWidth)\n        .attr('height', cellHeight)\n        // .on('mouseover', function () {\n        //     d3.select(this).raise() // Bring the cell to the front \n        //         // .attr('fill', '#ece9e6')\n        //         // .attr('stroke', '#4b8aff')\n        //         .attr('stroke-width', 2);\n        //     if (texts) {\n        //         texts.raise();\n        //     }\n        // })\n        // .on('mouseout', function () {\n        //     d3.select(this)\n        //         // .attr('fill', '#f9f7ff')\n        //         // .attr('stroke', '#cccccc')\n        //         .attr('stroke-width', 1);\n        // })\n        .on('click', function (event, d) {\n            d3.selectAll('rect.grid-cell').attr('class', 'grid-cell');\n            d3.select(this).raise().classed('selection', true);\n            tableStore.grid_cell_click({ row: d.row, col: d.col })\n            tableStore.input_tbl.instance.deselectCell();\n            tableStore.output_tbl.instance.deselectCell();\n        })\n        .append('title').text(d => `Position: (${d.row}, ${d.col})`);\n\n    // Calculate the offset to center the matrix in the SVG container\n    offsetX = Math.max((containerWidth - matrix.node()!.getBBox().width) / 2, 0);\n    offsetY = Math.max((containerHeight - matrix.node()!.getBBox().height) / 2, 0);\n    matrix.attr('transform', `translate(${offsetX}, ${offsetY})`); // Center the matrix\n    transformStatue = d3.zoomIdentity;\n\n    /*\n    const updateCellTextVisibility = (scale: number) => {\n        const scaledCellWidth = cellWidth * scale;\n        const scaledCellHeight = cellHeight * scale;\n        // const cellArea = scaledCellWidth * scaledCellHeight;\n        if (scaledCellWidth >= 45 && scaledCellHeight >= 20) {\n            if (texts) {\n                texts.style('display', 'block');\n            } else {\n                texts = matrix.selectAll('text')\n                    .data(grids)\n                    .enter().append('text').classed('grid-text', true)\n                    .attr('x', d => d.col * cellWidth + cellWidth / 2)\n                    .attr('y', d => d.row * cellHeight + cellHeight / 2)\n                    .attr('id', d => `text-${d.row}-${d.col}`)\n                    .attr('dy', '.30em')\n                    .attr('font-size', 15 / scale)\n                    .attr('fill', '#000')\n                    .attr('text-anchor', 'middle')\n                    .text(d => `(${d.row}, ${d.col})`)\n                    .style('display', 'block')\n                    .style('pointer-events', 'none'); // Ensure text does not capture mouse events, in order to allow clicking on the cells\n            }\n        } else {\n            if (texts) {\n                texts.style('display', 'none');\n            }\n        }\n    };\n\n    updateCellTextVisibility(1); // Initial update for default scale 1\n    */\n};\n\n/*\nimport { debounce } from 'lodash';\n\nconst debouncedResize = debounce(() => {\n    // requestAnimationFrame(() => {\n    //     drawGrid();\n    // });\n    if (tableStore.input_tbl.tbl.length === 0) {\n        d3.select(container.value).selectAll('svg').remove();\n    } else {\n        drawGrid(tableStore.input_tbl.tbl.length, tableStore.input_tbl.tbl[0].length);\n    }\n}, 100); // 调整延迟时间，单位为毫秒\n\nconst resizeObserver = new ResizeObserver(() => {\n    debouncedResize();\n});\n*/\n\nonMounted(() => {\n    if (container.value) {\n        // resizeObserver.observe(container.value);\n    }\n});\n\n\nwatch(() => tableStore.input_tbl.tbl, (newVal) => {\n    // console.log('watch: tbl changed: start');\n    if (newVal.length === 0) {\n        d3.select(container.value).selectAll('svg').remove();\n    } else {\n        drawGrid(newVal.length, newVal[0].length);\n    }\n});\n\n</script>\n\n<style lang=\"less\">\n.grid-container {\n    width: 100%;\n    height: 100%;\n\n    rect.positionShallow {\n        fill: var(--color-positionShallow);\n        stroke: var(--color-positionShallow);\n    }\n\n    rect.position {\n        fill: var(--color-position);\n        stroke: var(--color-position);\n    }\n\n    rect.contextShallow {\n        fill: var(--color-contextShallow);\n        stroke: var(--color-contextShallow);\n    }\n\n    rect.context {\n        fill: var(--color-context);\n        stroke: var(--color-context);\n    }\n\n    rect.valueShallow {\n        fill: var(--color-valueShallow);\n        stroke: var(--color-valueShallow);\n    }\n\n    rect.value {\n        fill: var(--color-value);\n        stroke: var(--color-value);\n    }\n\n    rect.nullShallow {\n        fill: var(--color-nullShallow);\n        stroke: var(--color-nullShallow);\n    }\n\n    rect.null {\n        fill: var(--color-null);\n        stroke: var(--color-null);\n    }\n\n    rect.selectionShallow {\n        fill: var(--color-selectionShallow);\n        stroke: var(--color-selectionShallow);\n    }\n\n    rect.selection {\n        fill: var(--color-selection);\n        stroke: var(--color-selection);\n    }\n\n    .grid-cell {\n        // 不写 rect.grid-cell 是让此选择器的优先级低于 rect.selection 等选择器\n        fill: var(--color-cellFill);\n        stroke: var(--color-cellStroke);\n        stroke-width: 1px;\n    }\n\n    .grid-cell:hover {\n        stroke-width: 2px;\n    }\n\n    /*\n    rect.cell-grid {\n        fill: #f9f7ff;\n        stroke: grey;\n        stroke-width: 1px;\n        transition: fill 0.2s, stroke 0.2s; //添加过渡效果，使颜色变化更平滑 \n    }\n\n    rect.cell-grid:hover {\n        fill: #ece9e6;\n        stroke: black;\n        stroke-width: 2px;\n        // outline: 2px solid black; // 确保边框宽度能够高亮显示\n    }\n    */\n}\n</style>","import script from \"./Minimap.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Minimap.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./Minimap.vue?vue&type=style&index=0&id=46df6d5a&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import script from \"./PatternVis.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PatternVis.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./PatternVis.vue?vue&type=style&index=0&id=aee863a2&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, unref as _unref, toDisplayString as _toDisplayString, resolveDynamicComponent as _resolveDynamicComponent, openBlock as _openBlock, createBlock as _createBlock, normalizeStyle as _normalizeStyle } from \"vue\"\n\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"span\", null, \"x (col):\", -1)\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"span\", null, \"y (row):\", -1)\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"span\", null, \"width:\", -1)\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"span\", null, \"height:\", -1)\n\nimport { ref, computed, CSSProperties, watch, watchEffect } from 'vue';\nimport { useDraggable } from '@vueuse/core';\nimport { useTableStore, AreaForm } from '@/store/table';\n// import { TableTidierTemplate } from '@/grammar/grammar';\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'DraggableModal',\n  setup(__props) {\n\nconst tableStore = useTableStore();\nconst areaConfig = tableStore.spec.areaConfig;\n\n\n\n/* ---------- Area Form ---------- */\n// const formData = ref<TableTidierTemplate>(areaConfig)\nconst formData = ref<AreaForm>(tableStore.spec.areaFormData)\n\ntableStore.spec.areaFormData = formData.value\n\nconst handleOk = (values: any) => {\n    handleCancel();\n    tableStore.selectArea();\n};\nconst resetForm = () => {\n    formData.value = {\n        referenceAreaLayer: areaConfig.match!.startCell?.referenceAreaLayer,\n        referenceAreaPosi: areaConfig.match!.startCell?.referenceAreaPosi,\n        position: {\n            x: areaConfig.match!.startCell?.xOffset,\n            y: areaConfig.match!.startCell?.yOffset\n        },\n        traverse: {\n            xDirection: areaConfig.match!.traverse?.xDirection,\n            yDirection: areaConfig.match!.traverse?.yDirection\n        },\n        size: {\n            width: areaConfig.match!.size?.width,\n            height: areaConfig.match!.size?.height\n        }\n    };\n}\n\n\n/* ---------- Draggable ---------- */\nconst open = computed(() => tableStore.spec.dragConfigOpen)\nconst modalTitleRef = ref<HTMLElement>();\n\nconst { x, y, isDragging } = useDraggable(modalTitleRef);\nconst handleCancel = () => {\n    tableStore.spec.dragConfigOpen = false;\n    tableStore.spec.selectAreaFromNode = \"\";\n};\nconst startX = ref<number>(0);\nconst startY = ref<number>(0);\nconst startedDrag = ref(false);\nconst transformX = ref(0);\nconst transformY = ref(0);\nconst preTransformX = ref(0);\nconst preTransformY = ref(0);\nconst dragRect = ref({ left: 0, right: 0, top: 0, bottom: 0 });\nwatch([x, y], () => {\n    if (!startedDrag.value) {\n        startX.value = x.value;\n        startY.value = y.value;\n        const bodyRect = document.body.getBoundingClientRect();\n        const titleRect = modalTitleRef.value!.getBoundingClientRect();\n        dragRect.value.right = bodyRect.width - titleRect.width;\n        dragRect.value.bottom = bodyRect.height - titleRect.height;\n        preTransformX.value = transformX.value;\n        preTransformY.value = transformY.value;\n    }\n    startedDrag.value = true;\n});\nwatch(isDragging, () => {\n    if (!isDragging) {\n        startedDrag.value = false;\n    }\n});\n\nwatchEffect(() => {\n    if (startedDrag.value) {\n        transformX.value =\n            preTransformX.value +\n            Math.min(Math.max(dragRect.value.left, x.value), dragRect.value.right) -\n            startX.value;\n        transformY.value =\n            preTransformY.value +\n            Math.min(Math.max(dragRect.value.top, y.value), dragRect.value.bottom) -\n            startY.value;\n    }\n});\nconst transformStyle = computed<CSSProperties>(() => {\n    return {\n        transform: `translate(${transformX.value}px, ${transformY.value}px)`,\n    };\n});\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_a_divider = _resolveComponent(\"a-divider\")!\n  const _component_a_col = _resolveComponent(\"a-col\")!\n  const _component_a_radio_button = _resolveComponent(\"a-radio-button\")!\n  const _component_a_radio_group = _resolveComponent(\"a-radio-group\")!\n  const _component_a_row = _resolveComponent(\"a-row\")!\n  const _component_a_modal = _resolveComponent(\"a-modal\")!\n\n  return (_openBlock(), _createBlock(_component_a_modal, {\n    ref: \"modalRef\",\n    open: open.value,\n    \"onUpdate:open\": _cache[8] || (_cache[8] = ($event: any) => ((open).value = $event)),\n    \"wrap-style\": { overflow: 'hidden' },\n    onCancel: handleCancel,\n    onOk: handleOk,\n    okText: \"Confirm\",\n    width: \"600px\"\n  }, {\n    title: _withCtx(() => [\n      _createElementVNode(\"div\", {\n        ref_key: \"modalTitleRef\",\n        ref: modalTitleRef,\n        style: {\"width\":\"100%\",\"cursor\":\"move\"}\n      }, \"Template Area\", 512)\n    ]),\n    modalRender: _withCtx(({ originVNode }) => [\n      _createElementVNode(\"div\", {\n        style: _normalizeStyle(transformStyle.value)\n      }, [\n        (_openBlock(), _createBlock(_resolveDynamicComponent(originVNode)))\n      ], 4)\n    ]),\n    default: _withCtx(() => [\n      _createElementVNode(\"div\", null, [\n        _createElementVNode(\"div\", null, [\n          _createVNode(_component_a_divider, null, {\n            default: _withCtx(() => [\n              _createTextVNode(\"startCell\")\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_a_row, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_col, { flex: \"100px\" }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"referenceAreaLayer\")\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_col, { flex: \"auto\" }, {\n                default: _withCtx(() => [\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.referenceAreaLayer,\n                    \"onUpdate:value\": _cache[0] || (_cache[0] = ($event: any) => ((formData.value.referenceAreaLayer) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, { value: \"current\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"current\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"parent\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"parent\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"root\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"root\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, {\n                        value: \"areaLayerFn\",\n                        title: \"areaLayerFn\"\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"Custom Func\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"])\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_a_row, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_col, { flex: \"100px\" }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"referenceAreaPosition\")\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_col, { flex: \"auto\" }, {\n                default: _withCtx(() => [\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.referenceAreaPosi,\n                    \"onUpdate:value\": _cache[1] || (_cache[1] = ($event: any) => ((formData.value.referenceAreaPosi) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, { value: \"topLeft\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"topLeft\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"topRight\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"topRight\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"bottomLeft\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"bottomLeft\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"bottomRight\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"bottomRight\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"])\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_a_row, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_col, { flex: \"100px\" }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"Start Position\")\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_col, { flex: \"auto\" }, {\n                default: _withCtx(() => [\n                  _hoisted_1,\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.position.x,\n                    \"onUpdate:value\": _cache[2] || (_cache[2] = ($event: any) => ((formData.value.position.x) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, {\n                        value: _unref(areaConfig).match!.startCell!.xOffset\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(_toDisplayString(_unref(areaConfig).match!.startCell!.xOffset), 1)\n                        ]),\n                        _: 1\n                      }, 8, [\"value\"]),\n                      _createVNode(_component_a_radio_button, {\n                        value: \"offsetFn\",\n                        title: \"areaLayerFn\"\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"Custom Func\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"]),\n                  _hoisted_2,\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.position.y,\n                    \"onUpdate:value\": _cache[3] || (_cache[3] = ($event: any) => ((formData.value.position.y) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, {\n                        value: _unref(areaConfig).match!.startCell!.yOffset\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(_toDisplayString(_unref(areaConfig).match!.startCell!.yOffset), 1)\n                        ]),\n                        _: 1\n                      }, 8, [\"value\"]),\n                      _createVNode(_component_a_radio_button, {\n                        value: \"offsetFn\",\n                        title: \"areaLayerFn\"\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"Custom Func\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"])\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          })\n        ]),\n        _createElementVNode(\"div\", null, [\n          _createVNode(_component_a_divider, null, {\n            default: _withCtx(() => [\n              _createTextVNode(\"size\")\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_a_row, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_col, { flex: \"5\" }, {\n                default: _withCtx(() => [\n                  _hoisted_3,\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.size.width,\n                    \"onUpdate:value\": _cache[4] || (_cache[4] = ($event: any) => ((formData.value.size.width) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, {\n                        value: _unref(areaConfig).match!.size!.width\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(_toDisplayString(_unref(areaConfig).match!.size!.width), 1)\n                        ]),\n                        _: 1\n                      }, 8, [\"value\"]),\n                      _createVNode(_component_a_radio_button, {\n                        value: null,\n                        title: \"Don't specify\"\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"null\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"])\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_col, { flex: \"5\" }, {\n                default: _withCtx(() => [\n                  _hoisted_4,\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.size.height,\n                    \"onUpdate:value\": _cache[5] || (_cache[5] = ($event: any) => ((formData.value.size.height) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, {\n                        value: _unref(areaConfig).match!.size!.height\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(_toDisplayString(_unref(areaConfig).match!.size!.height), 1)\n                        ]),\n                        _: 1\n                      }, 8, [\"value\"]),\n                      _createVNode(_component_a_radio_button, {\n                        value: null,\n                        title: \"Don't specify\"\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"null\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"])\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          })\n        ]),\n        _createElementVNode(\"div\", null, [\n          _createVNode(_component_a_divider, null, {\n            default: _withCtx(() => [\n              _createTextVNode(\"traverse\")\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_a_row, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_col, { flex: \"100px\" }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"x direction:\")\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_col, { flex: \"auto\" }, {\n                default: _withCtx(() => [\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.traverse.xDirection,\n                    \"onUpdate:value\": _cache[6] || (_cache[6] = ($event: any) => ((formData.value.traverse.xDirection) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, { value: \"after\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"after\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"above\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"above\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"whole\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"whole\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, {\n                        value: null,\n                        title: \"Don't specify\"\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"null\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"])\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_a_row, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_col, { flex: \"100px\" }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"y direction:\")\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_col, { flex: \"auto\" }, {\n                default: _withCtx(() => [\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.traverse.yDirection,\n                    \"onUpdate:value\": _cache[7] || (_cache[7] = ($event: any) => ((formData.value.traverse.yDirection) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, { value: \"after\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"after\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"above\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"above\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"whole\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"whole\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, {\n                        value: null,\n                        title: \"Don't specify\"\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"null\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"])\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          })\n        ])\n      ])\n    ]),\n    _: 1\n  }, 8, [\"open\"]))\n}\n}\n\n})","<template>\n    <a-modal ref=\"modalRef\" v-model:open=\"open\" :wrap-style=\"{ overflow: 'hidden' }\" @cancel=\"handleCancel\"\n        @ok=\"handleOk\" okText=\"Confirm\" width=\"600px\">\n        <div>\n            <div>\n                <a-divider>startCell</a-divider>\n                <a-row>\n                    <a-col flex=\"100px\">referenceAreaLayer</a-col>\n                    <a-col flex=\"auto\">\n                        <a-radio-group v-model:value=\"formData.referenceAreaLayer\">\n                            <a-radio-button value=\"current\">current</a-radio-button>\n                            <a-radio-button value=\"parent\">parent</a-radio-button>\n                            <a-radio-button value=\"root\">root</a-radio-button>\n                            <a-radio-button value=\"areaLayerFn\" title=\"areaLayerFn\">Custom Func</a-radio-button>\n                        </a-radio-group>\n                    </a-col>\n                </a-row>\n                <a-row>\n                    <a-col flex=\"100px\">referenceAreaPosition</a-col>\n                    <a-col flex=\"auto\">\n                        <a-radio-group v-model:value=\"formData.referenceAreaPosi\">\n                            <a-radio-button value=\"topLeft\">topLeft</a-radio-button>\n                            <a-radio-button value=\"topRight\">topRight</a-radio-button>\n                            <a-radio-button value=\"bottomLeft\">bottomLeft</a-radio-button>\n                            <a-radio-button value=\"bottomRight\">bottomRight</a-radio-button>\n                        </a-radio-group>\n                    </a-col>\n                </a-row>\n                <a-row>\n                    <a-col flex=\"100px\">Start Position</a-col>\n                    <a-col flex=\"auto\">\n                        <span>x (col):</span>\n                        <a-radio-group v-model:value=\"formData.position.x\">\n                            <a-radio-button :value=\"areaConfig.match!.startCell!.xOffset\">{{\n                                areaConfig.match!.startCell!.xOffset\n                                }}</a-radio-button>\n                            <a-radio-button value=\"offsetFn\" title=\"areaLayerFn\">Custom Func</a-radio-button>\n                        </a-radio-group>\n                        <span>y (row):</span>\n                        <a-radio-group v-model:value=\"formData.position.y\">\n                            <a-radio-button :value=\"areaConfig.match!.startCell!.yOffset\">{{\n                                areaConfig.match!.startCell!.yOffset\n                                }}</a-radio-button>\n                            <a-radio-button value=\"offsetFn\" title=\"areaLayerFn\">Custom Func</a-radio-button>\n                        </a-radio-group>\n                    </a-col>\n                </a-row>\n            </div>\n            <div>\n                <a-divider>size</a-divider>\n                <a-row>\n                    <a-col flex=\"5\">\n                        <span>width:</span>\n                        <a-radio-group v-model:value=\"formData.size.width\">\n                            <a-radio-button :value=\"areaConfig.match!.size!.width\">{{ areaConfig.match!.size!.width\n                                }}</a-radio-button>\n                            <a-radio-button :value=\"null\" title=\"Don't specify\">null</a-radio-button>\n                        </a-radio-group>\n                    </a-col>\n                    <a-col flex=\"5\">\n                        <span>height:</span>\n                        <a-radio-group v-model:value=\"formData.size.height\">\n                            <a-radio-button :value=\"areaConfig.match!.size!.height\">{{ areaConfig.match!.size!.height\n                                }}</a-radio-button>\n                            <a-radio-button :value=\"null\" title=\"Don't specify\">null</a-radio-button>\n                        </a-radio-group>\n                    </a-col>\n                </a-row>\n            </div>\n            <div>\n                <a-divider>traverse</a-divider>\n                <a-row>\n                    <a-col flex=\"100px\">x direction:</a-col>\n                    <a-col flex=\"auto\">\n                        <a-radio-group v-model:value=\"formData.traverse.xDirection\">\n                            <a-radio-button value=\"after\">after</a-radio-button>\n                            <a-radio-button value=\"above\">above</a-radio-button>\n                            <a-radio-button value=\"whole\">whole</a-radio-button>\n                            <a-radio-button :value=\"null\" title=\"Don't specify\">null</a-radio-button>\n                        </a-radio-group>\n                    </a-col>\n                </a-row>\n                <a-row>\n                    <a-col flex=\"100px\">y direction:</a-col>\n                    <a-col flex=\"auto\">\n                        <a-radio-group v-model:value=\"formData.traverse.yDirection\">\n                            <a-radio-button value=\"after\">after</a-radio-button>\n                            <a-radio-button value=\"above\">above</a-radio-button>\n                            <a-radio-button value=\"whole\">whole</a-radio-button>\n                            <a-radio-button :value=\"null\" title=\"Don't specify\">null</a-radio-button>\n                        </a-radio-group>\n                    </a-col>\n                </a-row>\n            </div>\n        </div>\n\n        <template #title>\n            <div ref=\"modalTitleRef\" style=\"width: 100%; cursor: move\">Template Area</div>\n        </template>\n        <template #modalRender=\"{ originVNode }\">\n            <div :style=\"transformStyle\">\n                <component :is=\"originVNode\" />\n            </div>\n        </template>\n    </a-modal>\n</template>\n<script lang=\"ts\" setup>\nimport { ref, computed, CSSProperties, watch, watchEffect } from 'vue';\nimport { useDraggable } from '@vueuse/core';\nimport { useTableStore, AreaForm } from '@/store/table';\n// import { TableTidierTemplate } from '@/grammar/grammar';\nconst tableStore = useTableStore();\nconst areaConfig = tableStore.spec.areaConfig;\n\n\n\n/* ---------- Area Form ---------- */\n// const formData = ref<TableTidierTemplate>(areaConfig)\nconst formData = ref<AreaForm>(tableStore.spec.areaFormData)\n\ntableStore.spec.areaFormData = formData.value\n\nconst handleOk = (values: any) => {\n    handleCancel();\n    tableStore.selectArea();\n};\nconst resetForm = () => {\n    formData.value = {\n        referenceAreaLayer: areaConfig.match!.startCell?.referenceAreaLayer,\n        referenceAreaPosi: areaConfig.match!.startCell?.referenceAreaPosi,\n        position: {\n            x: areaConfig.match!.startCell?.xOffset,\n            y: areaConfig.match!.startCell?.yOffset\n        },\n        traverse: {\n            xDirection: areaConfig.match!.traverse?.xDirection,\n            yDirection: areaConfig.match!.traverse?.yDirection\n        },\n        size: {\n            width: areaConfig.match!.size?.width,\n            height: areaConfig.match!.size?.height\n        }\n    };\n}\n\n\n/* ---------- Draggable ---------- */\nconst open = computed(() => tableStore.spec.dragConfigOpen)\nconst modalTitleRef = ref<HTMLElement>();\n\nconst { x, y, isDragging } = useDraggable(modalTitleRef);\nconst handleCancel = () => {\n    tableStore.spec.dragConfigOpen = false;\n    tableStore.spec.selectAreaFromNode = \"\";\n};\nconst startX = ref<number>(0);\nconst startY = ref<number>(0);\nconst startedDrag = ref(false);\nconst transformX = ref(0);\nconst transformY = ref(0);\nconst preTransformX = ref(0);\nconst preTransformY = ref(0);\nconst dragRect = ref({ left: 0, right: 0, top: 0, bottom: 0 });\nwatch([x, y], () => {\n    if (!startedDrag.value) {\n        startX.value = x.value;\n        startY.value = y.value;\n        const bodyRect = document.body.getBoundingClientRect();\n        const titleRect = modalTitleRef.value!.getBoundingClientRect();\n        dragRect.value.right = bodyRect.width - titleRect.width;\n        dragRect.value.bottom = bodyRect.height - titleRect.height;\n        preTransformX.value = transformX.value;\n        preTransformY.value = transformY.value;\n    }\n    startedDrag.value = true;\n});\nwatch(isDragging, () => {\n    if (!isDragging) {\n        startedDrag.value = false;\n    }\n});\n\nwatchEffect(() => {\n    if (startedDrag.value) {\n        transformX.value =\n            preTransformX.value +\n            Math.min(Math.max(dragRect.value.left, x.value), dragRect.value.right) -\n            startX.value;\n        transformY.value =\n            preTransformY.value +\n            Math.min(Math.max(dragRect.value.top, y.value), dragRect.value.bottom) -\n            startY.value;\n    }\n});\nconst transformStyle = computed<CSSProperties>(() => {\n    return {\n        transform: `translate(${transformX.value}px, ${transformY.value}px)`,\n    };\n});\n</script>","import script from \"./DraggableModal.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./DraggableModal.vue?vue&type=script&lang=ts&setup=true\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { id: \"panel\" }\nconst _hoisted_2 = { class: \"system-name\" }\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"span\", { id: \"system_name\" }, \"TableTidier\", -1)\nconst _hoisted_4 = { style: {\"left\":\"20px\",\"position\":\"absolute\"} }\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"span\", { style: {\"font-size\":\"16px\",\"font-weight\":\"normal\",\"margin-right\":\"5px\"} }, \"Cases:\", -1)\nconst _hoisted_6 = { style: {\"right\":\"20px\",\"position\":\"absolute\"} }\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"span\", { style: {\"margin-left\":\"5px\"} }, \"Undo\", -1)\nconst _hoisted_8 = /*#__PURE__*/_createElementVNode(\"span\", { style: {\"margin-left\":\"5px\"} }, \"Redo\", -1)\nconst _hoisted_9 = { class: \"main-views\" }\nconst _hoisted_10 = {\n  class: \"column\",\n  style: {\"flex\":\"12\"}\n}\nconst _hoisted_11 = { style: {\"flex\":\"1\",\"display\":\"flex\"} }\nconst _hoisted_12 = { style: {\"flex\":\"1\",\"display\":\"flex\"} }\nconst _hoisted_13 = {\n  class: \"column\",\n  style: {\"flex\":\"5\"}\n}\nconst _hoisted_14 = { class: \"view\" }\nconst _hoisted_15 = { class: \"view-title\" }\nconst _hoisted_16 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Code Panel\", -1)\nconst _hoisted_17 = { style: {\"float\":\"right\",\"margin-right\":\"20px\"} }\nconst _hoisted_18 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Run\", -1)\nconst _hoisted_19 = { class: \"view-content\" }\nconst _hoisted_20 = /*#__PURE__*/_createElementVNode(\"span\", null, \" Specification \", -1)\nconst _hoisted_21 = /*#__PURE__*/_createElementVNode(\"span\", null, \" Matched Instances \", -1)\n\nimport { computed, onMounted, ref } from \"vue\";\n\nimport InOutTable from \"@/components/InOutTable.vue\";\nimport CodeView from \"@/components/CodeView.vue\";\nimport Minimap from \"@/components/Minimap.vue\";\nimport PatternVis from \"@/components/PatternVis.vue\";\nimport DraggableModal from \"@/components/DraggableModal.vue\";\n// import ChatBot from \"@/components/ChatBot.vue\";\n\nimport { typeMapColor, TypeColor } from '@/tree/style';\nimport { useTableStore } from \"@/store/table\";\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'PanelView',\n  setup(__props) {\n\nfor (const key in typeMapColor) {\n  document.documentElement.style.setProperty(`--color-${key}`, typeMapColor[key as TypeColor]);\n}\ndocument.documentElement.style.setProperty('--custom-cursor', 'default');\n\nconst tableStore = useTableStore();\n\n// let caseOption: Ref<{ value: string; label: string; }[]> = ref([]);\n// let caseOption = ref<{ value: string; label: string }[]>([]);\n\nconst caseOption = computed(() => {\n  return tableStore.caseList.map((v) => {\n    return { value: v, label: v };\n  });\n})\n\nconst currentCase = computed(() => tableStore.currentCase);\n\nconst codePanel = ref(\"1\");\nconst loading = ref<boolean>(false);\n\nconst undoFlag = computed(() => tableStore.spec.undoHistory.length === 0);\nconst redoFlag = computed(() => tableStore.spec.redoHistory.length === 0);\n\n// 撤销操作\nfunction undo() {\n  tableStore.editor.mappingSpec.errorMark = null\n  const lastSpec = tableStore.spec.undoHistory.pop();\n  if (lastSpec !== undefined) {\n    tableStore.spec.redoHistory.push(tableStore.editor.mappingSpec.code);\n    tableStore.editor.mappingSpec.code = lastSpec;\n  }\n}\n\n// 重做操作\nfunction redo() {\n  tableStore.editor.mappingSpec.errorMark = null\n  const lastUndo = tableStore.spec.redoHistory.pop();\n  if (lastUndo !== undefined) {\n    tableStore.spec.undoHistory.push(tableStore.editor.mappingSpec.code);\n    tableStore.editor.mappingSpec.code = lastUndo;\n  }\n}\n\nfunction transformTablebyCode() {\n  loading.value = true;\n  tableStore.transformTablebyCode();\n  loading.value = false;\n}\n\nfunction handleKeydown(event: KeyboardEvent) {\n  if (event.key === 'Escape') {\n    // 按下 ESC 键时清除所有高亮、选中等\n    tableStore.editor.mappingSpec.decorations?.clear();\n    tableStore.input_tbl.instance.deselectCell();\n    tableStore.output_tbl.instance.deselectCell();\n    tableStore.input_tbl.instance.updateSettings({ cell: [] });\n    tableStore.output_tbl.instance.updateSettings({ cell: [] });\n    tableStore.highlightMinimapCells([]);\n\n    tableStore.clearStatus(\"tree\");\n    tableStore.clearStatus(\"matchArea\");\n  }\n}\n\nfunction handleCaseChange(value: string) {\n  tableStore.currentCase = value;\n  isDropdownOpen.value = false;\n}\n\nconst isDropdownOpen = ref(false);\nlet timeHandler: any = null;\nlet dropdownListEle: any = null;\n\nfunction selectEnter(e: any, v: any) {\n  isDropdownOpen.value = true;\n  if (dropdownListEle === null) {\n    setTimeout(() => {\n      dropdownListEle = document.querySelector(\".rc-virtual-list-holder-inner\");\n      dropdownListEle?.addEventListener('mouseenter', () => {\n        if (timeHandler !== null) {\n          clearTimeout(timeHandler);\n          timeHandler = null;\n        }\n        isDropdownOpen.value = true;\n      })\n      dropdownListEle?.addEventListener('mouseleave', () => {\n        isDropdownOpen.value = false;\n      })\n    }, 100)\n  }\n}\n\nfunction selectLeave(e: any, v: any) {\n  timeHandler = setTimeout(() => {\n    isDropdownOpen.value = false;\n  }, 200);\n}\n\nonMounted(() => {\n  document.addEventListener('keydown', handleKeydown);\n  tableStore.loadCaseData(tableStore.currentCase);\n});\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_a_select = _resolveComponent(\"a-select\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_a_button = _resolveComponent(\"a-button\")!\n  const _component_a_button_group = _resolveComponent(\"a-button-group\")!\n  const _component_a_tab_pane = _resolveComponent(\"a-tab-pane\")!\n  const _component_a_tabs = _resolveComponent(\"a-tabs\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _hoisted_3,\n      _createElementVNode(\"span\", _hoisted_4, [\n        _hoisted_5,\n        _createVNode(_component_a_select, {\n          value: currentCase.value,\n          options: caseOption.value,\n          size: \"small\",\n          onChange: handleCaseChange,\n          onMouseenter: selectEnter,\n          onMouseleave: selectLeave,\n          open: isDropdownOpen.value,\n          style: {\"width\":\"124px\"}\n        }, null, 8, [\"value\", \"options\", \"open\"])\n      ]),\n      _createElementVNode(\"span\", _hoisted_6, [\n        _createVNode(_component_a_button_group, null, {\n          default: _withCtx(() => [\n            _createVNode(_component_a_button, {\n              size: \"small\",\n              onClick: undo,\n              disabled: undoFlag.value\n            }, {\n              default: _withCtx(() => [\n                _createVNode(_component_v_icon, {\n                  name: \"io-arrow-undo-outline\",\n                  scale: \"0.9\"\n                }),\n                _hoisted_7\n              ]),\n              _: 1\n            }, 8, [\"disabled\"]),\n            _createVNode(_component_a_button, {\n              size: \"small\",\n              onClick: redo,\n              disabled: redoFlag.value\n            }, {\n              default: _withCtx(() => [\n                _createVNode(_component_v_icon, {\n                  name: \"io-arrow-redo-outline\",\n                  scale: \"0.9\"\n                }),\n                _hoisted_8\n              ]),\n              _: 1\n            }, 8, [\"disabled\"])\n          ]),\n          _: 1\n        })\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_9, [\n      _createElementVNode(\"div\", _hoisted_10, [\n        _createElementVNode(\"div\", _hoisted_11, [\n          _createVNode(InOutTable)\n        ]),\n        _createElementVNode(\"div\", _hoisted_12, [\n          _createVNode(Minimap),\n          _createVNode(PatternVis)\n        ])\n      ]),\n      _createElementVNode(\"div\", _hoisted_13, [\n        _createElementVNode(\"div\", _hoisted_14, [\n          _createElementVNode(\"div\", _hoisted_15, [\n            _hoisted_16,\n            _createElementVNode(\"span\", _hoisted_17, [\n              _createVNode(_component_a_button, {\n                size: \"small\",\n                loading: loading.value,\n                onClick: transformTablebyCode\n              }, {\n                default: _withCtx(() => [\n                  _createVNode(_component_v_icon, {\n                    name: \"la-rocket-solid\",\n                    scale: \"0.85\"\n                  }),\n                  _hoisted_18\n                ]),\n                _: 1\n              }, 8, [\"loading\"])\n            ])\n          ]),\n          _createElementVNode(\"div\", _hoisted_19, [\n            _createVNode(_component_a_tabs, {\n              activeKey: codePanel.value,\n              \"onUpdate:activeKey\": _cache[0] || (_cache[0] = ($event: any) => ((codePanel).value = $event)),\n              type: \"card\"\n            }, {\n              default: _withCtx(() => [\n                _createVNode(_component_a_tab_pane, { key: \"1\" }, {\n                  tab: _withCtx(() => [\n                    _hoisted_20\n                  ]),\n                  default: _withCtx(() => [\n                    _createVNode(CodeView, { codeType: \"mappingSpec\" })\n                  ]),\n                  _: 1\n                }),\n                _createVNode(_component_a_tab_pane, { key: \"2\" }, {\n                  tab: _withCtx(() => [\n                    _hoisted_21\n                  ]),\n                  default: _withCtx(() => [\n                    _createVNode(CodeView, { codeType: \"rootArea\" })\n                  ]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            }, 8, [\"activeKey\"])\n          ])\n        ])\n      ])\n    ]),\n    _createVNode(DraggableModal)\n  ]))\n}\n}\n\n})","<template>\n  <div id=\"panel\">\n    <div class=\"system-name\">\n      <span id=\"system_name\">TableTidier</span>\n      <span style=\"left: 20px; position: absolute;\">\n        <span style=\"font-size: 16px; font-weight: normal; margin-right: 5px\">Cases:</span>\n        <!-- @mouseenter=\"selectEnter\" @mouseleave=\"selectLeave\"  :open=\"isDropdownOpen\" :getPopupContainer=\"(triggerNode: any) => triggerNode.parentNode\" -->\n        <a-select :value=\"currentCase\" :options=\"caseOption\" size=\"small\" @change=\"handleCaseChange\"\n          @mouseenter=\"selectEnter\" @mouseleave=\"selectLeave\" :open=\"isDropdownOpen\" style=\"width: 124px;\"></a-select>\n      </span>\n      <span style=\"right: 20px; position: absolute;\">\n        <a-button-group>\n          <a-button size=\"small\" @click=\"undo\" :disabled=\"undoFlag\">\n            <v-icon name=\"io-arrow-undo-outline\" scale=\"0.9\"></v-icon>\n            <span style=\"margin-left: 5px\">Undo</span>\n          </a-button>\n          <a-button size=\"small\" @click=\"redo\" :disabled=\"redoFlag\">\n            <v-icon name=\"io-arrow-redo-outline\" scale=\"0.9\"></v-icon>\n            <span style=\"margin-left: 5px\">Redo</span>\n          </a-button>\n        </a-button-group>\n      </span>\n    </div>\n    <!-- <ChatBot /> -->\n    <div class=\"main-views\">\n      <div class=\"column\" style=\"flex: 12\">\n        <div style=\"flex: 1; display: flex;\">\n          <InOutTable />\n        </div>\n\n        <div style=\"flex: 1; display: flex;\">\n          <Minimap />\n          <PatternVis />\n        </div>\n      </div>\n\n      <div class=\"column\" style=\"flex: 5;\">\n        <div class=\"view\">\n          <div class=\"view-title\">\n            <span>Code Panel</span>\n            <span style=\"float: right; margin-right: 20px\">\n              <a-button size=\"small\" :loading=\"loading\" @click=\"transformTablebyCode\">\n                <v-icon name=\"la-rocket-solid\" scale=\"0.85\"></v-icon>\n                <span>Run</span>\n              </a-button>\n            </span>\n          </div>\n          <div class=\"view-content\">\n            <a-tabs v-model:activeKey=\"codePanel\" type=\"card\">\n              <a-tab-pane key=\"1\">\n                <template #tab>\n                  <span>\n                    Specification\n                  </span>\n                </template>\n                <CodeView codeType=\"mappingSpec\" />\n              </a-tab-pane>\n              <a-tab-pane key=\"2\">\n                <template #tab>\n                  <span>\n                    Matched Instances\n                  </span>\n                </template>\n                <CodeView codeType=\"rootArea\" />\n              </a-tab-pane>\n              <!-- <a-tab-pane key=\"3\">\n                <template #tab>\n                  <span>\n                    Transformation Script\n                  </span>\n                </template>\n                <CodeView codeType=\"transformScript\" />\n              </a-tab-pane> -->\n            </a-tabs>\n          </div>\n        </div>\n      </div>\n    </div>\n    <DraggableModal />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onMounted, ref } from \"vue\";\n\nimport InOutTable from \"@/components/InOutTable.vue\";\nimport CodeView from \"@/components/CodeView.vue\";\nimport Minimap from \"@/components/Minimap.vue\";\nimport PatternVis from \"@/components/PatternVis.vue\";\nimport DraggableModal from \"@/components/DraggableModal.vue\";\n// import ChatBot from \"@/components/ChatBot.vue\";\n\nimport { typeMapColor, TypeColor } from '@/tree/style';\nfor (const key in typeMapColor) {\n  document.documentElement.style.setProperty(`--color-${key}`, typeMapColor[key as TypeColor]);\n}\ndocument.documentElement.style.setProperty('--custom-cursor', 'default');\n\nimport { useTableStore } from \"@/store/table\";\nconst tableStore = useTableStore();\n\n// let caseOption: Ref<{ value: string; label: string; }[]> = ref([]);\n// let caseOption = ref<{ value: string; label: string }[]>([]);\n\nconst caseOption = computed(() => {\n  return tableStore.caseList.map((v) => {\n    return { value: v, label: v };\n  });\n})\n\nconst currentCase = computed(() => tableStore.currentCase);\n\nconst codePanel = ref(\"1\");\nconst loading = ref<boolean>(false);\n\nconst undoFlag = computed(() => tableStore.spec.undoHistory.length === 0);\nconst redoFlag = computed(() => tableStore.spec.redoHistory.length === 0);\n\n// 撤销操作\nfunction undo() {\n  tableStore.editor.mappingSpec.errorMark = null\n  const lastSpec = tableStore.spec.undoHistory.pop();\n  if (lastSpec !== undefined) {\n    tableStore.spec.redoHistory.push(tableStore.editor.mappingSpec.code);\n    tableStore.editor.mappingSpec.code = lastSpec;\n  }\n}\n\n// 重做操作\nfunction redo() {\n  tableStore.editor.mappingSpec.errorMark = null\n  const lastUndo = tableStore.spec.redoHistory.pop();\n  if (lastUndo !== undefined) {\n    tableStore.spec.undoHistory.push(tableStore.editor.mappingSpec.code);\n    tableStore.editor.mappingSpec.code = lastUndo;\n  }\n}\n\nfunction transformTablebyCode() {\n  loading.value = true;\n  tableStore.transformTablebyCode();\n  loading.value = false;\n}\n\nfunction handleKeydown(event: KeyboardEvent) {\n  if (event.key === 'Escape') {\n    // 按下 ESC 键时清除所有高亮、选中等\n    tableStore.editor.mappingSpec.decorations?.clear();\n    tableStore.input_tbl.instance.deselectCell();\n    tableStore.output_tbl.instance.deselectCell();\n    tableStore.input_tbl.instance.updateSettings({ cell: [] });\n    tableStore.output_tbl.instance.updateSettings({ cell: [] });\n    tableStore.highlightMinimapCells([]);\n\n    tableStore.clearStatus(\"tree\");\n    tableStore.clearStatus(\"matchArea\");\n  }\n}\n\nfunction handleCaseChange(value: string) {\n  tableStore.currentCase = value;\n  isDropdownOpen.value = false;\n}\n\nconst isDropdownOpen = ref(false);\nlet timeHandler: any = null;\nlet dropdownListEle: any = null;\n\nfunction selectEnter(e: any, v: any) {\n  isDropdownOpen.value = true;\n  if (dropdownListEle === null) {\n    setTimeout(() => {\n      dropdownListEle = document.querySelector(\".rc-virtual-list-holder-inner\");\n      dropdownListEle?.addEventListener('mouseenter', () => {\n        if (timeHandler !== null) {\n          clearTimeout(timeHandler);\n          timeHandler = null;\n        }\n        isDropdownOpen.value = true;\n      })\n      dropdownListEle?.addEventListener('mouseleave', () => {\n        isDropdownOpen.value = false;\n      })\n    }, 100)\n  }\n}\n\nfunction selectLeave(e: any, v: any) {\n  timeHandler = setTimeout(() => {\n    isDropdownOpen.value = false;\n  }, 200);\n}\n\nonMounted(() => {\n  document.addEventListener('keydown', handleKeydown);\n  tableStore.loadCaseData(tableStore.currentCase);\n});\n\n</script>\n\n<style lang=\"less\">\n#panel {\n  font-family: \"Arial\", sans-serif;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  height: 100vh;\n  margin: 0;\n  padding: 0;\n  background-color: #f0f0f0;\n  /* Background color for the whole panel */\n}\n\n.system-name {\n  font-size: 23px;\n  font-weight: bold;\n  width: calc(100vw - 50px);\n  margin-top: 3px;\n  //   margin: 20px 0;\n  padding: 10px 16px;\n  background-color: #3498db;\n  /* System name background color */\n  color: white;\n  /* System name text color */\n  //   border-radius: 8px;\n  text-align: center;\n\n  .el-switch__label {\n    color: #fff;\n    // font-size: 30px;\n  }\n\n  .el-switch__label.is-active {\n    color: #7bed9f;\n  }\n}\n\n.main-views {\n  display: flex;\n  justify-content: space-between;\n  width: calc(100vw - 15px);\n  padding: 1px;\n  box-sizing: border-box;\n\n  // 这是用来让图标和文字有一定间距\n  svg.ov-icon+span {\n    margin-left: 5px;\n  }\n\n  .column {\n    height: calc(100vh - 54px);\n  }\n\n  .view {\n    flex: 1;\n\n    // // height: calc(100vh - 80px);\n    .ant-tabs {\n      height: 100%;\n\n      .ant-tabs-content {\n        height: 100%;\n      }\n    }\n  }\n\n}\n\n.column {\n  display: flex;\n  flex-direction: column;\n}\n\n.view {\n  //   margin: 8px 2px 2px 8px;\n  padding: 10px;\n  border: 1px solid #ccc;\n  //   border-radius: 8px;\n  overflow: hidden;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  background-color: #ffffff;\n  /* View background color */\n}\n\n.view-title {\n  font-size: 18px;\n  font-weight: bold;\n  margin-bottom: 10px;\n  color: #2c3e50;\n  overflow: auto;\n  /* View title text color */\n}\n\n.view-content {\n  // overflow-y: auto;\n  overflow: hidden;\n  height: calc(100% - 40px);\n}\n\n.mapping-details {\n  display: flex;\n  flex-direction: column;\n}\n\n\n.ant-message-notice-content {\n  white-space: pre-wrap;\n  /* 使 \\n 换行符生效 */\n  text-align: left;\n  /* 左对齐 */\n  max-width: 700px;\n}\n\n.ant-btn-default {\n  transition: 0s;\n}\n\n.ant-btn-default:hover {\n  svg path {\n    stroke: #4494fc;\n  }\n}\n\n.ant-btn-default:disabled {\n  background-color: #ffffff;\n  border-color: #d9d9d9;\n  box-shadow: 0 2px 0 rgba(0, 0, 0, 0.02);\n  cursor: not-allowed;\n  color: rgba(0, 0, 0, 0.25);\n\n  svg path {\n    stroke: rgba(0, 0, 0, 0.25);\n  }\n}\n</style>\n","import script from \"./PanelView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PanelView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./PanelView.vue?vue&type=style&index=0&id=62919a66&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { render } from \"./App.vue?vue&type=template&id=771c1db7&ts=true\"\nimport script from \"./App.vue?vue&type=script&lang=ts\"\nexport * from \"./App.vue?vue&type=script&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=771c1db7&lang=less\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { createApp } from 'vue'\nimport App from './App.vue'\n\nimport { createPinia } from 'pinia'\n\nconst pinia = createPinia()\nconst app = createApp(App)\n\nimport { Select, Upload, Button, Tabs, Tooltip, Popover, Input, Modal, Space, Dropdown, Menu, Form, Row, Col, Radio, Divider } from \"ant-design-vue\";\n// import 'ant-design-vue/dist/reset.css';\n\napp.use(pinia).use(Select).use(Tabs).use(Button).use(Upload)\n    .use(Tooltip).use(Popover).use(Input).use(Modal).use(Space).use(Dropdown).use(Menu).use(Form).use(Row).use(Col).use(Radio).use(Divider);\n\n// A Vue component for including inline SVG icons from different popular iconpacks easily.\n// https://oh-vue-icons.js.org/docs   // MdFitscreenOutlined\nimport { OhVueIcon, addIcons } from \"oh-vue-icons\";\nimport { BiUpload, BiDownload, LaRocketSolid, BiArrowClockwise, IoArrowUndoOutline, IoArrowRedoOutline } from \"oh-vue-icons/icons\";\n\naddIcons(BiUpload, BiDownload, LaRocketSolid, BiArrowClockwise, IoArrowUndoOutline, IoArrowRedoOutline);\n\n// app.config.globalProperties.$basePath = process.env.BASE_URL;\n\napp.component(\"v-icon\", OhVueIcon);\n\n// import ElementPlus from 'element-plus'\n// app.use(ElementPlus)\n// import { ElButton, ElDropdown, ElSwitch } from 'element-plus'\n// app.use(ElButton).use(ElDropdown).use(ElSwitch)\n\n// import 'element-plus/dist/index.css'\n\napp.mount('#app')","import { defineStore } from 'pinia'\nimport Handsontable from \"handsontable\";\nimport * as d3 from 'd3';\nimport { shallowRef } from 'vue';\n\nimport { Table2D, TableTidierTemplate, TableTidierKeyWords, CellInfo, CellValueType, AreaInfo, CellConstraint, completeCellConstraint } from \"@/grammar/grammar\"\nimport { transformTable, serialize, getCellBySelect } from \"@/grammar/handleSpec\"\nimport { TreeChart, NodeData } from '@/tree/drawTree';\nimport { CustomError } from \"@/types\";\n\nimport { message } from 'ant-design-vue';\n\nimport * as monaco from \"monaco-editor\";\nimport * as ts from \"typescript\";\nimport { typeMapColor, TypeColor } from '@/tree/style';\n// import { colorConfig } from '@/tree/style';\n// import { cloneDeep } from 'lodash';\n\nfunction replaceEvenSpaces(str: string) {\n  // 使用正则表达式匹配连续的空格\n  return str.replace(/ {2,}/g, (match) => {\n    // 获取连续空格的数量\n    const length = match.length;\n\n    // 计算一半的空格数量\n    const halfLength = length / 2;\n\n    // 返回一半数量的空格\n    return ' '.repeat(halfLength);\n  });\n}\n\n// 去除所有空格\nfunction removeWhitespace(str: string) {\n  return str.replace(/ /g, '') // .replace(/\\s+/g, '');  这个会把换行符也去掉\n}\n\nfunction csvToMatrix(csvText: string) {\n  // 首先将文本按行分割\n  const rows = csvText.trim().split('\\n');\n\n  // 然后将每行按逗号分割成数组\n  const matrix: Table2D = rows.map(row => row.split(','));\n\n  return matrix;\n}\n\nconst removeSpaceType = {\n  even: replaceEvenSpaces,\n  all: removeWhitespace,\n}\n\nexport interface TblCell {\n  row: number;\n  col: number;\n  className?: string;\n}\n\nexport interface TblPatternGrid {\n  row: number;\n  col: number;\n  text?: any; // string\n  textColor?: string;\n  bgColor?: string;\n}\n\n/** startRow, startCol, endRow, endCol */\nexport type Selection = [number, number, number, number];\n\ninterface TreeNode {\n  [key: string]: any,\n  children?: TreeNode[];\n}\n\nexport interface AreaBox {\n  width: number,\n  height: number,\n  x: number,\n  y: number,\n}\n\n// type CoordinateMap = Map<number, Map<number, any>>;  // 根据坐标获取某值\n\nexport interface VisTreeNode extends TableTidierTemplate, AreaBox {\n  id?: number,\n  type?: \"position\" | \"value\" | \"context\" | \"null\",\n  path?: number[],\n  matchs?: AreaBox[],\n  // currentAreas?: AreaInfo[],\n  constrsInfo?: { x: number, y: number }[][],\n  children?: VisTreeNode[]\n}\n\nexport interface AreaForm {\n  referenceAreaLayer: any,\n  referenceAreaPosi: any,\n  position: {\n    x: any,\n    y: any\n  },\n  traverse: {\n    xDirection: any,\n    yDirection: any\n  },\n  size: {\n    width: any,\n    height: any\n  }\n}\n\n// define and expose a store\nexport const useTableStore = defineStore('table', {\n  // data\n  state() {\n    return {\n      specMode: false,\n      caseList: [\"1. university\", \"2. university2\", \"3. model\", \"4. phone\", \"5. bank\", \"6. payroll\", \"7. York\"],\n      currentCase: \"1. university\", // caseList[0],\n      spec: {\n        undoHistory: [] as string[],  // 这里不能是 shallowRef，要不然 computed 计算不会被更新\n        redoHistory: [] as string[],\n        rawSpecs: shallowRef<TableTidierTemplate[]>([]),\n        visTree: shallowRef<VisTreeNode>({ id: 0, width: 0, height: 0, x: 0, y: 0, type: \"null\", path: [], children: [] }),\n        visTreeMatchPath: shallowRef<{ [key: string]: VisTreeNode }>({}),\n        selectNode: shallowRef<NodeData>({} as NodeData),\n        selectConstrIndex: -1,\n        constrNodeRectClickId: \"\",\n        selectAreaFromNode: \"\" as \"\" | \"0\" | \"1\" | \"2-0\" | \"2-1\" | \"2-2\" | \"3\" | \"4\",\n        selectAreaFromLegend: shallowRef<TypeColor[]>([]),\n        selectionsAreaFromLegend: shallowRef<Selection[]>([]),\n        selectionsPath: shallowRef<number[][]>([]),  // 每一个selection在rawSpecs中对应的path\n        dragConfigOpen: false,\n        areaConfig: shallowRef<TableTidierTemplate>({\n          match: {\n            startCell: {},\n            size: {},\n            traverse: {},\n            constraints: [],\n          },\n          extract: null,\n          fill: '',\n          children: [],\n        }),\n        areaFormData: shallowRef<AreaForm>({\n          referenceAreaLayer: null,\n          referenceAreaPosi: null,\n          position: {\n            x: null,\n            y: null\n          },\n          traverse: {\n            xDirection: null,\n            yDirection: null\n          },\n          size: {\n            width: null,\n            height: null\n          }\n        }),\n      },\n      editor: {\n        mappingSpec: {\n          code: '',\n          codePref: 'const option: TableTidierTemplate[] = ',\n          codeSuff: '\\nreturn option;',\n          errorMark: null as monaco.editor.IMarker | null,\n          decorations: shallowRef<monaco.editor.IEditorDecorationsCollection | null>(null),\n          highlightCode: null as [number, number, string] | null,  // [startLine, endLine, color]\n          language: 'typescript',\n          instance: shallowRef<monaco.editor.IStandaloneCodeEditor | null>(null)\n        },\n        rootArea: {\n          code: '',\n          // codePref: 'const rootArea: AreaInfo = ',\n          object: shallowRef<AreaInfo | null>(null),\n          language: 'json',\n          instance: shallowRef<monaco.editor.IStandaloneCodeEditor | null>(null)\n        },\n        // transformScript: {\n        //   code: '',\n        //   language: 'python',\n        //   instance: shallowRef<monaco.editor.IStandaloneCodeEditor | null>(null)\n        // }\n      },\n      input_tbl: {\n        instance: {} as Handsontable,\n        // cells: [] as [number, number][],  // highlighted cells\n        tbl: shallowRef<Table2D>([]),\n        in2out: shallowRef<{ [key: string]: string[] }>({}),\n        in2nodes: shallowRef<{ [key: string]: Set<number> }>({}),  // 'x-y-width-height' -> {node.id} 的映射\n      },\n      output_tbl: {\n        instance: {} as Handsontable,\n        // cells: [] as [number, number][], // highlighted cells\n        tbl: shallowRef<Table2D>([]),\n        cols: shallowRef<string[]>([]),\n        out2in: shallowRef<{ [key: string]: string[] }>({}),\n      },\n      tree: {\n        contextMenuVisible: false,\n        visInst: shallowRef<TreeChart | null>(null),\n        tblVisHighlight: null as d3.Selection<SVGGElement, unknown, null, undefined> | null,\n        tblVisInfo: shallowRef<AreaBox | null>(null),  // tblTemplate中起始单元格在input tbl中的坐标位置(x, y)，以及单元格的宽高(width, height)\n        menuAllList: [{\n          key: \"0\",\n          label: \"Reset Area\",\n          title: \"Reset Area\",\n          // icon: () => h(MailOutlined),\n        }, {\n          key: \"1\",\n          label: \"Add Constraint\",\n          title: \"Add Constraint\",\n          // icon: () => h(MailOutlined),\n          // disabled: true\n        }, {\n          key: \"2\",\n          label: \"Set Target Cols\",\n          title: \"Set Target Cols\",\n          children: [{\n            key: \"2-0\",\n            label: \"Position\",\n            title: \"Match and Extract by Position\",\n            // class: \"legend-position\",\n            style: { color: typeMapColor['position'] },  // 使用 style 设置样式\n          }, {\n            key: \"2-1\",\n            label: \"Context\",\n            title: \"Match and Extract by Context\",\n            style: { color: typeMapColor['context'] },\n          }, {\n            key: \"2-2\",\n            label: \"Value\",\n            title: \"Match and Extract by Value\",\n            style: { color: typeMapColor['value'] },\n          }, {\n            key: \"2-3\",\n            label: \"No Extraction\",\n            title: \"Match without Extraction\",\n            style: { color: typeMapColor['null'] },\n          }],\n        }, {\n          key: \"3\",\n          label: \"Add Sub-Template\",\n          title: \"Add Sub-Template\",\n          // disabled: true\n          // icon: () => h(MailOutlined),\n        }, {\n          key: \"4\",\n          label: \"Delete Template\",\n          title: \"Delete Template\",\n          // disabled: true\n          // icon: () => h(MailOutlined),\n        }, {\n          key: \"5\",\n          label: \"Delete Constraint\",\n          title: \"Delete Constraint\",\n        }],\n        menuList: [] as Array<{ [key: string]: any }>,\n      }\n    }\n  },\n  // methods\n  actions: {\n    async loadCaseData(caseN: string) {\n      let prompt: string[] = [];\n      let case_path = `./${caseN}/`;\n      // const begin = Date.now();\n      try {\n        // Parallel processing of all fetch requests ==> faster: 0.678s vs 0.275s\n        const [data_res, spec_res] = await Promise.all([   // , script_res\n          fetch(case_path + 'data.csv'),  // 'data.json'\n          fetch(case_path + 'spec.js'),\n          // fetch(case_path + 'script.py')\n        ]);\n\n        // Parallel processing of all text extraction\n        const [dataText, specText] = await Promise.all([    // , scriptText\n          data_res.ok ? data_res.text() : Promise.resolve(null),\n          spec_res.ok ? spec_res.text() : Promise.resolve(null),\n          // script_res.ok ? script_res.text() : Promise.resolve(null)\n        ]);\n\n        this.initTblInfo();\n        this.clearStatus(\"matchArea\");\n        this.editor.mappingSpec.errorMark = null;\n\n        if (dataText !== null) {\n          this.input_tbl.tbl = csvToMatrix(dataText) // JSON.parse(dataText).input_tbl;\n          this.input_tbl.instance.updateData(this.input_tbl.tbl);\n          // 每次都是页面刷新后，所有单元格/列的宽度为50，只有点击一下界面之后，才会突然自动列大小，变成有的列width大一点，有的列width小一点，这是为什么呢\n          // 通常是由于Handsontable在初始化时还没有正确计算出表格容器的尺寸，或者在Vue组件生命周期的某个阶段，Handsontable的重新渲染没有正确触发。这个问题可能与表格渲染的时机有关。\n          this.input_tbl.instance.render();\n          // document.getElementById('system_name')?.click();\n          this.transformTblUpdateRootArea()\n        } else {\n          prompt.push(`Failed to load data from ${caseN}`);\n        }\n\n        if (specText !== null) {\n          this.spec.undoHistory = [];\n          this.spec.redoHistory = [];\n          this.editor.mappingSpec.code = specText;\n        } else {\n          prompt.push(`Failed to load spec from ${caseN}`);\n        }\n\n        // if (scriptText !== null) {\n        //   this.editor.transformScript.code = scriptText;\n        // } else {\n        //   prompt.push(`Failed to load script from ${caseN}`);\n        // }\n      } catch (error) {\n        prompt.push(`Error loading data: ${error}`);\n      }\n      // const end = Date.now();\n      // console.log(`Loaded case ${caseN} in seconds: ${(end - begin) / 1000}`);\n      this.currentCase = caseN;\n      prompt.forEach((msg) => {\n        message.error(msg);\n      })\n    },\n\n    /**\n     * Update visTree's matchs\n     */\n    traverseTree4UpdateMatchs(nodes: AreaInfo[]) {\n      let visNode: VisTreeNode | null = null;\n      nodes.forEach((node) => {\n        const path = node.templateRef.toString()\n        if (!this.spec.visTreeMatchPath.hasOwnProperty(path)) {\n          visNode = this.getNodebyPath(this.spec.visTree.children!, node.templateRef) as VisTreeNode;\n          if (visNode === null) return;\n          this.spec.visTreeMatchPath[path] = visNode;\n          visNode.matchs = [{\n            x: node.x,\n            y: node.y,\n            width: node.width,\n            height: node.height\n          }];\n          // visNode.currentAreas = [node];\n          visNode.constrsInfo = [];\n          visNode.match?.constraints?.forEach((constraint) => {\n            const cellInfoSelections = [];\n            const allConstr = completeCellConstraint(constraint);\n            const cellInfo = getCellBySelect(allConstr, node, this.editor.rootArea.object!, true);\n            if (cellInfo) {\n              cellInfoSelections.push({ x: cellInfo.x, y: cellInfo.y });\n            }\n            visNode!.constrsInfo!.push(cellInfoSelections);\n          })\n        } else {\n          this.spec.visTreeMatchPath[path].matchs!.push({\n            x: node.x,\n            y: node.y,\n            width: node.width,\n            height: node.height\n          });\n          // this.spec.visTreeMatchPath[path].currentAreas!.push(node);\n          visNode = this.spec.visTreeMatchPath[path];\n          visNode.match?.constraints?.forEach((constraint, ci) => {\n            const cellInfoSelections = visNode!.constrsInfo![ci];\n            const allConstr = completeCellConstraint(constraint);\n            const cellInfo = getCellBySelect(allConstr, node, this.editor.rootArea.object!, true);\n            if (cellInfo) {\n              cellInfoSelections.push({ x: cellInfo.x, y: cellInfo.y });\n            }\n          })\n        }\n        this.traverseTree4UpdateMatchs(node.children)\n      })\n    },\n\n    traverseTree4UpdateIn2Nodes(nodes: VisTreeNode[], parentPath: number[] = [], idCounter: [number] = [1]) {\n      const in2nodes = this.input_tbl.in2nodes;\n      nodes.forEach((node, index) => {\n        node.id = idCounter[0]++;\n        // 构建当前节点的 path\n        const currentPath = [...parentPath, index];\n        node.path = currentPath;\n\n        const areaKey = `${node.x}-${node.y}-${node.width}-${node.height}`;\n\n        // 给每个node赋予type，并计算selectionsAreaFromLegend和selectAreaFromLegend\n        if (node.extract === undefined || node.extract === null) {\n          node.type = \"null\";\n        } else {\n          if (node.extract.byPositionToTargetCols !== undefined) {\n            node.type = \"position\";\n          } else if (node.extract.byContext !== undefined) {\n            node.type = \"context\";\n          } else if (node.extract.byValue !== undefined) {\n            node.type = \"value\";\n          } else {\n            node.type = \"null\";\n          }\n        }\n        this.spec.selectionsAreaFromLegend.push([node.y, node.x, node.y + node.height - 1, node.x + node.width - 1]);\n        this.spec.selectAreaFromLegend.push(node.type)\n        this.spec.selectionsPath.push(node.path);\n\n        if (in2nodes.hasOwnProperty(areaKey)) {\n          in2nodes[areaKey].add(node.id!);\n        } else {\n          in2nodes[areaKey] = new Set([node.id!]);\n        }\n        node.matchs?.forEach((match) => {\n          const { x, y, width, height } = match;\n          const areaKey = `${x}-${y}-${width}-${height}`;\n          if (in2nodes.hasOwnProperty(areaKey)) {\n            in2nodes[areaKey].add(node.id!);\n          } else {\n            in2nodes[areaKey] = new Set([node.id!]);\n          }\n        })\n        if (node.children) this.traverseTree4UpdateIn2Nodes(node.children, currentPath, idCounter);\n      })\n    },\n\n    transformTblUpdateRootArea(specs: TableTidierTemplate[] = []) {\n      const { rootArea, tidyData } = transformTable(this.input_tbl.tbl, specs);\n      // this.editor.rootArea.codePref + JSON.stringify(rootArea)\n      this.editor.rootArea.object = rootArea;\n      this.editor.rootArea.code = serialize(rootArea);\n      // this.editor.rootArea.instance!.setValue(this.editor.rootArea.code);\n      this.traverseTree4UpdateMatchs(rootArea.children);\n      this.input_tbl.in2nodes = {};\n      this.spec.selectAreaFromLegend = []\n      this.spec.selectionsAreaFromLegend = []\n      this.spec.selectionsPath = []\n      this.traverseTree4UpdateIn2Nodes(this.spec.visTree.children!);\n      return tidyData;\n    },\n\n    generateHighlightCells(selected: Selection[], classNames: string[] = []): TblCell[] {\n      const cells: TblCell[] = [];\n      if (classNames.length === 0) {\n        classNames = Array(selected.length).fill(\"null\");\n      }\n      selected.forEach((range, ri) => {\n        for (let row = range[0]; row <= range[2]; row++) {\n          for (let col = range[1]; col <= range[3]; col++) {\n            cells.push({ row, col, className: classNames[ri] });\n          }\n        }\n      });\n      return cells;\n    },\n\n    highlightTblCells(tbl: \"input_tbl\" | \"output_tbl\", cells: TblCell[], coords: [number, number][] | null = null) {\n      this[tbl].instance.updateSettings({ cell: cells });\n      if (coords === null) {\n        coords = cells!.map((c) => [c.row, c.col] as [number, number]);\n      }\n      if (coords.length) {\n        let { topLeft, rowSize, colSize } = this.startPoint(coords);\n        // 滚动到中间位置\n        const visibleRows = this[tbl].instance.countVisibleRows();\n        const visibleCols = this[tbl].instance.countVisibleCols();\n        this[tbl].instance.scrollViewportTo({\n          row: rowSize === 1 ? Math.max(0, topLeft[0] - Math.floor(visibleRows / 2)) : Math.max(0, topLeft[0] - 2),\n          col: colSize === 1 ? Math.max(0, topLeft[1] - Math.floor(visibleCols / 2)) : Math.max(0, topLeft[1] - 1),\n          verticalSnap: \"top\",\n          horizontalSnap: \"start\",\n        });\n      }\n    },\n\n    highlightMinimapCells(cells: TblCell[], clear = true) {\n      if (clear) d3.selectAll('g.matrix rect.grid-cell').attr('class', 'grid-cell');\n      cells.forEach((cell) => {\n        if (cell.className) {\n          d3.select(`g.matrix #grid-${cell.row}-${cell.col}`).raise()\n            .classed(cell.className, true)\n        }\n      });\n    },\n\n    in_out_mapping(selectedCoords: { [key: string]: [number, number][] }, type: \"input_tbl\" | \"output_tbl\", className: string = \"selection\") {\n      const posi_mapping = type === \"input_tbl\" ? this.input_tbl.in2out : this.output_tbl.out2in;\n      if (Object.keys(posi_mapping).length === 0) {\n        return [];\n      }\n      let cells: TblCell[] = [];\n      let posi: string[] = [];\n      for (let range in selectedCoords) {\n        selectedCoords[range].forEach((pi) => {\n          posi = posi.concat(posi_mapping[`[${pi[0]},${pi[1]}]`]);\n        });\n      }\n      // console.log(posi, posi_mapping);\n      if (posi) {\n        posi.forEach((pi) => {\n          if (pi && pi.startsWith(\"[\") && pi.endsWith(\"]\")) {\n            let pi_n = JSON.parse(pi) as [number, number];\n            cells.push({ row: pi_n[0], col: pi_n[1], className });\n          }\n        });\n      }\n      return cells;\n    },\n\n    doRectanglesIntersect(rect1: AreaBox, rect2: AreaBox): boolean {\n      return (\n        rect1.x < rect2.x + rect2.width &&\n        rect1.x + rect1.width > rect2.x &&\n        rect1.y < rect2.y + rect2.height &&\n        rect1.y + rect1.height > rect2.y\n      );\n    },\n\n    // 判断区域 A 是否包含区域 B\n    isRectanglesContained(parent: Selection, child: Selection): boolean {\n      const [pStartRow, pStartCol, pEndRow, pEndCol] = parent;\n      const [cStartRow, cStartCol, cEndRow, cEndCol] = child;\n\n      return (\n        pStartRow <= cStartRow &&\n        pStartCol <= cStartCol &&\n        pEndRow >= cEndRow &&\n        pEndCol >= cEndCol\n      );\n    },\n\n    findMaxCNumber(arr: any[] | null = null) {\n      if (arr === null) arr = this.output_tbl.cols;\n\n      let maxNumber = 0;\n\n      arr.forEach(ele => {\n        // 使用正则表达式匹配以 \"C\" 开头并以数字结尾的字符串\n        if (typeof ele !== 'string') return;\n        const match = ele.match(/^C(\\d+)$/);\n        if (match) {\n          const number = parseInt(match[1], 10);\n          if (number > maxNumber) {\n            maxNumber = number;\n          }\n        }\n      });\n\n      // 如果未找到匹配的字符串，返回 null 或 -1 等\n      return maxNumber;\n    },\n\n    buildTree(selections: Selection[], types: string[], paths: number[][]) {\n      const rootNodes: TreeNode[] = [];\n\n      const insertNode = (parent: TreeNode, child: TreeNode): boolean => {\n        if (!parent.children) {\n          parent.children = [];\n        }\n        // 检查子节点是否已经包含了当前节点\n        for (const existingChild of parent.children) {\n          if (this.isRectanglesContained(existingChild.selection, child.selection)) {\n            return insertNode(existingChild, child);\n          }\n        }\n        // 如果没有包含的子节点，将其添加为直接子节点\n        parent.children.push(child);\n        return true;\n      }\n\n      for (let i = 0; i < selections.length; i++) {\n        const selection = selections[i];\n        const newNode: TreeNode = { type: types[i], selection, path: paths[i] };\n\n        let added = false;\n        for (const rootNode of rootNodes) {\n          if (this.isRectanglesContained(rootNode.selection, selection)) {\n            added = insertNode(rootNode, newNode);\n            break;\n          }\n        }\n\n        if (!added) {\n          rootNodes.push(newNode);\n        }\n      }\n      const specs: TableTidierTemplate[] = [];\n      this.traverseTree4buildSpecs(rootNodes, specs, [0, 0, this.input_tbl.tbl.length - 1, this.input_tbl.tbl[0].length - 1]);\n      return { rootNodes, specs };\n    },\n\n    traverseTree4buildSpecs(nodes: TreeNode[], specs: TableTidierTemplate[], pSelection: Selection) {\n      const px = pSelection[1], py = pSelection[0];\n      const pw = pSelection[3] - px + 1, ph = pSelection[2] - py + 1;\n      nodes.forEach((node) => {\n\n        const newSpec: TableTidierTemplate = {};\n        const { selection, type } = node;\n\n        if (node.path.length > 0) {\n          const targetNode = this.getNodebyPath(this.spec.rawSpecs, node.path);\n          this.copyAttributes(targetNode!, newSpec, ['match', 'extract', 'fill']);\n        } else {\n\n          const [startRow, startCol, endRow, endCol] = selection;\n          const width = endCol - startCol + 1;\n          const height = endRow - startRow + 1;\n          const traverse = {\n            xDirection: pw >= 2 * width ? 'after' as const : undefined,\n            yDirection: ph >= 2 * height ? 'after' as const : undefined\n          }\n          if (nodes.length > 1) {\n            traverse.xDirection = undefined;\n            traverse.yDirection = undefined;\n          }\n          newSpec.match = {\n            startCell: { xOffset: startCol - px, yOffset: startRow - py },\n            size: { width, height },\n            traverse\n          }\n\n          const maxCNum = this.findMaxCNumber() + 1;\n\n          switch (type) {\n            case \"position\":\n              newSpec.extract = {\n                // byPositionToTargetCols: Array.from({ length: width * height }, (_, _i) => `C${++colCount}`)\n                byPositionToTargetCols: Array.from({ length: width * height }, (_, i) => `C${maxCNum + i}`)\n              }\n              break;\n            case \"context\":\n              newSpec.extract = {\n                byContext: {\n                  position: 'above'\n                }\n              }\n              break;\n            case \"value\":\n              const createExtract = () => {\n                return eval(`currentAreaTbl => {\n                  // Please replace the default code with the necessary implementation to complete the function.\n                  return currentAreaTbl.flat().map((cell, i) => 'C' + (${maxCNum} + i))\n                  }`)\n              }\n              newSpec.extract = {\n                byValue: createExtract()\n              }\n              break;\n            // case \"null\": \n            // default:\n            //   break;\n          }\n        }\n\n        if (node.children) {\n          newSpec.children = [];\n          this.traverseTree4buildSpecs(node.children, newSpec.children, selection)\n        }\n        specs.push(newSpec);\n      })\n    },\n\n\n\n    highlightNodes(selected: Selection[]) {\n      const highlightNodesId: Set<number> = new Set();\n      selected.forEach(range => {\n        const y = range[0];\n        const x = range[1];\n        const height = range[2] - range[0] + 1;\n        const width = range[3] - range[1] + 1;\n\n        const rect1: AreaBox = { x, y, width, height };\n\n        for (let keyArea in this.input_tbl.in2nodes) {\n          const [x, y, width, height] = keyArea.split('-').map((n) => Number(n));\n          // console.log(rect1, keyArea, this.doRectanglesIntersect(rect1, { x, y, width, height }));\n          if (this.doRectanglesIntersect(rect1, { x, y, width, height })) {\n            this.input_tbl.in2nodes[keyArea].forEach((id) => {\n              highlightNodesId.add(id);\n            })\n          }\n        }\n      });\n      d3.selectAll('.type-node').classed('selection', false);\n      for (let id of highlightNodesId) {\n        // console.log(`.type-node.node-rect-${id}`);\n        d3.select(`.type-node.node-rect-${id}`).classed(\"selection\", true);\n      }\n      return highlightNodesId;\n    },\n\n    highlightTblTemplate(area: AreaBox) {\n      const highlight = this.tree.tblVisHighlight!;  // .tbl-container .tbl-template-highlight\n      const tblVisInfo = this.tree.tblVisInfo!;\n      highlight.raise().append('rect')\n        .attr('x', (area.x - tblVisInfo.x) * tblVisInfo.width)\n        .attr('y', (area.y - tblVisInfo.y) * tblVisInfo.height)\n        .attr('width', area.width * tblVisInfo.width)\n        .attr('height', area.height * tblVisInfo.height)\n        .attr('fill', 'none')\n        .attr('stroke', typeMapColor.selection)\n        .attr('stroke-width', 3);\n    },\n\n    /*\n    highlightNodes(selected: Selection[]) {\n      const highlightNodesId: Set<number> = new Set();\n      selected.forEach(range => {\n        let startRow = range[0] < 0 ? 0 : range[0];\n        let startCol = range[1] < 0 ? 0 : range[1];\n        let endRow = range[2];\n        let endCol = range[3];\n    \n        // 遍历行\n        for (let row = startRow; row <= endRow; row++) {\n          // 遍历列\n          for (let col = startCol; col <= endCol; col++) {\n            // 遍历 visTree\n            const nodes = JSON.parse(JSON.stringify(this.spec.visTree.children!));\n            while (nodes.length) {\n              const node = nodes.shift()\n              if (!node) continue;\n              console.log(row, col, node.y, node.height, node.x, node.width);\n              if (row >= node.y && row < node.y + node.height && col >= node.x && col < node.x + node.width) {\n                highlightNodesId.add(node.id);\n              }\n              if (node.children) nodes.push(...node.children);\n            }\n          }\n        }\n      })\n      d3.selectAll('.type-node').classed('selection', false);\n      for (let id of highlightNodesId) {\n        console.log(`.type-node.node-rect-${id}`);\n        d3.select(`.type-node.node-rect-${id}`).classed(\"selection\", true);\n      }\n    },\n    */\n\n    getHightlightedCells(selected: Selection[], className: string = \"selection\") {\n      let selectedCoords: { [key: string]: [number, number][] } = {};\n      let hightedCells: { row: number, col: number, className: string }[] = [];\n      // 遍历选定区域\n      selected.forEach(range => {\n        const startRow = range[0];\n        const startCol = range[1];\n        const endRow = range[2];\n        const endCol = range[3];\n\n        selectedCoords[range.toString()] = [];\n        // 遍历行\n        for (let row = startRow; row <= endRow; row++) {\n          // 遍历列\n          for (let col = startCol; col <= endCol; col++) {\n            // 将坐标添加到数组中\n            selectedCoords[range.toString()].push([row, col]);\n            hightedCells.push({ row, col, className });\n          }\n        }\n      });\n      return { selectedCoords, hightedCells };\n    },\n\n    grid_cell_click(cell: TblCell, className: string = \"selection\") {\n      let cells: TblCell[] = [{ ...cell, className }];\n      this.highlightTblCells(\"input_tbl\", cells);\n      let outTblCells = this.in_out_mapping({ \"0\": [[cell.row, cell.col]] }, \"input_tbl\", className);\n      this.highlightTblCells(\"output_tbl\", outTblCells);\n    },\n\n    startPoint(points: [number, number][]) {\n      let topLeft = points[0];\n      const rows = new Set([topLeft[0]]);\n      const cols = new Set([topLeft[1]]);\n\n      for (let i = 1; i < points.length; i++) {\n        let current = points[i];\n        rows.add(current[0]);\n        cols.add(current[1]);\n        if (\n          current[0] < topLeft[0] ||\n          (current[0] === topLeft[0] && current[1] < topLeft[1])\n        ) {\n          topLeft = current;\n        }\n      }\n\n      return {\n        topLeft,\n        rowSize: rows.size,\n        colSize: cols.size,\n      };\n    },\n\n    prepareDataAfterCodeChange() {\n      try {\n        // Step 1: update specs, including rawSpecs and visTree\n        // let code = this.editor.mappingSpec.instance!.getValue();\n        let code = this.editor.mappingSpec.code;\n        if (code.trim() === \"\") return false;\n        code += this.editor.mappingSpec.codeSuff;\n        const result = ts.transpileModule(code, {\n          compilerOptions: {\n            target: ts.ScriptTarget.ES2015,\n            module: ts.ModuleKind.CommonJS\n          }\n        })\n        // console.log(result.outputText);\n        // const specification: TableTidierTemplate = eval(code);\n        const evalFunction = new Function('TableTidierKeyWords', result.outputText);\n        const specs: TableTidierTemplate[] = evalFunction(TableTidierKeyWords);\n        this.spec.rawSpecs = specs;\n        this.spec.visTree.children = JSON.parse(JSON.stringify(specs, (key, value) => typeof value === 'function' ? 'function' : value)); // cloneDeep(specs);\n        // this.spec.visTree.children!.forEach((spec) => {\n        //   if (!spec.hasOwnProperty('children')) {\n        //     spec.children = [];\n        //   }\n        // })\n\n\n        // Step 2: update visTree's AreaBox properties\n        if (this.editor.mappingSpec.highlightCode) {\n          this.highlightCode(...this.editor.mappingSpec.highlightCode);\n          this.editor.mappingSpec.highlightCode = null;\n        }\n\n        const { rootArea } = transformTable(this.input_tbl.tbl, this.spec.rawSpecs, false);\n        // console.log(rootArea, this.spec.visTree, this.spec.rawSpecs, this.input_tbl.tbl[0]);\n        this.copyTreeAttributes(rootArea, this.spec.visTree);\n        // console.log(rootArea, this.spec.visTree);\n\n        // Step 3: update in2nodes\n        this.input_tbl.in2nodes = {};\n        this.spec.selectAreaFromLegend = []\n        this.spec.selectionsAreaFromLegend = []\n        this.spec.selectionsPath = []\n        this.traverseTree4UpdateIn2Nodes(this.spec.visTree.children!);\n        return true\n      }\n      catch (e) {\n        message.error(`Failed to parse the specification:\\n ${e}`);\n        console.error(e);\n        return false\n      }\n    },\n\n    numberToOrdinal(num: number) {\n      let suffix = \"th\";\n\n      if (num % 100 >= 11 && num % 100 <= 13) {\n        suffix = \"th\";\n      } else {\n        switch (num % 10) {\n          case 1:\n            suffix = \"st\";\n            break;\n          case 2:\n            suffix = \"nd\";\n            break;\n          case 3:\n            suffix = \"rd\";\n            break;\n        }\n      }\n\n      return num + suffix;\n    },\n\n    checkGrammarError() {\n      const markers = monaco.editor.getModelMarkers({});\n      if (markers.length > 0) {\n        markers.forEach((marker) => {\n          if (marker.code != \"6133\") {\n            // \"‘<name>’ is declared but its value is never read\" 错误不会被提示\n            this.editor.mappingSpec.errorMark = marker;\n            return\n          }\n        })\n      } else {\n        this.editor.mappingSpec.errorMark = null\n      }\n    },\n\n    transformTablebyCode() {\n      if (this.editor.mappingSpec.errorMark !== null) {\n        const marker = this.editor.mappingSpec.errorMark;\n        message.error(`Invalid syntax at Line ${marker.startLineNumber}, Column ${marker.startColumn}:\\n ${marker.message}`);\n        return;\n      }\n      let messageContent = ''\n      try {\n        const specs = this.spec.rawSpecs;\n        // this.stringifySpec(); // 更新(格式化) editor.mappingSpec.code\n        this.spec.visTreeMatchPath = {};\n        const tidyData = this.transformTblUpdateRootArea(specs);\n        this.initTblInfo(false);\n        // this.tree.visInst?.render();\n\n        this.spec.visTree.children?.forEach((spec, index) => {\n          if (index) messageContent += '\\n'\n          if (spec.matchs) {\n            if (spec.matchs.length > 1) {\n              messageContent += `For the ${this.numberToOrdinal(index + 1)} template, ${spec.matchs.length} instances are matched.`\n            } else if (spec.matchs.length === 1) {\n              messageContent += `For the ${this.numberToOrdinal(index + 1)} template, only one instance is matched.`\n            } else {\n              messageContent += `For the ${this.numberToOrdinal(index + 1)} template, no instance is matched.`\n            }\n          }\n        })\n\n        if (Object.keys(tidyData).length === 0) {\n          if (messageContent) messageContent += '\\n';\n          messageContent += 'The output table is empty based on the specification.';\n          // return;\n        }\n        message.info(messageContent)\n\n        // 将tidyData转换为output_tbl.tbl，注意数据格式\n        this.derivePosiMapping(tidyData);\n        // console.log(this.output_tbl.tbl, this.output_tbl.cols);\n        this.output_tbl.instance.updateData(this.output_tbl.tbl);\n        this.output_tbl.instance.updateSettings({ colHeaders: this.output_tbl.cols });\n        // this.output_tbl.instance.render();\n      } catch (e) {\n        if (e instanceof CustomError) {\n          messageContent = `Failed to transform the table based on the specification:\\n ${e}`\n        } else {\n          messageContent = `Failed to parse the specification:\\n ${e}`\n        }\n        message.error(messageContent);\n        console.error(e);\n      }\n    },\n\n    derivePosiMapping(outTbl: { [key: string]: CellInfo[] }) {\n      const cols = Object.keys(outTbl);\n      this.output_tbl.cols = cols;\n      // const numRows = outTbl[cols[0]].length;\n      const numRows = Math.max(...cols.map(col => outTbl[col].length));\n\n      // Create the in_out mapping\n      for (let i = 0; i < numRows; i++) {\n        const row: CellValueType[] = [];\n        // this.output_tbl.out2in.rows.push([]);\n        for (let j = 0; j < cols.length; j++) {\n          const col = cols[j];\n          let cell: CellInfo;\n          if (outTbl[col].length <= i) {\n            cell = { x: -1, y: -1, value: undefined };\n          } else {\n            cell = outTbl[col][i];\n          }\n          row.push(cell.value);\n          let inPosi = `[${cell.y},${cell.x}]`;\n          const outPosi = `[${i},${j}]`;\n          // console.log(inPosi, outPosi);\n          if (cell.x < 0 || cell.y < 0) {\n            inPosi = '';\n          } else {\n            if (this.input_tbl.in2out.hasOwnProperty(inPosi)) {\n              this.input_tbl.in2out[inPosi].push(outPosi);\n            } else {\n              this.input_tbl.in2out[inPosi] = [outPosi];\n            }\n          }\n\n          if (this.output_tbl.out2in.hasOwnProperty(outPosi)) {\n            this.output_tbl.out2in[outPosi].push(inPosi);\n          } else {\n            this.output_tbl.out2in[outPosi] = [inPosi];\n          }\n        }\n        this.output_tbl.tbl.push(row);\n      }\n    },\n\n    generateGrid(rows: number, cols: number): TblPatternGrid[] {\n      const grid: TblPatternGrid[] = [];\n      for (let i = 0; i < rows; i++) {\n        for (let j = 0; j < cols; j++) {\n          grid.push({ row: i, col: j });\n        }\n      }\n      return grid;\n    },\n\n    computeTblPatternGrid() {\n      // const firstNode: VisTreeNode = JSON.parse(JSON.stringify(this.spec.visTree.children![0], function (key, value) {\n      //   if (key === 'currentAreas') return undefined;\n      //   return value;\n      // }));\n      const firstNode: VisTreeNode = JSON.parse(JSON.stringify(this.spec.visTree.children![0]));\n      const grids = this.generateGrid(firstNode.height, firstNode.width);\n      const nodes = [firstNode];\n      // const box: AreaBox = { width: firstNode.width, height: firstNode.height, x: firstNode.x, y: firstNode.y };\n      // const box: AreaBox = (({ width, height, x, y }) => ({ width, height, x, y }))(firstNode); // { ...firstNode };\n      const box: Selection = [firstNode.x, firstNode.y, firstNode.x + firstNode.width, firstNode.y + firstNode.height];\n\n      while (nodes.length) {\n        const node = nodes.shift()\n        if (!node) continue;\n\n        // const xDirection = node.match?.traverse?.xDirection;\n        // const yDirection = node.match?.traverse?.yDirection;\n        // if ((xDirection === undefined || xDirection === null) && (yDirection === undefined || yDirection === null)) {};\n\n        if (!(node.x >= box[0] && node.y >= box[1] && node.x + node.width <= box[2] && node.y + node.height <= box[3])) continue;\n\n        // 当前属于模版里面的节点\n        // node.matchs!.forEach(match => {});\n        if (node.matchs === undefined) return grids;\n        for (const match of node.matchs) {\n          const { x, y, width, height } = match;\n          const xOffset = x - box[0];\n          const yOffset = y - box[1];\n\n          if (!(xOffset >= 0 && yOffset >= 0 && x + width <= box[2] && y + height <= box[3])) break;\n\n          let bgColor: TypeColor = node.type!;\n          let textColor: TypeColor = \"cellFill\";\n          if (bgColor !== 'position') {\n            textColor = \"ambiguousText\"\n          }\n          if (!(x === node.x && y === node.y && width === node.width && height === node.height)) {\n            bgColor += \"Shallow\";\n          }\n          for (let i = 0; i < height; i++) {\n            for (let j = 0; j < width; j++) {\n              const cell = grids[(yOffset + i) * firstNode.width + (xOffset + j)]\n              cell.bgColor = typeMapColor[bgColor as TypeColor];\n              cell.text = new Set();\n              cell.textColor = typeMapColor[textColor];\n              if (this.input_tbl.in2out.hasOwnProperty(`[${y + i},${x + j}]`)) {\n                const outPosi = this.input_tbl.in2out[`[${y + i},${x + j}]`];\n                outPosi.forEach(posi => {\n                  const [outY, outX] = JSON.parse(posi);\n                  cell.text.add(this.output_tbl.cols[outX]);\n                })\n              }\n              cell.text = Array.from(cell.text);\n            }\n          }\n        }\n        if (node.children) nodes.push(...node.children);\n      }\n\n      return grids; // { grids, box: (({ width, height, x, y }) => ({ width, height, x, y }))(firstNode) };\n    },\n\n    initTblInfo(inputFlag = true) {\n      if (inputFlag) {\n        this.input_tbl.tbl = []\n        this.input_tbl.instance.updateData(this.input_tbl.tbl);\n      }\n\n      this.input_tbl.in2out = {};\n\n      this.output_tbl.tbl = [];\n      this.output_tbl.cols = [];\n      this.output_tbl.out2in = {};\n      this.output_tbl.instance.updateData(this.output_tbl.tbl);\n      this.output_tbl.instance.updateSettings({ colHeaders: this.output_tbl.cols });\n    },\n\n    deleteChildByPath(nodes: TreeNode[], path: number[], constrIndex: number = -1) {\n      if (path.length === 0) {\n        // 如果路径为空，不做任何处理\n        return;\n      }\n\n      if (constrIndex !== -1) {\n        // 说明删除的是约束\n        const currentNode = this.getNodebyPath(nodes, path) as TableTidierTemplate;\n        if (currentNode) {\n          currentNode.match!.constraints!.splice(constrIndex, 1);\n          if (currentNode.match!.constraints!.length === 0) {\n            delete currentNode.match!.constraints;\n          }\n        }\n        return\n      }\n\n      // 获取目标节点的父节点\n      const parentPath = path.slice(0, -1);\n      const lastIndex = path[path.length - 1];\n\n      if (parentPath.length === 0) {\n        // 如果父路径为空，说明父节点是根节点\n        nodes.splice(lastIndex, 1);\n        return;\n      }\n\n      const parentNode = this.getNodebyPath(nodes, parentPath);\n\n      // 删除目标节点\n      if (parentNode && parentNode.children) {\n        parentNode.children.splice(lastIndex, 1);\n        // 如果父节点的子节点删除后为空数组，则删除children属性\n        if (parentNode.children.length === 0) {\n          delete parentNode.children;\n        }\n      }\n    },\n\n    getNodebyPath(nodes: TreeNode[], path: number[]) {\n      if (path.length === 0) return null; // 如果路径为空，返回null\n\n      let currentNodes = nodes\n      for (let i = 0; i < path.length; i++) {\n        const index = path[i];\n        // 确保路径下的节点存在\n        if (!currentNodes[index]) {\n          return null; // 或者抛出错误\n        }\n        // 如果是最后一个路径元素，返回目标节点\n        if (i === path.length - 1) {\n          return currentNodes[index];\n        }\n        // 更新当前节点为子节点\n        currentNodes = currentNodes[index].children || [];\n      }\n      // 如果路径遍历完仍然没有找到目标节点，返回 null\n      return null;\n    },\n    /**\n     * 默认根据rawSpecs更新editor.mappingSpec.code\n     */\n    stringifySpec(specs: any = null, replaceSpace: \"even\" | \"all\" = \"even\", replaceCode = true) {\n      let fnList: string[] = [];\n      if (specs === null) specs = this.spec.rawSpecs;\n      let strSpec = JSON.stringify(specs, replacer, 2);\n      fnList.forEach((fn) => {\n        strSpec = strSpec.replace(`\"$TableTidier$\"`, fn);\n      })\n\n      // 正则表达式匹配 JSON 对象中的键（包括可能的空白字符和引号）\n      const removeQuotesFromKeysRegex = /\"(\\w+)\":/g;\n      strSpec = strSpec.replace(removeQuotesFromKeysRegex, '$1:');\n\n      const replaceTableTidierKeyWordsRegex = /\"TableTidierKeyWords\\.(\\w+)\"/g;\n      strSpec = strSpec.replace(replaceTableTidierKeyWordsRegex, 'TableTidierKeyWords.$1');\n\n      if (replaceSpace === \"all\") {\n        strSpec = removeSpaceType.all(strSpec);\n      }\n\n      if (replaceCode) {\n        this.spec.undoHistory.push(this.editor.mappingSpec.code);\n        // 当执行新的操作时，重做历史应当清空\n        this.spec.redoHistory = [];\n        this.editor.mappingSpec.code = this.editor.mappingSpec.codePref + strSpec;\n        // this.editor.mappingSpec.instance?.setValue(this.editor.mappingSpec.code);\n        // this.editor.mappingSpecinstance?.getAction('editor.action.formatDocument')?.run();\n        // this.editor.mappingSpec.instance?.trigger('editor', 'editor.action.formatDocument', null);\n      }\n\n      function replacer(key: string, value: any) {\n        if (typeof value === 'function') {\n          fnList.push(removeSpaceType[replaceSpace](value.toString()));\n          return \"$TableTidier$\" // value.toString(); // 将函数转化为字符串\n        }\n        return value;\n      }\n\n      return strSpec;\n    },\n\n    selectArea() {\n      const visNode = this.spec.selectNode.data;\n      const formData = this.spec.areaFormData\n      const newSpec: TableTidierTemplate = {\n        match: {\n          startCell: {\n            referenceAreaLayer: formData.referenceAreaLayer,\n            referenceAreaPosi: formData.referenceAreaPosi,\n            xOffset: formData.position.x,\n            yOffset: formData.position.y,\n          },\n          size: {\n            width: formData.size.width,\n            height: formData.size.height,\n          },\n          traverse: {\n            xDirection: formData.traverse.xDirection,\n            yDirection: formData.traverse.yDirection,\n          }\n        }\n      }\n      if (visNode.path!.length === 0) {\n        // 当前节点为根节点\n        this.spec.rawSpecs.push(newSpec);\n      } else {\n        const currentSpec = this.getNodebyPath(this.spec.rawSpecs, visNode.path!);\n        if (currentSpec === null) {\n          message.error(\"The node path is invalid\");\n          return;\n        }\n        if (currentSpec.hasOwnProperty('children') && currentSpec.children != undefined) {\n          currentSpec.children.push(newSpec)\n        } else {\n          currentSpec.children = [newSpec];\n        }\n      }\n      this.stringifySpec();\n    },\n\n    insertNodeOrPropertyIntoSpecs(nodeOrProperty: any, property: \"children\" | \"match\" | \"constraints\" | \"extract\", visNode: VisTreeNode | null = null) {\n      if (visNode === null) {\n        visNode = this.spec.selectNode.data;\n      }\n      if (visNode.path!.length === 0) {\n        // 当前节点为根节点\n        this.spec.rawSpecs.push({ match: nodeOrProperty });\n      } else {\n        const currentSpec = this.getNodebyPath(this.spec.rawSpecs, visNode.path!);\n        if (currentSpec === null) {\n          message.error(\"The node path is invalid\");\n          return;\n        }\n        switch (property) {\n          case \"children\":\n            if (currentSpec.hasOwnProperty('children') && currentSpec.children != undefined) {\n              currentSpec.children.push({ match: nodeOrProperty });\n            } else {\n              currentSpec.children = [{ match: nodeOrProperty }];\n            }\n            break;\n          case \"match\":\n            if (currentSpec.hasOwnProperty('match') && currentSpec.match != undefined) {\n              Object.assign(currentSpec.match, nodeOrProperty);\n            } else {\n              currentSpec.match = nodeOrProperty;\n            }\n            break;\n          case \"constraints\":\n            if (currentSpec.hasOwnProperty('match') && currentSpec.match != undefined) {\n              if (currentSpec.match.hasOwnProperty('constraints') && currentSpec.match.constraints != undefined) {\n                currentSpec.match.constraints.push(nodeOrProperty);\n              } else {\n                currentSpec.match.constraints = [nodeOrProperty];\n              }\n            } else {\n              currentSpec.match = {\n                constraints: [nodeOrProperty]\n              };\n            }\n            break;\n          case \"extract\":\n            currentSpec.extract = nodeOrProperty;\n            break;\n        }\n      }\n      this.stringifySpec();\n    },\n\n\n    // 复制属性的函数\n    copyAttributes(source: TreeNode, target: TreeNode, attributes: string[]) {\n      for (const attr of attributes) {\n        if (source.hasOwnProperty(attr)) {\n          target[attr] = source[attr];\n        }\n      }\n    },\n\n    // 递归遍历树并复制属性\n    copyTreeAttributes(tree1: TreeNode, tree2: TreeNode, attributes = ['width', 'height', 'x', 'y']) {\n      this.copyAttributes(tree1, tree2, attributes);\n\n      if (tree1.children && tree2.children) {\n        // if (tree1.children.length > tree2.children.length) {\n        //   console.log(tree1.children);\n        //   console.log(tree2.children);\n        // }\n        for (let i = 0; i < tree1.children.length; i++) {\n          // console.log(tree1.children[i], tree2.children[i]);\n          this.copyTreeAttributes(tree1.children[i], tree2.children[i], attributes);\n        }\n      }\n    },\n\n    getHighlightCodeStartEndLine(sonData: any, sonParentData: any = null, rootData: any = null): [number, number] {\n      if (rootData === null) {\n        rootData = this.spec.rawSpecs\n      }\n      const rootStr = this.stringifySpec(rootData, \"all\", false)\n      const sonStr = this.stringifySpec(sonData, \"all\", false)\n\n      if (sonParentData === null) {\n        const startIndex = rootStr.indexOf(sonStr);\n        const strBefore = rootStr.slice(0, startIndex);\n        const startLine = (strBefore.match(/\\n/g) || []).length + 1;\n        const endLine = startLine + (sonStr.match(/\\n/g) || []).length;\n        return [startLine, endLine]\n      } else {\n        const [startParentLine, _] = this.getHighlightCodeStartEndLine(sonParentData);\n        const [startConstLine, endConstLine] = this.getHighlightCodeStartEndLine(sonData, null, sonParentData);\n        const startLine = startParentLine + startConstLine - 1;\n        const endLine = startParentLine + endConstLine - 1;\n        return [startLine, endLine]\n      }\n    },\n\n    highlightCode(startLine: number, endLine: number = startLine, className: string = \"nullShallow\") {\n      const editor = this.editor.mappingSpec.instance\n      const decorationsCollection = this.editor.mappingSpec.decorations\n      if (editor && decorationsCollection) {\n        const range = new monaco.Range(startLine, 1, endLine, 1);\n        const newDecorations: monaco.editor.IModelDeltaDecoration[] = [\n          {\n            range,\n            options: {\n              isWholeLine: true,\n              className: className  // 'myLineDecoration',\n            },\n          },\n        ];\n        // 更新装饰集合\n        decorationsCollection.set(newDecorations);\n        // editor.revealLineInCenter(startLine);\n        // editor.revealLineNearTop(startLine);\n        // editor.revealRangeNearTopIfOutsideViewport(range);\n        // editor.setSelection(range);  // 选择范围\n        editor.revealRangeAtTop(range);\n      }\n    },\n    getCellDataType(value: CellValueType) {\n      if (value === '' || value === null || value === undefined) {\n        return TableTidierKeyWords.None;\n      }\n      if (!isNaN(Number(value))) {\n        return TableTidierKeyWords.Number;\n      }\n      if (typeof value === 'string') {\n        return TableTidierKeyWords.String;\n      }\n      return TableTidierKeyWords.NotNone;\n    },\n    clearStatus(type: string) {\n      switch (type) {\n        case \"matchArea\":\n          document.body.style.cursor = 'default';\n          document.documentElement.style.setProperty('--custom-cursor', 'default');\n          d3.selectAll('.legend').classed('legend-selection', false);\n          // this.spec.selectAreaFromLegend = []\n          // this.spec.selectionsAreaFromLegend = []\n          break;\n        case \"tree\":\n          /*\n          const typeNodes = document.querySelectorAll('.type-node');\n          typeNodes.forEach((node) => {\n            (node as HTMLElement).classList.remove('selection');\n          });\n          const constraintRects = document.querySelectorAll('.node-constraint-rect');\n          constraintRects.forEach((rect) => {\n            // (rect as HTMLElement).style.visibility = 'hidden';\n            (rect as HTMLElement).setAttribute('visibility', 'hidden');\n          });\n          */\n          this.spec.constrNodeRectClickId = '';\n          d3.selectAll('.type-node').classed('selection', false);\n          d3.selectAll('.node-constraint-rect').attr('visibility', 'hidden');\n          break;\n      }\n    },\n  },\n  // computed\n  getters: {}\n})\n\n\nexport type TableStore = ReturnType<typeof useTableStore>;","/* eslint-disable no-param-reassign */\nimport * as d3 from 'd3';\n// import { useTableStore } from '@/store/table';  // 不能在还没有激活pinia store前就使用，可以传参进来\n\nimport {\n  typeMapColor, TypeColor,\n  typeNodeStyle,\n  nodeTextStyle,\n} from './style';\nimport {\n  Point, RectDef, KV,\n} from './types';\nimport letterAspectRatio from './letterAspectRatio';\nimport { VisTreeNode, TableStore, TblCell, Selection } from \"@/store/table\";\nimport { CellConstraint, completeCellConstraint, TableTidierKeyWords } from '@/grammar/grammar';\nimport { getCellBySelect } from '@/grammar/handleSpec';\n\n\nexport type NodeData = {\n  [key: string]: any,\n  children: NodeData[],\n  parent: NodeData | null,\n  data: VisTreeNode\n}\n\n/** 创建一个新的Escape键盘事件，指定事件类型和相关参数 */\nconst escapeEvent = new KeyboardEvent('keydown', {\n  key: 'Escape',\n  code: 'Escape',\n  keyCode: 27,\n  charCode: 27,\n  which: 27,\n  bubbles: true,\n  cancelable: true\n});\n\n\nconst getLetterWidth = (\n  letter: string,\n  fontSize: number,\n) => fontSize * (letterAspectRatio[letter as keyof typeof letterAspectRatio] || 1);\n\nconst getTextSize = (text: string, fontSize: number) => {\n  let width = 0;\n  // eslint-disable-next-line prefer-regex-literals\n  const pattern = new RegExp('[\\u4E00-\\u9FFF]+');\n  text.split('')\n    .forEach((letter) => {\n      if (pattern.test(letter)) {\n        // 中文字符\n        width += fontSize;\n      } else {\n        width += getLetterWidth(letter, fontSize);\n      }\n    });\n  return [width, fontSize];\n};\n\nconst fittingString = (input: string, maxWidth: any, fontSize: any) => {\n  const ellipsis = '...';\n  const ellipsisLength = getTextSize(ellipsis, fontSize)[0];\n  let currentWidth = 0;\n  let result = input;\n  // eslint-disable-next-line prefer-regex-literals\n  const pattern = new RegExp('[\\u4E00-\\u9FFF]+');\n  input.split('')\n    .forEach((letter: string, i) => {\n      if (currentWidth > maxWidth - ellipsisLength) {\n        return;\n      }\n      if (pattern.test(letter)) {\n        // Chinese charactors\n        currentWidth += fontSize;\n      } else {\n        // get the width of single letter according to the fontSize\n        currentWidth += getLetterWidth(letter, fontSize);\n      }\n      if (currentWidth > maxWidth - ellipsisLength) {\n        result = `${input.slice(0, i)}${ellipsis}`;\n      }\n    });\n  return result;\n};\n\nfunction diagonal(source: Point, target: Point) {\n  const { x, y } = source;\n  const { x: ex, y: ey } = target;\n\n  const xrvs = ex - x < 0 ? -1 : 1;\n  const yrvs = ey - y < 0 ? -1 : 1;\n\n  const rdef = 15;\n  let r = Math.abs(ex - x) / 2 < rdef ? Math.abs(ex - x) / 2 : rdef;\n\n  r = Math.abs(ey - y) / 2 < r ? Math.abs(ey - y) / 2 : r;\n\n  const h = Math.abs(ey - y) / 2 - r;\n  const w = Math.abs(ex - x) - r * 2;\n  // w=0;\n  const path = `\n      M ${x} ${y}\n      L ${x} ${y + h * yrvs}\n      C  ${x} ${y + h * yrvs + r * yrvs} ${x} ${y + h * yrvs + r * yrvs} ${x + r * xrvs} ${y + h * yrvs + r * yrvs}\n      L ${x + w * xrvs + r * xrvs} ${y + h * yrvs + r * yrvs}\n      C  ${ex}  ${y + h * yrvs + r * yrvs} ${ex}  ${y + h * yrvs + r * yrvs} ${ex} ${ey - h * yrvs}\n      L ${ex} ${ey}\n`;\n  return path;\n}\n\nfunction hdiagonal(source: Point, target: Point) {\n  const { x, y } = source;\n  const { x: ex, y: ey } = target;\n\n  // Values in case of top reversed and left reversed diagonals\n  const xrvs = ex - x < 0 ? -1 : 1;\n  const yrvs = ey - y < 0 ? -1 : 1;\n\n  // Define preferred curve radius\n  const rdef = 15;\n\n  // Reduce curve radius, if source-target x space is smaller\n  let r = Math.abs(ex - x) / 2 < rdef ? Math.abs(ex - x) / 2 : rdef;\n\n  // Further reduce curve radius, is y space is more small\n  r = Math.abs(ey - y) / 2 < r ? Math.abs(ey - y) / 2 : r;\n\n  // Defin width and height of link, excluding radius\n  const h = Math.abs(ey - y) / 2 - r;\n  const w = Math.abs(ex - x) / 2 - r;\n\n  // Build and return custom arc command\n  return `\n      M ${x} ${y}\n      L ${x + w * xrvs} ${y}\n      C ${x + w * xrvs + r * xrvs} ${y}\n        ${x + w * xrvs + r * xrvs} ${y}\n        ${x + w * xrvs + r * xrvs} ${y + r * yrvs}\n      L ${x + w * xrvs + r * xrvs} ${ey - r * yrvs}\n      C ${x + w * xrvs + r * xrvs}  ${ey}\n        ${x + w * xrvs + r * xrvs}  ${ey}\n        ${ex - w * xrvs}  ${ey}\n      L ${ex} ${ey}\n  `;\n}\n\nfunction customRectCorner(rectInfo: RectDef) {\n  const {\n    startx, starty, rectWidth, rectHeight, rounded, radius,\n  } = rectInfo;\n  let path;\n\n  switch (rounded) {\n    case 'left':\n      path = `\n      M${startx + radius},${starty + radius}\n      a${radius},${radius} 0 0 1 ${radius},-${radius}\n      h${rectWidth - radius}\n      v${rectHeight}\n      h${-rectWidth + radius}\n      a${radius},${radius} 0 0 1 -${radius},-${radius}\n      z\n      `;\n      break;\n    case 'right':\n      path = `\n      M${startx},${starty}\n      h${rectWidth - radius}\n      a${radius},${radius} 0 0 1 ${radius},${radius}\n      v${rectHeight - 2 * radius}\n      a${radius},${radius} 0 0 1 ${-radius},${radius}\n      h ${radius - rectWidth}\n      z\n      `;\n      break;\n    case 'top':\n      path = `\n      M${startx},${starty + radius}\n      a${radius},${radius} 0 0 1 ${radius},-${radius}\n      h${rectWidth - 2 * radius}\n      a${radius},${radius} 0 0 1 ${radius},${radius}\n      v${rectHeight - radius}\n      h${-rectWidth}\n      z`;\n      break;\n    case 'bottom':\n      path = `\n      M${startx},${starty}\n      h${rectWidth}\n      v${rectHeight - radius}\n      a${radius},${radius} 0 0 1 ${-radius},${radius}\n      h${-rectWidth + 2 * radius}\n      a${radius},${radius} 0 0 1 -${radius},-${radius}\n      z`;\n      break;\n    case 'all': // 936\n      path = `\n      M${startx},${starty + radius}\n      a${radius},${radius} 0 0 1 ${radius},-${radius}\n      h${rectWidth - 2 * radius}\n      a${radius},${radius} 0 0 1 ${radius},${radius}\n      v${rectHeight - 2 * radius}\n      a${radius},${radius} 0 0 1 ${-radius},${radius}\n      h${-rectWidth + 2 * radius}\n      a${radius},${radius} 0 0 1 -${radius},-${radius}\n      z`;\n      break;\n    default: {\n      path = `\n      M${startx}${starty}\n      h${rectWidth}\n      v${rectHeight}\n      h${-rectWidth}\n      v${-rectHeight}\n      z\n      `;\n      break;\n    }\n  }\n\n  return path;\n}\n\nfunction declareContextMenu(tableStore: TableStore, node: NodeData, constrIndex: number, event: MouseEvent) {\n  event.preventDefault();\n  // event.stopPropagation();\n  // console.log(tableStore, node, constrIndex, event);  // 第一个参数为 this，可以不写\n  event.preventDefault();\n\n  if (node.parent === null) {\n    tableStore.tree.menuList = [tableStore.tree.menuAllList[3]];\n  } else if (constrIndex === -1) {\n    tableStore.tree.menuList = tableStore.tree.menuAllList.slice(0, -1);\n  } else {\n    tableStore.tree.menuList = tableStore.tree.menuAllList.slice(-1);\n    tableStore.spec.selectConstrIndex = constrIndex;\n  }\n  // console.log(\"node\", node);\n  tableStore.spec.selectNode = node;\n  tableStore.tree.contextMenuVisible = true;\n}\n\nexport class TreeChart {\n  svgWidth: number;\n  svgHeight: number;\n  margins: Array<number>;\n  container: string;\n  data: any;\n  zoomLevel: number;\n  depth: number;\n  calculated: KV; // SVG画布相关的信息，如宽高、边距、对称中心\n  treeLayout: any; // 用于存放layout配置\n  realChart: any;\n  previousTransform: any;\n  centerG: any;\n  centerX: number;\n  root: any; // 树的根节点及其children\n  allNodes: any; // 用于存放root数据输入layout配置中后生成的位置信息\n  defaultFont: string;\n  duration: number;\n  store: TableStore;\n  orient: 'h' | 'v';\n\n  constructor(\n    _margins: Array<number>,\n    _container: string,\n    _data: any,\n    _store: any,\n    _zoomLevel = 1.0,\n    _orient: 'h' | 'v' = 'h' as const,\n  ) {\n    this.svgWidth = 500;\n    this.svgHeight = 500;\n    this.margins = _margins;\n    this.container = _container;\n    this.zoomLevel = _zoomLevel;\n    this.orient = _orient;\n    this.depth = 10;\n    this.calculated = {};\n    this.treeLayout = null;\n    this.realChart = null;\n    this.previousTransform = null;\n    this.centerX = 0;\n    this.root = null;\n    this.allNodes = null;\n    this.defaultFont = 'Helevtica';\n    this.duration = 600;\n    this.data = _data;\n    this.store = _store;\n\n    this.zoomed.bind(this);\n    this.setZoomFactor.bind(this);\n    this.batchEnterExitUpdate();\n  }\n\n  // 需要再展开收起节点后自适应当前容器\n  public setZoomFactor() {\n    const currentWidth = this.centerG.node()\n      .getBoundingClientRect().width;\n    let targetZoomLevel = this.svgWidth / currentWidth;\n    targetZoomLevel = targetZoomLevel > 1 ? 1 : targetZoomLevel;\n    this.zoomLevel = targetZoomLevel;\n\n    if (this.orient === 'h') {\n      this.centerG.attr('transform', `translate(${this.calculated.nodeMaxWidth / 2}, ${this.calculated.centerY}) scale(${targetZoomLevel})`);\n    } else {\n      this.centerG.attr('transform', `translate(${this.calculated.centerX}, ${this.calculated.nodeMaxHeight / 2}) scale(${targetZoomLevel})`);\n    }\n  }\n\n  private zoomed(e: any) {\n    this.previousTransform = e.transform;\n    this.realChart.attr('transform', e.transform);\n  }\n\n  /*\n  private handleCircleClick(_: any, d: any) {\n    if (d.children) {\n      d.hiddenChildren = d.children;\n      d.children = null;\n    } else {\n      if (d.hiddenChildren) d.children = d.hiddenChildren;\n      d.hiddenChildren = null;\n    }\n\n    this.update(d);\n  }\n\n  private handleRectClick(\n    _: any,\n    parent: any,\n    childrenToToggle: Array<any>,\n  ) {\n    // childrenToToggle 全部出现在children中，说明当前点击是期望收起\n    if (parent.children && AincludeB(parent.children, childrenToToggle)) {\n      if (!parent.hiddenChildren) {\n        parent.hiddenChildren = [];\n      }\n      parent.hiddenChildren = parent.hiddenChildren.concat(childrenToToggle);\n      parent.children = parent.children.filter((cd) => !childrenToToggle.includes(cd));\n      // 如果传入空数组，d3 tree.js会报错 read properties of undefined (reading 'z') at firstWalk\n      // 没有children只能传null\n      if (!parent.children.length) {\n        parent.children = null;\n      }\n    } else if (parent.hiddenChildren && AincludeB(parent.hiddenChildren, childrenToToggle)) {\n      if (!parent.children) {\n        parent.children = [];\n      }\n      parent.children = parent.children.concat(childrenToToggle);\n      parent.hiddenChildren = parent.hiddenChildren.filter((cd) => !childrenToToggle.includes(cd));\n      if (!parent.hiddenChildren.length) parent.hiddenChildren = null;\n    }\n\n    this.update(parent);\n  }\n    */\n\n\n  private batchEnterExitUpdate() {\n    d3.selection.prototype.patternify = function (selectedTag:\n      { tag: string, selector: string, targetData?: any }) {\n      const { tag, selector } = selectedTag;\n      const tmpData = selectedTag.targetData || [selector];\n      const batchSelection = this.selectAll(`.${selector}`)\n        .data(tmpData, (d: any, i: any) => {\n          if (typeof d === 'object') {\n            if (d.id) {\n              return d.id;\n            }\n          }\n          return i;\n        });\n\n      batchSelection.exit()\n        .remove();\n      const mergedSelection = batchSelection.enter()\n        .append(tag)\n        .merge(batchSelection);\n      mergedSelection.attr('class', selector);\n      return mergedSelection;\n    };\n  }\n\n  public render() {\n    // 获取当前svg所在容器，使svg长度高度匹配容器\n    const drawingContainer = d3.select(this.container);\n    // 清空当前容器下的所有子元素\n    (drawingContainer.node() as HTMLElement).replaceChildren();\n\n    const drawingContainerBoundry = (drawingContainer.node() as HTMLElement)\n      .getBoundingClientRect();\n    if (drawingContainerBoundry.width > 0) {\n      this.svgWidth = drawingContainerBoundry.width;\n      this.svgHeight = drawingContainerBoundry.height;\n    }\n\n\n    const nodeMaxWidth = typeNodeStyle.nodeWidth; // d3.max(this.data, (({ nodeWidth }) => nodeWidth));\n    const nodeMaxHeight = typeNodeStyle.nodeHeight; // d3.max(this.data, (({ nodeHeight }) => nodeHeight));\n    this.calculated = {\n      id: `ID${Math.floor(Math.random() * 1000000)}`,\n      chartVerticalMargin: this.margins[0],\n      chartHorizontalMargin: this.margins[1],\n      chartWidth: this.svgWidth - this.margins[0] * 2,\n      chartHeight: this.svgHeight - this.margins[1] * 2,\n      nodeMaxWidth,\n      nodeMaxHeight,\n      centerX: (this.svgWidth - this.margins[0] * 2) / 2,\n      centerY: (this.svgHeight - this.margins[1] * 2) / 2,\n    };\n\n    this.depth = this.orient === 'h' ? nodeMaxWidth / 2 : nodeMaxHeight + 20;\n\n    this.treeLayout = d3.tree()\n      .size([this.calculated.chartWidth, this.calculated.chartHeight]);\n    // console.log(\"layout:\", this.treeLayout);\n    // console.log(this.calculated);\n\n\n    if (this.orient === 'h') {\n      this.treeLayout.nodeSize([this.calculated.nodeMaxHeight + typeNodeStyle.nodeSpacing,\n      this.calculated.nodeMaxWidth + this.depth]);\n    } else {\n      this.treeLayout.nodeSize([this.calculated.nodeMaxWidth + typeNodeStyle.nodeSpacing,\n      this.calculated.nodeMaxHeight + this.depth]);\n    }\n\n    if (Array.isArray(this.data)) {\n      this.root = d3.stratify()\n        .id((d: any) => d.nodeId)\n        .parentId((d: any) => d.parentNodeId)(this.data);\n    } else {\n      this.root = d3.hierarchy(this.data, (d: any) => d.children);\n      // 初始化 id 计数器\n      // let idCounter = 0;\n      // 为每个节点分配唯一的 id\n      this.root.each((node: NodeData) => {\n        // node.id = idCounter++;\n        // node.data.id = node.id;\n        node.id = node.data.id;\n      });\n    }\n\n    this.root.x0 = 0;\n    this.root.y0 = 0;\n\n    /*\n    this.allNodes = this.treeLayout(this.root)\n      .descendants()\n      .forEach((d: any) => {\n        Object.assign(d.data, {\n          directSubordinates: d.children ? d.children.length : 0, // 计算直接下属的数量（即直接子节点的数量）\n          totalSubordinates: d.descendants().length - 1,  // 计算总下属的数量（包括所有子孙节点，但不包括自身）\n        });\n      });\n    */\n\n    // pan & zoom handler\n    const zoomfunc: any = (d3.zoom() as any).on('zoom', this.zoomed.bind(this))\n      .bind(this);\n\n    // svg画布\n    // @ts-ignore\n    const svg = drawingContainer.patternify({ tag: 'svg', selector: 'svg-chart-container' })\n      .attr('width', this.svgWidth)\n      .attr('height', this.svgHeight)\n      .attr('font-family', this.defaultFont)\n      // .attr('cursor', 'move')\n      // .attr('viewBox', `${this.margins[0]} ${this.margins[1]} ${this.svgWidth} ${this.svgHeight}`)\n      // .tween(\"resize\", window.ResizeObserver ? null : () => () => svg.dispatch(\"toggle\"))\n      .call(zoomfunc.bind(this)).on('dblclick.zoom', null)  // 禁用双击缩放\n\n    // svg画布与容器边距 \n    const chart = svg.patternify({ tag: 'g', selector: 'chart' })\n      .attr('transform', `translate(${this.calculated.chartHorizontalMargin}, ${this.calculated.chartVerticalMargin})`);\n    this.realChart = chart;\n\n    // 真正放置node link\n    const centerG = chart.patternify({ tag: 'g', selector: 'center-group' })\n    // .attr('transform', this.orient === 'h' ? `translate(${this.calculated.chartHorizontalMargin}, ${this.calculated.centerY}) scale(${this.zoomLevel})` : `translate(${this.calculated.centerX}, ${this.calculated.nodeMaxHeight / 2}) scale(${this.zoomLevel})`);\n    this.centerG = centerG;\n\n    // 开始画图例\n\n    // 开始画node link\n    this.update(this.root);\n    return this;\n  }\n\n  private update(data: any) {\n    const tableStore = this.store;\n    const treeData = this.treeLayout(this.root);\n    const linksData = treeData.descendants()\n      .slice(1);\n    const nodesData = treeData.descendants();\n    if (this.orient === 'h') {\n      nodesData.forEach((d: any, index: number) => {\n        const originalX = d.x;\n        d.x = d.y;\n        d.y = originalX;\n        if (index === 0) {\n          d.x = typeNodeStyle.nodeCircleRadius * 2;\n        }\n      });\n    }\n    // 如果是水平视图，要等nodesData转变过后再解构，否则得到的是转变之前的位置，造成transition bug\n    const {\n      x0, y0, x, y,\n    } = data;\n\n    // ************************************绘制link************************************\n    const linksSelection = this.centerG.selectAll('path.link')\n      .data(linksData, (d: any) => d.id);\n\n    const linkGen = d3.linkHorizontal();\n\n    const linksEnter = linksSelection.enter()\n      .insert('path', 'g')\n      .attr('class', 'link')\n      .attr('d', () => {\n        const o: d3.DefaultLinkObject = {\n          source: [x0, y0],\n          target: [x0, y0],\n        };\n        return linkGen(o);\n      });\n\n    const linkUpdate = linksEnter.merge(linksSelection);\n\n    linkUpdate.attr('fill', 'none')\n      .attr('stroke-width', typeNodeStyle.connectorLineWidth)\n      .attr('stroke', typeNodeStyle.connectorLineColor)\n    // .attr('stroke-width', ((d: any) => d.data.connectorLineWidth || 2))\n    // .attr('stroke', (d: any) => (d.data.connectorLineColor ? d.data.connectorLineColor : 'black'));\n\n    let realChartWidth = 0\n    linkUpdate.transition()\n      .duration(this.duration)\n      .attr('d', (d: any) => {\n        if (this.orient === 'h') {\n          let xshiftStart = typeNodeStyle.nodeWidth / 2;\n          const yshiftStart = 0;\n          const xshiftEnd = -typeNodeStyle.nodeWidth / 2;\n          const yshiftEnd = 0;\n\n          if (d.parent.id == \"0\") {\n            xshiftStart = typeNodeStyle.nodeCircleRadius\n          }\n\n          const chartWidth = d.x + xshiftStart;\n          if (chartWidth > realChartWidth) {\n            realChartWidth = chartWidth;\n          }\n\n          const o: d3.DefaultLinkObject = {\n            source: [d.parent.x + xshiftStart, d.parent.y + yshiftStart],\n            target: [d.x + xshiftEnd, d.y + yshiftEnd],\n          };\n          return linkGen(o);\n        }\n\n        const o: d3.DefaultLinkObject = {\n          source: [d.parent.x, d.parent.y + typeNodeStyle.nodeHeight / 2],\n          target: [d.x, d.y - typeNodeStyle.nodeHeight / 2],\n        };\n        return linkGen(o);\n        return diagonal({ x: d.x, y: d.y }, { x: d.parent.x, y: d.parent.y });\n      });\n\n\n\n    // 用于节点收缩或展开是动效终点所处位置\n    const linkExit = linksSelection.exit()\n      .transition()\n      .duration(this.duration)\n      .attr('d', () => {\n        const o: d3.DefaultLinkObject = {\n          source: [x, y],\n          target: [x, y],\n        };\n        return linkGen(o);\n      })\n      .remove();\n\n    // ************************************绘制node************************************\n    const nodesSelection = this.centerG.selectAll('g.node')\n      .data(nodesData, (d: any) => d.id);\n\n\n\n    const nodeEnter = nodesSelection.enter()\n      .append('g')\n      .attr('class', 'node')\n      .attr('transform', () => `translate(${x0}, ${y0})`)\n      .attr('cursor', 'pointer');\n\n\n\n    // ************************************节点、节点文本、节点上方边文本****************************\n    const nodeGroups = nodeEnter.patternify({ tag: 'g', selector: 'node-group', targetData: (d: any) => [d] });\n    // const nodeRectText = nodeEnter.patternify({ tag: 'text', selector: 'node-text', targetData: (d: any) => [d] });\n\n    // const nodeRectText = nodeGroups.patternify({ tag: 'g', selector: 'node-text-g', targetData: (d: any) => [d] });\n    // nodeRectText.patternify({ tag: 'text', selector: 'node-text' });\n    // nodeRectText.patternify({ tag: 'svg:title', selector: 'node-tooltip' });\n\n    // const edgeText = nodeEnter.patternify({ tag: 'text', selector: 'edge-text', targetData: (d: any) => [d] });\n\n    const nodeUpdate = nodeEnter.merge(nodesSelection);\n\n    nodeUpdate.transition()\n      .attr('opaicty', 0)\n      .duration(this.duration)\n      .attr('transform', (d: any) => {\n        // console.log(d);\n        return `translate(${d.x}, ${d.y})`\n      })\n      .attr('opacity', 1);\n\n    // console.log(data);\n\n    // 绑定选中节点的交互\n    // nodeGroups\n    //   // .on('click', this.handleNodeMultipleSelect.bind(this))\n    //   .on('contextmenu', this.declareContextMenu.bind(this));\n\n    // nodeGroups.attr('transform', ({ data: info }: any) => `translate(${-info.nodeWidth / 2}, ${-info.nodeHeight / 2})`);\n    nodeGroups.attr('transform', () => `translate(${-typeNodeStyle.nodeWidth / 2}, ${-typeNodeStyle.nodeHeight / 2})`);\n\n    nodeGroups.each(function (this: any, node: NodeData) {\n      const current = d3.select(this);\n      /** 绘制节点（circle + rect） */\n      if (node.parent === null) { // 提前处理圆形节点，array下的元素\n        // @ts-ignore\n        current.patternify({ tag: 'circle', selector: `node-circle-${node.id}` });\n        nodeGroups.select(`.node-circle-${node.id}`)\n          .attr('class', `node-circle-${node.id} type-node`)\n          .attr('r', typeNodeStyle.nodeCircleRadius)\n          .attr('fill', typeMapColor[node.data.type!])\n          .attr('transform', `translate(${typeNodeStyle.nodeWidth / 2}, ${typeNodeStyle.nodeHeight / 2})`)\n          // .attr('cursor', (d: any) => (!d.children && !d.hiddenChildren ? 'none' : 'pointer'))\n          .attr('cursor', 'pointer')\n        // .attr('pointer-events', (d: any) => (!d.children && !d.hiddenChildren ? 'none' : 'all'));\n        // @ts-ignore\n        // current.patternify({ tag: 'svg:title', selector: 'node-tooltip' });\n        // current.select('.node-tooltip')\n        //   // .filter(({ data: info }: any) => info.dataTypeText !== info.dataTypeTextTruncated)\n        //   .text(\"Path: \" + JSON.stringify(node.data.path));\n        return;\n      }\n\n      const nodeRectData = {\n        // \"rectColor\": typeNodeStyle.nodeRectFillColor,\n        \"rectHeight\": typeNodeStyle.nodeHeight,\n        \"rectWidth\": typeNodeStyle.nodeWidth,\n        \"starty\": 0,\n        \"startx\": 0,\n        \"radius\": 5,\n        \"rounded\": \"all\"\n      }\n      // @ts-ignore\n      const singleNodeG = current.patternify({ tag: 'g', selector: `single-node-g`, targetData: (d: any) => [d] });\n      singleNodeG.patternify({ tag: 'path', selector: `node-rect-${node.id}` });\n      singleNodeG.select(`.node-rect-${node.id}`)\n        .attr('class', `node-rect-${node.id} type-node`)\n        .attr('d', customRectCorner(nodeRectData as RectDef))\n        .attr('fill', typeMapColor[node.data.type!])\n        // .attr('fill', nodeRectData.rectColor)\n        // .attr('cursor', (d: any) => (!d.children && !d.hiddenChildren ? 'none' : 'pointer'))\n        .attr('cursor', 'pointer')\n      // .attr('pointer-events', (d: any) => (!d.children && !d.hiddenChildren ? 'none' : 'all'));\n\n      let tooltipText: any = node.data.matchs?.length;\n      tooltipText = tooltipText === undefined ? '' : `\\nMatch: ${tooltipText} instances`;\n\n      singleNodeG.patternify({ tag: 'svg:title', selector: 'node-tooltip' });\n      singleNodeG.select('.node-tooltip')\n        // .filter(({ data: info }: any) => info.dataTypeText !== info.dataTypeTextTruncated)\n        .text(\"Pattern Path: \" + JSON.stringify(node.data.path) + tooltipText);\n      // .text(\"Pattern Path: \" + JSON.stringify(node.data.path) + \"\\nPattern Id: \" + node.data.id + tooltipText);\n\n      /** 绘制节点的constraints */\n      node.data.match?.constraints?.forEach((_constraint, i) => {\n        // console.log('hhh', constraint, i, dataBindToThis.id, dataBindToThis);\n        const iconsz = typeNodeStyle.iconsize;\n        const constrId = `${node.id}-${i}`;\n        // @ts-ignore\n        current.patternify({ tag: 'rect', selector: `node-constraint-rect-${constrId}` });\n        const constrNodeRect = nodeGroups.select(`.node-constraint-rect-${constrId}`);\n\n        const subTemplate = tableStore.getNodebyPath(tableStore.spec.rawSpecs, node.data.path!);\n        const constraint: CellConstraint = subTemplate!.match.constraints![i];\n\n        constrNodeRect.classed('node-constraint-rect', true)\n          .attr('transform', `translate(${(iconsz + typeNodeStyle.iconPadding) * i}, ${-typeNodeStyle.nodeHeight / 2 - 3})`)\n          .attr(\"visibility\", \"hidden\")\n          .attr('width', iconsz + 2)\n          .attr('height', iconsz + 2)\n          .attr(\"stroke\", typeMapColor.selection)\n          .attr(\"stroke-width\", 1.5)\n          .attr(\"fill\", \"none\")\n\n        // @ts-ignore\n        current.patternify({ tag: 'image', selector: `node-constraint-icon-${constrId}` });\n        nodeGroups.select(`.node-constraint-icon-${constrId}`)\n          .attr('transform', `translate(${1 + (iconsz + typeNodeStyle.iconPadding) * i}, ${-typeNodeStyle.nodeHeight / 2 - 2})`)\n          .attr('xlink:xlink:href', () => {\n            // eslint-disable-next-line\n            const iconPath = require('@/assets/constraint.png');\n            return iconPath;\n          })\n          .attr('width', iconsz)\n          .attr('height', iconsz)\n          .on('mouseover', (_e: any, d: NodeData) => {\n            constrNodeRect.attr('visibility', 'visible');\n            const cellInfo = d.data.constrsInfo![i][0];\n            tableStore.highlightTblTemplate({\n              x: cellInfo.x,\n              y: cellInfo.y,\n              width: 1,\n              height: 1\n            });\n          })\n          .on('mouseout', (_e: any, d: NodeData) => {\n            if (tableStore.spec.constrNodeRectClickId !== constrId)\n              constrNodeRect.attr('visibility', 'hidden');\n            d3.select('.tbl-container .tbl-template-highlight').select('rect').remove();\n          })\n          .on('contextmenu', declareContextMenu.bind(null, tableStore, node, i))  // bind 第一个参数为 this，这种情况下最后一个参数为 event\n          .on('click', (_e: any, d: NodeData) => {\n            // console.time('constraint click');\n            // console.log(constraint, tableStore);  // constraint 等价于 d.data.constraints![i]\n            tableStore.editor.mappingSpec.instance?.setValue(tableStore.editor.mappingSpec.codePref + tableStore.stringifySpec(null, \"even\", false));\n            // 先清空其他样式\n            document.dispatchEvent(escapeEvent);\n\n            tableStore.spec.constrNodeRectClickId = constrId;\n            constrNodeRect.attr('visibility', 'visible');\n\n            const [startLine, endLine] = tableStore.getHighlightCodeStartEndLine(constraint, subTemplate);\n            tableStore.highlightCode(startLine, endLine, 'selectionShallow');   // `${d.data.type}Shallow`\n\n            /*\n            const cellInfoSelections: Selection[] = [];\n            const allConstr = completeCellConstraint(constraint);\n            d.data.currentAreas!.forEach((area) => {\n              try {\n                const cellInfo = getCellBySelect(allConstr, area, tableStore.editor.rootArea.object!);\n                if (cellInfo) {\n                  cellInfoSelections.push([cellInfo.y, cellInfo.x, cellInfo.y, cellInfo.x]);\n                }\n              } catch (e) {\n                // console.error(e);\n              }\n            })\n            const cells = tableStore.generateHighlightCells(cellInfoSelections, ['selection', ...Array(cellInfoSelections.length - 1).fill(\"selectionShallow\")]);\n            */\n            const cellInfoSelections = d.data.constrsInfo![i].map((cellInfo) => [cellInfo.y, cellInfo.x, cellInfo.y, cellInfo.x] as Selection);\n            const cells = tableStore.generateHighlightCells(cellInfoSelections, ['selection', ...Array(cellInfoSelections.length - 1).fill(\"selectionShallow\")]);\n            tableStore.highlightTblCells(\"input_tbl\", cells);\n            tableStore.highlightMinimapCells(cells);\n            // console.timeEnd('constraint click');\n          })\n          .append('svg:title').text(() => {\n            const valueCstr = constraint.valueCstr;\n            if (typeof valueCstr === 'function') {\n              return \"The cell is constrained by a custom function:\\nClick to see details in the Code Panel.\";\n            } else {\n              switch (valueCstr) {\n                case TableTidierKeyWords.String:\n                  return \"The cell's data type should be a string.\";\n                case TableTidierKeyWords.Number:\n                  return \"The cell's data type should be a number.\";\n                case TableTidierKeyWords.None:\n                  return \"The cell should be an empty string, null, or undefined.\";\n                case TableTidierKeyWords.NotNone:\n                  return \"The cell should not be an empty string, null, or undefined.\";\n                default:\n                  return \"The cell should be \" + valueCstr;\n              }\n            }\n          })\n      });\n    });\n\n    // const nodeRectText = nodeUpdate.patternify({ tag: 'g', selector: 'node-text-g', targetData: (d: any) => [d] });\n    nodeUpdate.patternify({ tag: 'text', selector: 'node-text' });\n\n\n    nodeUpdate.select('.node-text')\n      .attr('text-anchor', 'middle')\n      .attr('alignment-baseline', 'middle')\n      .attr('fill', nodeTextStyle.color)\n      .attr('font-size', nodeTextStyle.fontSize)\n      // .attr('y', ({ data: info }: any) => nodeTextStyle.yAxisAdjust + info.shiftFromEndCenter)\n      .attr('y', () => nodeTextStyle.yAxisAdjust)\n      .attr('cursor', 'pinter')\n      .attr('pointer-events', 'none')  // .style('pointer-events', 'auto');\n      .text((d: NodeData) => {\n        if (d.id === 0) {\n          // console.log(d.data.size);\n          return \"\";\n        } else {\n          let width: number | null = d.data.width!;\n          let height: number | null = d.data.height!;\n          if (d.data.match?.size !== undefined) {\n            if (d.data.match.size.width === null) width = null;\n            if (d.data.match.size.height === null) height = null;\n          }\n          return `(${width}, ${height})`;\n        }\n      })\n    // .on('click', (event: any, d: any) => {\n    //   // 阻止点击事件的默认行为和传播\n    //   // event.stopPropagation();\n    //   // event.preventDefault();\n    //   console.log(\"click\", d);\n    // })\n    // .append(\"svg:title\").text(\"(d: any) => d.data.id\");\n\n\n\n    // 为所有circle和rect绑定展开收起交互事件\n    // d3.selectAll('.type-node, .node-text-g')\n    d3.selectAll('.type-node')\n      .on('contextmenu', (e, d) => {\n        declareContextMenu(tableStore, d as NodeData, -1, e);\n      })\n      .on('mouseover', function (event: any, node: any) {  // 只有 function 才有 this，箭头函数的 this 是定义时的上下文\n        // console.log('mouseover', event, node);  // event: any, node: any\n        if (node.id) tableStore.highlightTblTemplate(node.data);\n      })\n      .on('mouseout', function (event: any, node: any) {\n        d3.select('.tbl-container .tbl-template-highlight').select('rect').remove();\n      })\n      .on('click', function (event: any, node: any) {\n        event.stopPropagation();\n        const d = node as NodeData;\n        // d3.selectAll('.type-node').classed('selection', false);\n        tableStore.clearStatus(\"tree\");\n        if (d.id) {\n          tableStore.editor.mappingSpec.instance?.setValue(tableStore.editor.mappingSpec.codePref + tableStore.stringifySpec(null, \"even\", false));\n          d3.select(this).classed('selection', true);\n          // console.log(event, d);\n          // [startRow, startCol, endRow, endCol]\n          const visData = d.data as VisTreeNode;\n          const matchArea: Array<[number, number, number, number]> = [];\n          visData.matchs?.forEach((match) => {\n            const { x, y, width, height } = match;\n            matchArea.push([y, x, y + height - 1, x + width - 1]);\n          })\n          let allHightedInCells: TblCell[] = [];\n          let allHightedOutCells: TblCell[] = [];\n          if (matchArea.length > 0) {\n            const { selectedCoords, hightedCells } = tableStore.getHightlightedCells(matchArea, `${visData.type}Shallow`);\n            allHightedInCells = allHightedInCells.concat(hightedCells);\n            const cells = tableStore.in_out_mapping(selectedCoords, \"input_tbl\", `${visData.type}Shallow`);\n            allHightedOutCells = allHightedOutCells.concat(cells);\n            tableStore.highlightMinimapCells(hightedCells);\n          }\n\n          const selected: Array<[number, number, number, number]> = [[visData.y, visData.x, visData.y + visData.height - 1, visData.x + visData.width - 1]];\n          const { selectedCoords, hightedCells } = tableStore.getHightlightedCells(selected, visData.type!);\n          allHightedInCells = allHightedInCells.concat(hightedCells);\n          tableStore.highlightTblCells(\"input_tbl\", allHightedInCells, Object.values(selectedCoords)[0]);\n          const cells = tableStore.in_out_mapping(selectedCoords, \"input_tbl\", visData.type);\n          allHightedOutCells = allHightedOutCells.concat(cells);\n          tableStore.highlightTblCells(\"output_tbl\", allHightedOutCells);\n          tableStore.highlightMinimapCells(hightedCells, matchArea.length === 0);\n          // 在 D3.js 中，使用 .classed() 方法为元素添加类时，如果一个元素同时拥有多个类，CSS 样式的优先级依赖于 CSS 样式表中的定义顺序，而不是你通过 D3.js 添加类的顺序。\n\n          tableStore.input_tbl.instance.deselectCell();\n          tableStore.output_tbl.instance.deselectCell();\n\n          /************** 与 monaco editor 交互 ***************/\n          const subTemplate = tableStore.getNodebyPath(tableStore.spec.rawSpecs, visData.path!);\n          const [startLine, endLine] = tableStore.getHighlightCodeStartEndLine(subTemplate);\n          tableStore.highlightCode(startLine, endLine, `${visData.type}Shallow`);\n        } else {\n          // tableStore.editor.mappingSpec.decorations?.clear();\n          // 将事件分发到目标元素或整个文档\n          document.dispatchEvent(escapeEvent);\n          // d3.select(this).classed('selection', true);\n        }\n        return;\n        // this.handleCircleClick(event, d);  // 收缩节点\n      });\n\n\n    /*\n    nodeUpdate.select('.edge-text')\n      .attr('fill', edgeTextStyle.color)\n      .attr('font-size', edgeTextStyle.fontSize)\n      .text(({ data: info }: any) => typeFeatureMapIcon(info.dataTypeFeature))\n      .attr('x', ({ data: info }: any) => {\n        if (this.orient === 'h') {\n          return (info.dataTypeText ? -info.nodeWidth / 2 : -info.nodeCircleRadius) - 15;\n        }\n        return edgeTextStyle.distFromEdge;\n      })\n      .attr('y', ({ data: info }: any) => (this.orient === 'h' ? -edgeTextStyle.distFromEdge + info.shiftFromEndCenter : -info.nodeHeight / 2 - 2));\n    */\n    // ************************************exit 节点************************************\n    const nodeExitTransition = nodesSelection.exit()\n      .attr('opacity', 1)\n      .transition()\n      .duration(this.duration)\n      .attr('transform', `translate(${x},${y})`)\n      .on('end', function (this: any) {\n        d3.select(this)\n          .remove();\n      })\n      .attr('opacity', 0);\n\n    // Store the old positions for transition.\n    nodesData.forEach((d: any) => {\n      d.x0 = d.x;\n      d.y0 = d.y;\n    });\n\n    const offsetX = Math.max((this.svgWidth - realChartWidth) / 2, 0) - typeNodeStyle.nodeCircleRadius;\n    const offsetY = Math.max((this.svgHeight - this.realChart.node()!.getBBox().height) / 2, 0);\n    this.centerG.attr('transform', `translate(${offsetX}, ${offsetY})`); // Center the matrix\n  }\n}\n","export const typeMapColor = {\n  // Pattern selection\n  position: 'rgba(106, 176, 76)',    // '#6ab04c',\n  positionShallow: 'rgba(106, 176, 76, 0.65)',// '#badc58'\n  context: 'rgba(240, 147, 43)', // '#f0932b', \n  contextShallow: 'rgba(240, 147, 43, 0.65)', // '#ffbe76'\n  value: 'rgba(34, 166, 179)', // '#22a6b3',\n  valueShallow: 'rgba(34, 166, 179, 0.65)', // '#7ed6df'\n  null: 'rgba(131, 149, 167)', // '#8395a7',\n  nullShallow: 'rgba(131, 149, 167, 0.65)', // '#c8d6e5',\n  // Table selection\n  selection: 'rgba(9, 132, 227)',  // '#0984e3',\n  selectionShallow: 'rgba(9, 132, 227, 0.65)',\n\n  positionRGBA: 'rgba(106, 176, 76, 0.5)',\n  contextRGBA: 'rgba(240, 147, 43, 0.5)',\n  valueRGBA: 'rgba(34, 166, 179, 0.5)',\n  nullRGBA: 'rgba(131, 149, 167, 0.5)',\n  selectionRGBA: 'rgba(9, 132, 227, 0.5)',\n\n  ambiguousText: '#f9f7ff', // 'rgba(233, 16, 16, 0.5)',\n\n  // Minimap\n  cellFill: '#f9f7ff',\n  cellStroke: '#cccccc',\n};\n\nexport type TypeColor = keyof typeof typeMapColor;\n\n// Dictionary: '#83b5ed',\n// Array: '#7EAA55',\n// String: '#D07C94',\n// Number: '#EEB189',\n// Boolean: '#926EB8',\n// Null: '#E7D6D6',\n\n/*\nexport const colorConfig = {\n  \"posi-mapping\": {\n    fill: '#0984e3',\n    stroke: '#0984e3',\n    text: '#fff',\n  },\n  \"posi-mapping-shallow\": {\n    fill: '#74b9ff',\n    stroke: '#74b9ff',\n    text: '#fff',\n  },\n  \"ambiguous-cell\": {\n    fill: '#83e4aa',\n    stroke: '#83e4aa',\n    text: '#e91010',\n  },\n  \"determined-cell\": {\n    fill: '#37bc6c',\n    stroke: '#37bc6c',\n    text: '#e91010',\n    weight: 'bold',\n  },\n  \"default\": {\n    fill: '#f9f7ff',\n    stroke: '#cccccc',\n    text: '#000',\n  }\n}\n*/\n\nexport const typeNodeStyle = {\n  nodeWidth: 96, // 100,\n  nodeHeight: 30,\n  nodeRectFillColor: \"#7EAA55\",\n  nodeCircleFillColor: \"#83b5ed\",\n  nodeCircleRadius: 15,\n  nodeBorderRadius: 5,\n  verticalLineLength: 40,\n  verticalLineWidth: 5,\n  nodeSpacing: 30,\n  connectorLineColor: '#0000004D', // 树中link的颜色\n  connectorLineWidth: 1.5,\n  iconsize: 15, // 树中node上侧constraint icon的大小\n  iconPadding: 10,  // 树中node上侧constraint icon的间距\n};\n\nexport const nodeTextStyle = {\n  color: 'white',\n  fontSize: 15,\n  yAxisAdjust: 2,\n};","export interface ChatMessage {\n    role: string\n    content: string\n}\n\nexport class CustomError extends Error {\n    constructor(message: string, name: string = \"CustomError\") {\n        super(message);\n        this.name = name;\n        Object.setPrototypeOf(this, new.target.prototype);\n    }\n}\n\n\n// The Declarative Grammar v0.2\n\n/**\n * PositionFn: (pi: Position2D, areaCells: AreaCellInfo[])\n * For startCell and endCell:\n *   pi is the instance index that matches this template (pi.row means traverse in the row direction, pi.col means traverse in the col direction)\n *   areaCells contains all the selected cells of parent template area\n * For context:\n *   pi is the cell index position of this template area\n *   areaCells contains all the selected cells of this template area\n */\ntype PositionFn = (pi: Position2D, areaCells: AreaCellInfo[]) => Position\n\n/**\n * Set rules for value, if return false, means the value does not meet the rule\n */\ntype CheckValueFn = (value: string) => boolean\n\n/**\n * Derive the target variable based on the selected/context cells\n * vi: the cell index of this template area\n * areaCells: all selected cells of this template area\n * contextCells: the context cells corresponding to the selected cells of this template area (Note that there may be multiple context cells for each selected cell, so contextCells is a 2D array)\n */\ntype DeriveTargetFn = (vi: number, areaCells: AreaCellInfo[], contextCells: AreaCellInfo[][]) => string | string[]\n\ninterface Position {\n    // If null, means no rule for row/col\n    row?: number | null,\n    col?: number | null\n}\n\ninterface Position2D {\n    row: number\n    col: number\n}\n\n/**\n * For startCell and endCell:\n * if position is not null, means involving position-based selection\n * if value is not null, means involving value-based selection\n */\ntype CellInfo = {\n    position: Position | PositionFn,\n    value?: CheckValueFn | string // | number | null\n}\n\ntype AreaCellInfo = {\n    position: Position2D,\n    value: string // string | number | null\n}\n\ninterface TableTidierMapping {\n    startCell?: CellInfo,\n    endCell?: CellInfo,\n    // if context is not null, means involving value-based selection\n    context?: CellInfo[],\n    subMapping?: TableTidierMapping[],\n    // if target is string or string[], means position-based mapping;\n    // if target is function, means value-based or context-based mapping;\n    target?: string | string[] | DeriveTargetFn\n}\n\n\n// The Declarative Grammar v0.3\n\ntype cellValueType = string | number;\n\nenum TableTidierKeyWords {\n    String,\n    Number,\n    None\n}\n\n// Function types\n\n/**\n * A function type that calculates an offset based on the current area information and the root area information.\n * @param currentAreaInfo - The current area information.\n * @param rootAreaInfo - The root area information.\n * @returns The calculated offset.\n */\ntype offsetFn = (currentAreaInfo: AreaInfo, rootAreaInfo: AreaInfo) => number;\n\n/**\n * A function type that checks if a cell value meets a custom condition.\n * @param value - The value of the cell.\n * @returns A boolean indicating whether the cell value meets the condition.\n */\ntype checkValueFn = (value: cellValueType) => boolean;\n\n/**\n * A function type that maps the cells in an area to their corresponding target columns.\n * @param currentAreaCells - The cells in the current area.\n * @returns An array of target column names or null values.\n */\ntype mapColsFn = (currentAreaCells: AreaCell[]) => (string | null)[];\n\n/**\n * A function type that maps a context value to a target column.\n * @param contextValue - The value of the context cell.\n * @returns The name of the target column or null.\n */\ntype mapColbyContextFn = (contextValue: cellValueType) => string | null;\n\n/**\n * A function type that selects a range of cells based on the current area information and the root area information.\n * @param currentAreaInfo - The current area information.\n * @param rootAreaInfo - The root area information.\n * @returns An array of cell selections.\n */\ntype contextPosiFn = (currentAreaInfo: AreaInfo, rootAreaInfo: AreaInfo) => CellSelection[];\n\n/**\n * A function type that determines the layer of an area based on its current area information.\n * @param currentAreaInfo - The current area information.\n * @returns The layer number of the area.\n */\ntype areaLayerFn = (currentAreaInfo: AreaInfo) => number;\n\n// Represents a single cell within an area\ninterface AreaCell {\n    xOffset: number;   // The x-axis offset of the cell within the area\n    yOffset: number;   // The y-axis offset of the cell within the area\n    value: cellValueType;  // The value of the cell\n}\n\n// Represents a selected area within the table\ninterface AreaInfo {\n    parent: AreaInfo | null;  // The parent area of this area\n    areaLayer: number;        // The layer level of this area within the root area\n    templateIndex: number;    // The template index of this area within the parent area\n    xIndex: number;           // The x-axis index of this area within the parent area\n    yIndex: number;           // The y-axis index of this area within the parent area\n    xOffset: number;          // The x-axis offset of this area within the parent area\n    yOffset: number;          // The y-axis offset of this area within the parent area\n    x: number;                // The x-coordinate of this area within the entire table\n    y: number;                // The y-coordinate of this area within the entire table\n    width: number;            // The width of this area\n    height: number;           // The height of this area\n    areaCells: AreaCell[];    // All cells within this area\n    children: AreaInfo[];     // The child areas of this area\n}\n\n// Represents the selection of a cell within the table\ninterface CellSelection {\n    referenceAreaLayer?: 'current' | 'parent' | 'root' | areaLayerFn;  // The reference area layer for selection, default is 'current'\n    referenceAreaPosi?: 'topLeft' | 'bottomLeft' | 'topRight' | 'bottomRight';  // The reference area position for selection, default is 'topLeft'\n    xOffset?: number | offsetFn;  // The x-axis offset relative to the reference area, default is 0\n    yOffset?: number | offsetFn;  // The y-axis offset relative to the reference area, default is 0\n}\n\n/**\n* Represents a constraint on a cell's value\n* - `valueCstr`: The value constraint.\n*   - `cellValueType`: Specifies that the cell's value must be equal to the provided value.\n*   - `TableTidierKeyWords`: Specifies that the cell's value must be of the specified type (`String` or `Number`).\n*   - `checkValueFn`: Specifies a custom function to check if the cell's value meets certain conditions.\n*/\ninterface CellConstraint extends CellSelection {\n    // The value constraint can be a specific value, a type (string or number), or a custom check function\n    valueCstr: cellValueType | TableTidierKeyWords | checkValueFn;\n}\n\n/**\n * ContextTransform specifies how to derive the target column for a cell based on its context cell.\n * \n * - `position`: Defines the location of the context cell relative to the current cell.\n *   - 'above': The context cell is located directly above the current cell.\n *   - 'below': The context cell is located directly below the current cell.\n *   - 'left': The context cell is located directly to the left of the current cell.\n *   - 'right': The context cell is located directly to the right of the current cell.\n *   - `contextPosiFn`: A custom function to determine the position of the context cell.\n * \n * - `targetCol`: Determines how to derive the target column based on the context cell's value.\n *   - null: Uses the context cell's value as the target column. If the context cell's value is null or empty, the target column will be null, and this cell will not be transformed to the output table.\n *   - `mapColbyContextFn`: A custom function to map the context cell's value to a specific target column. If the function returns null, the cell will not be transformed to the output table.\n */\ninterface ContextTransform {\n    position: 'above' | 'below' | 'left' | 'right' | contextPosiFn;\n    targetCol: null | mapColbyContextFn;\n}\n\n\n// The main template for defining the transformation rules\ninterface TableTidierTemplate {\n    startCell: CellSelection;  // The starting cell for the selection\n    size?: {\n        width?: number | 'toParentX' | undefined;  // The width of the selection area, 'toParentX' means the distance from the startCell to the parent's x-axis end; undefined means no width constraint, default is 1\n        height?: number | 'toParentY' | undefined; // The height of the selection area, 'toParentY' means the distance from the startCell to the parent's y-axis end; undefined means no height constraint, default is 1\n    };\n    constraints?: CellConstraint[];  // Constraints to apply to the cells within the selection area\n    traverse?: {\n        // The traversal direction for the selection area: 'after' means traversing after the startCell; 'before' means traversing before the startCell; 'whole' means traversing the entire area; default is 'none', meaning no traversal\n        xDirection?: 'none' | 'after' | 'before' | 'whole';  // The x-axis traversal direction \n        yDirection?: 'none' | 'after' | 'before' | 'whole';  // The y-axis traversal direction\n    };\n    transform?: {\n        context?: ContextTransform;  // The context-based transformation for the selection area\n        // The target columns for the transformation, which can be an array (position-based transformation), 'context' (context-based transformation), or a custom function (value-based transformation)\n        targetCols: (string | null)[] | 'context' | mapColsFn;\n    };\n    children?: TableTidierTemplate[];  // The child templates for nested selections\n}\n\n\n\ntype Pair = { value: number, originalIndex: number, correspondingValue: string };\n\nfunction sortWithCorrespondingArray(A: any[], B: string[], sortOrder: 'asc' | 'desc'): string[] {\n    // Create a combined array of objects\n    let combined: Pair[] = A.map((value, index) => ({\n        value: value,\n        originalIndex: index,\n        correspondingValue: B[index]\n    }));\n\n    // Sort the combined array based on the value in the specified order\n    combined.sort((a, b) => {\n        if (sortOrder === 'asc') {\n            return a.value - b.value;\n        } else {\n            return b.value - a.value;\n        }\n    });\n\n    // Extract the sorted corresponding values based on the original indices\n    let sortedB: string[] = new Array(B.length);\n    combined.forEach((pair, index) => {\n        sortedB[pair.originalIndex] = pair.correspondingValue;\n    });\n\n    return sortedB;\n}","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 89387;\nmodule.exports = webpackEmptyContext;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdO = {};","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"js/\" + chunkId + \".\" + {\"9\":\"92b25fd5\",\"293\":\"cc93782e\",\"703\":\"6b8db0f6\",\"1034\":\"42caa4ea\",\"1157\":\"54c726b5\",\"1461\":\"e92bc401\",\"1477\":\"290bd091\",\"1813\":\"2f919813\",\"1915\":\"ee11ac6c\",\"2149\":\"c17c85f9\",\"2365\":\"7690613b\",\"2412\":\"11ebdadd\",\"2501\":\"cdbbcd03\",\"2591\":\"2f6c9f6b\",\"2689\":\"caa4fbec\",\"2709\":\"64937498\",\"2799\":\"184b412d\",\"2965\":\"d2f616e1\",\"2999\":\"3dc7f79c\",\"3051\":\"41b30810\",\"3061\":\"95be68c2\",\"3071\":\"70d11158\",\"3445\":\"be87e6ab\",\"3473\":\"fb9ef58c\",\"3577\":\"bb18787e\",\"3691\":\"80364a2e\",\"3717\":\"bf6e5d9f\",\"3753\":\"6c4ee3f4\",\"3765\":\"1d3c04a7\",\"3775\":\"432c2d2c\",\"3948\":\"55fdd701\",\"4205\":\"df37ef01\",\"4261\":\"e3ee4d76\",\"4341\":\"e3ef6b64\",\"4373\":\"b41ecc24\",\"4485\":\"3ee3fb7e\",\"4605\":\"41a293b9\",\"4621\":\"3f170eab\",\"4805\":\"d62fc659\",\"4977\":\"c1e040d7\",\"5077\":\"d5031a10\",\"5081\":\"190db17a\",\"5083\":\"98214cf7\",\"5093\":\"be4234f2\",\"5282\":\"b3f08c25\",\"5285\":\"d0610360\",\"5287\":\"3fa9d8e8\",\"5303\":\"8de5c195\",\"5365\":\"56361d2a\",\"5521\":\"cf7ee881\",\"5589\":\"bcad7c5b\",\"5609\":\"9e498ec2\",\"5653\":\"70962a1f\",\"5749\":\"738a857e\",\"5841\":\"06c82430\",\"6059\":\"200d1502\",\"6121\":\"692266a1\",\"6181\":\"fdb9b6c9\",\"6229\":\"e201920c\",\"6309\":\"6df26518\",\"6325\":\"89f2a27d\",\"6613\":\"4cf1f45b\",\"6757\":\"29e39d58\",\"6821\":\"0225ad68\",\"6845\":\"9f91df90\",\"7045\":\"5a9df01c\",\"7217\":\"553f17c6\",\"7219\":\"a0db5f28\",\"7449\":\"e83e23a9\",\"7461\":\"0f9bd863\",\"7525\":\"c9755306\",\"7623\":\"4889f846\",\"7641\":\"dceb5361\",\"8175\":\"e179abe0\",\"8285\":\"abbe3a02\",\"8329\":\"0778de39\",\"8387\":\"e5098648\",\"8533\":\"4847834f\",\"8653\":\"de07fe1d\",\"8981\":\"61e6e714\",\"9009\":\"7586e475\",\"9437\":\"47c6455f\",\"9445\":\"be745b28\",\"9626\":\"b86e75d4\",\"9717\":\"3e641f4d\"}[chunkId] + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var inProgress = {};\nvar dataWebpackPrefix = \"TableTidier:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.p = \"/TableTidier/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t3524: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkTableTidier\"] = self[\"webpackChunkTableTidier\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], function() { return __webpack_require__(52323); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","_hoisted_1","class","style","_hoisted_2","_hoisted_3","_createElementVNode","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_defineComponent","__name","setup","__props","tableStore","useTableStore","menuList","computed","tree","contextMenuVisible","length","contextMenuVisibleChange","value","closeContextMenu","visNode","spec","selectNode","data","extract","extractColor","triggerCellCursorFlag","messageInfo","maxCNum","findMaxCNumber","key","byPositionToTargetCols","Array","from","width","height","_","i","byContext","position","createExtract","eval","byValue","insertNodeOrPropertyIntoSpecs","undefined","deleteChildByPath","rawSpecs","path","stringifySpec","selectConstrIndex","editor","mappingSpec","highlightCode","getHighlightCodeStartEndLine","getNodebyPath","message","info","selectAreaFromNode","document","body","cursor","documentElement","setProperty","cells","generateHighlightCells","selectionsAreaFromLegend","selectAreaFromLegend","highlightTblCells","treeContainer","ref","drawTree2","drawTree","visTree","drawTblTemplate","treeInstance","TreeChart","render","visInst","typeMap","selectMatchExtractArea","type","d3","classed","selectionsFromLegend","selectFromLegend","push","tblContainer","offsetX","offsetY","transformStatue","zoom","selectAll","remove","visChildren","children","containerWidth","clientWidth","containerHeight","clientHeight","cellWidth","Math","max","min","floor","cellHeight","on","event","attr","transform","x","y","k","updateCellTextVisibility","svg","append","call","matrix","texts","grids","computeTblPatternGrid","enter","d","col","row","bgColor","this","raise","dispatch","highlightNodes","input_tbl","instance","deselectCell","output_tbl","text","typeMapColor","positionShallow","toString","node","getBBox","scale","scaledCellWidth","scaledCellHeight","textColor","cellFill","each","textElement","textLength","getComputedTextLength","slice","tblVisHighlight","tblVisInfo","console","error","watch","newVal","setValue","setFlag","prepareDataAfterCodeChange","transformTablebyCode","onMounted","_ctx","_cache","_component_a_button","_resolveComponent","_component_a_button_group","_component_v_icon","_component_a_menu","_component_a_dropdown","_openBlock","_createElementBlock","_createVNode","default","_withCtx","size","onClick","$event","title","_createTextVNode","name","ref_key","trigger","open","onOpenChange","overlay","items","TableTidierKeyWords","String","Number","None","NotNone","Forward","Auto","pairSort","sortWithCorrespondingArray","A","B","sortOrder","indexedA","index","sort","a","b","sortedB","forEach","DEFAULT_WIDTH","DEFAULT_HEIGHT","DEFAULT_REFERENCE_AREA_LAYER","DEFAULT_REFERENCE_AREA_POSI","DEFAULT_X_OFFSET","DEFAULT_Y_OFFSET","DEFAULT_X_DIRECTION","DEFAULT_Y_DIRECTION","DEFAULT_CONTEXT_POSITION","DEFAULT_TARGET_COL","ctxCells","DEFAULT_VALUE_CSTR","DEFAULT_IGNORE_OUT_OF_BOUNDS","DEFAULT_FILL","completeCellSelection","selection","referenceAreaLayer","referenceAreaPosi","xOffset","yOffset","completeCellConstraint","constraint","completedSelection","valueCstr","ignoreOutOfBounds","completeContextTransform","toTargetCol","completeSpecification","template","match","startCell","constraints","traverse","xDirection","yDirection","fill","serialize","obj","seen","WeakSet","JSON","stringify","has","add","evaluateConstraint","cellValue","isNaN","calculateOffset","offset","currentArea","rootArea","getCellBySelect","select","constrFlag","area","parent","layer","areaLayer","li","cellPosi","errorMessage","CustomError","areaTbl","calculateSize","startX","startY","getSubArea","table","subArea","fillColumns","tidyData","maxLength","values","column","fillValue","traverseArea","endX","endY","traverseFlag","currentStartX","currentEndX","currentStartY","currentEndY","tmpArea","areaHeight","areaWidth","matchArea","instanceIndex","xIndex","yIndex","cellInfo","templateRef","cstr","transformArea","cellArray","flat","transformedCols","context","ctxCols","ctxCellsInfo","ctxSelections","ri","cell","ci","ctxPosiFn","customSelections","customSelectionsWithDefaults","cellCtxs","cellCtxsInfo","log","customMapColbyCxt","targetCol","hasOwnProperty","processTemplate","templateIndex","matchTemplateArea","filter","areaChild","templateChild","ti","transformTable","specs","specWithDefaults","_createStaticVNode","$props","$setup","$data","$options","_component_panel_view","_Fragment","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","registerAllModules","output_col","cols","tbl","inHotInst","outHotInst","renderTblCell","td","prop","cellProperties","Handsontable","renderers","TextRenderer","apply","arguments","innerHTML","fileList","fileTblData","handleUpload","request","reader","FileReader","onload","arrayBuffer","target","result","workbook","XLSX","firstSheetName","SheetNames","worksheet","Sheets","rawData","sheet_to_json","header","maxColumns","handlePreview","onSuccess","readAsArrayBuffer","file","saveLastCase","handleRemove","initTblInfo","transformTblUpdateRootArea","currentCase","caseList","pop","updateData","startsWith","includes","arrayToCSV","array","join","loadCaseData","handleDownload","warning","csv","blob","Blob","url","URL","createObjectURL","createElement","href","download","appendChild","click","removeChild","revokeObjectURL","success","normalizeSelection","selections","row1","col1","row2","col2","startRow","endRow","startCol","endCol","initEventsForTbl","tblInst1","tblInst2","tbl2","updateSettings","outsideClickDeselects","targetEle","targetClassName","className","some","c","split","clearStatus","highlightMinimapCells","decorations","clear","addHook","coords","TD","specMode","selected","getSelected","selectedCoords","hightedCells","getHightlightedCells","in_out_mapping","selectType","nx","ny","nw","nh","currentSpec","getDataAtCell","getCellDataType","selectionsPath","buildTree","proxy","getCurrentInstance","$refs","inputTbl","hotInstance","outputTbl","_component_a_upload","accept","customRequest","onRemove","onPreview","showUploadList","showRemoveIcon","_unref","HotTable","rowHeaders","colHeaders","manualColumnResize","autoWrapRow","autoWrapCol","contextMenu","renderer","licenseKey","__exports__","props","codeType","editorDefaultOptions","language","theme","fontSize","glyphMargin","automaticLayout","autoIndent","readOnly","minimap","enabled","lineNumbersMinChars","scrollBeyondLastLine","padding","bottom","editorWrapper","regex","areStringEqual","str1","str2","replace","initEditor","dispose","editorOptions","monaco","create","onDidBlurEditorText","checkGrammarError","errorMark","getValue","undoHistory","redoHistory","onDidChangeModelContent","libUri","existingModel","getModels","find","model","uri","fetch","then","response","tsContent","typescript","javascriptDefaults","setDiagnosticsOptions","noSemanticValidation","noSyntaxValidation","setCompilerOptions","ScriptTarget","ES2015","allowNonTsExtensions","addExtraLib","createModel","parse","createDecorationsCollection","onUnmounted","container","resetZoom","transition","duration","drawGrid","rows","generateGrid","grid_cell_click","areaConfig","formData","areaFormData","handleOk","handleCancel","selectArea","dragConfigOpen","modalTitleRef","isDragging","useDraggable","startedDrag","transformX","transformY","preTransformX","preTransformY","dragRect","left","right","top","bodyRect","getBoundingClientRect","titleRect","watchEffect","transformStyle","_component_a_divider","_component_a_col","_component_a_radio_button","_component_a_radio_group","_component_a_row","_component_a_modal","_createBlock","overflow","onCancel","onOk","okText","modalRender","originVNode","_normalizeStyle","_resolveDynamicComponent","flex","_toDisplayString","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","caseOption","v","label","codePanel","loading","undoFlag","redoFlag","undo","lastSpec","redo","lastUndo","handleKeydown","handleCaseChange","isDropdownOpen","timeHandler","dropdownListEle","selectEnter","setTimeout","querySelector","addEventListener","clearTimeout","selectLeave","_component_a_select","_component_a_tab_pane","_component_a_tabs","options","onChange","onMouseenter","onMouseleave","disabled","InOutTable","Minimap","PatternVis","activeKey","tab","CodeView","DraggableModal","defineComponent","components","PanelView","pinia","createPinia","app","createApp","App","use","Select","Tabs","Button","Upload","Tooltip","Popover","Input","Modal","Space","Dropdown","Menu","Form","Row","Col","Radio","Divider","addIcons","BiUpload","BiDownload","LaRocketSolid","BiArrowClockwise","IoArrowUndoOutline","IoArrowRedoOutline","component","OhVueIcon","mount","replaceEvenSpaces","str","halfLength","repeat","removeWhitespace","csvToMatrix","csvText","trim","removeSpaceType","even","all","defineStore","state","shallowRef","visTreeMatchPath","constrNodeRectClickId","codePref","codeSuff","object","in2out","in2nodes","out2in","menuAllList","color","actions","caseN","prompt","case_path","data_res","spec_res","Promise","dataText","specText","ok","msg","traverseTree4UpdateMatchs","nodes","matchs","cellInfoSelections","constrsInfo","allConstr","traverseTree4UpdateIn2Nodes","parentPath","idCounter","currentPath","areaKey","Set","classNames","range","topLeft","rowSize","colSize","startPoint","visibleRows","countVisibleRows","visibleCols","countVisibleCols","scrollViewportTo","verticalSnap","horizontalSnap","posi_mapping","posi","pi","concat","endsWith","pi_n","doRectanglesIntersect","rect1","rect2","isRectanglesContained","child","pStartRow","pStartCol","pEndRow","pEndCol","cStartRow","cStartCol","cEndRow","cEndCol","arr","maxNumber","ele","number","parseInt","types","paths","rootNodes","insertNode","existingChild","newNode","added","rootNode","traverseTree4buildSpecs","pSelection","px","py","pw","ph","newSpec","targetNode","copyAttributes","highlightNodesId","keyArea","n","highlightTblTemplate","highlight","outTblCells","points","current","ts","compilerOptions","CommonJS","evalFunction","Function","outputText","copyTreeAttributes","numberToOrdinal","num","suffix","markers","getModelMarkers","marker","startLineNumber","startColumn","messageContent","derivePosiMapping","outTbl","numRows","j","inPosi","outPosi","grid","firstNode","box","shift","outY","outX","inputFlag","constrIndex","currentNode","splice","lastIndex","parentNode","currentNodes","replaceSpace","replaceCode","fnList","strSpec","replacer","fn","removeQuotesFromKeysRegex","replaceTableTidierKeyWordsRegex","nodeOrProperty","property","assign","source","attributes","tree1","tree2","sonData","sonParentData","rootData","rootStr","sonStr","startIndex","indexOf","strBefore","startLine","endLine","startParentLine","startConstLine","endConstLine","decorationsCollection","newDecorations","isWholeLine","set","revealRangeAtTop","getters","escapeEvent","KeyboardEvent","keyCode","charCode","which","bubbles","cancelable","customRectCorner","rectInfo","startx","starty","rectWidth","rectHeight","rounded","radius","declareContextMenu","preventDefault","constructor","_margins","_container","_data","_store","_zoomLevel","_orient","_defineProperty","svgWidth","svgHeight","margins","zoomLevel","orient","depth","calculated","treeLayout","realChart","previousTransform","centerX","root","allNodes","defaultFont","store","zoomed","bind","setZoomFactor","batchEnterExitUpdate","currentWidth","centerG","targetZoomLevel","nodeMaxWidth","centerY","nodeMaxHeight","prototype","patternify","selectedTag","tag","selector","tmpData","targetData","batchSelection","exit","mergedSelection","merge","drawingContainer","replaceChildren","drawingContainerBoundry","typeNodeStyle","nodeWidth","nodeHeight","random","chartVerticalMargin","chartHorizontalMargin","chartWidth","chartHeight","nodeSize","nodeSpacing","isArray","nodeId","parentId","parentNodeId","x0","y0","zoomfunc","chart","update","treeData","linksData","descendants","nodesData","originalX","nodeCircleRadius","linksSelection","linkGen","linksEnter","insert","linkUpdate","connectorLineWidth","connectorLineColor","realChartWidth","xshiftStart","yshiftStart","xshiftEnd","yshiftEnd","nodesSelection","nodeEnter","nodeGroups","nodeUpdate","nodeRectData","singleNodeG","tooltipText","_constraint","iconsz","iconsize","constrId","constrNodeRect","subTemplate","iconPadding","iconPath","require","_e","dispatchEvent","nodeTextStyle","yAxisAdjust","stopPropagation","visData","allHightedInCells","allHightedOutCells","contextShallow","valueShallow","null","nullShallow","selectionShallow","positionRGBA","contextRGBA","valueRGBA","nullRGBA","selectionRGBA","ambiguousText","cellStroke","nodeRectFillColor","nodeCircleFillColor","nodeBorderRadius","verticalLineLength","verticalLineWidth","super","setPrototypeOf","webpackEmptyContext","__webpack_module_cache__","moduleId","cachedModule","loaded","__webpack_modules__","m","amdO","deferred","O","chunkIds","priority","notFulfilled","Infinity","fulfilled","every","r","getter","__esModule","definition","defineProperty","enumerable","get","f","chunkId","reduce","promises","u","miniCssF","g","globalThis","window","inProgress","dataWebpackPrefix","l","done","script","needAttach","scripts","getElementsByTagName","s","getAttribute","charset","timeout","nc","setAttribute","src","onScriptComplete","prev","onerror","doneFns","head","Symbol","toStringTag","nmd","p","installedChunks","installedChunkData","promise","reject","loadingEnded","errorType","realSrc","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}