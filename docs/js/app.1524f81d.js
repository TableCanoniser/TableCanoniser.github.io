(function(){var t={35358:function(t,e,n){var s={"./af":22190,"./af.js":22190,"./ar":7218,"./ar-dz":85785,"./ar-dz.js":85785,"./ar-kw":29417,"./ar-kw.js":29417,"./ar-ly":56904,"./ar-ly.js":56904,"./ar-ma":98617,"./ar-ma.js":98617,"./ar-ps":91318,"./ar-ps.js":91318,"./ar-sa":82699,"./ar-sa.js":82699,"./ar-tn":36789,"./ar-tn.js":36789,"./ar.js":7218,"./az":23050,"./az.js":23050,"./be":8316,"./be.js":8316,"./bg":70310,"./bg.js":70310,"./bm":58884,"./bm.js":58884,"./bn":83469,"./bn-bd":46672,"./bn-bd.js":46672,"./bn.js":83469,"./bo":39118,"./bo.js":39118,"./br":13113,"./br.js":13113,"./bs":23626,"./bs.js":23626,"./ca":40921,"./ca.js":40921,"./cs":17799,"./cs.js":17799,"./cv":12828,"./cv.js":12828,"./cy":93521,"./cy.js":93521,"./da":56962,"./da.js":56962,"./de":93294,"./de-at":16158,"./de-at.js":16158,"./de-ch":95960,"./de-ch.js":95960,"./de.js":93294,"./dv":47963,"./dv.js":47963,"./el":3432,"./el.js":3432,"./en-au":20998,"./en-au.js":20998,"./en-ca":15931,"./en-ca.js":15931,"./en-gb":45930,"./en-gb.js":45930,"./en-ie":58081,"./en-ie.js":58081,"./en-il":71594,"./en-il.js":71594,"./en-in":23904,"./en-in.js":23904,"./en-nz":1507,"./en-nz.js":1507,"./en-sg":19409,"./en-sg.js":19409,"./eo":22177,"./eo.js":22177,"./es":84805,"./es-do":39155,"./es-do.js":39155,"./es-mx":69791,"./es-mx.js":69791,"./es-us":76098,"./es-us.js":76098,"./es.js":84805,"./et":96240,"./et.js":96240,"./eu":20391,"./eu.js":20391,"./fa":20612,"./fa.js":20612,"./fi":4220,"./fi.js":4220,"./fil":65570,"./fil.js":65570,"./fo":5466,"./fo.js":5466,"./fr":14461,"./fr-ca":66306,"./fr-ca.js":66306,"./fr-ch":27081,"./fr-ch.js":27081,"./fr.js":14461,"./fy":73484,"./fy.js":73484,"./ga":76957,"./ga.js":76957,"./gd":72978,"./gd.js":72978,"./gl":89866,"./gl.js":89866,"./gom-deva":65011,"./gom-deva.js":65011,"./gom-latn":84724,"./gom-latn.js":84724,"./gu":71601,"./gu.js":71601,"./he":79802,"./he.js":79802,"./hi":9358,"./hi.js":9358,"./hr":13907,"./hr.js":13907,"./hu":10218,"./hu.js":10218,"./hy-am":20533,"./hy-am.js":20533,"./id":52844,"./id.js":52844,"./is":97353,"./is.js":97353,"./it":6364,"./it-ch":20774,"./it-ch.js":20774,"./it.js":6364,"./ja":6008,"./ja.js":6008,"./jv":68221,"./jv.js":68221,"./ka":92417,"./ka.js":92417,"./kk":42071,"./kk.js":42071,"./km":76149,"./km.js":76149,"./kn":94572,"./kn.js":94572,"./ko":60659,"./ko.js":60659,"./ku":66285,"./ku-kmr":59398,"./ku-kmr.js":59398,"./ku.js":66285,"./ky":81609,"./ky.js":81609,"./lb":119,"./lb.js":119,"./lo":81748,"./lo.js":81748,"./lt":71973,"./lt.js":71973,"./lv":81347,"./lv.js":81347,"./me":53023,"./me.js":53023,"./mi":65747,"./mi.js":65747,"./mk":64341,"./mk.js":64341,"./ml":63840,"./ml.js":63840,"./mn":62058,"./mn.js":62058,"./mr":19182,"./mr.js":19182,"./ms":45197,"./ms-my":89136,"./ms-my.js":89136,"./ms.js":45197,"./mt":36408,"./mt.js":36408,"./my":51683,"./my.js":51683,"./nb":53141,"./nb.js":53141,"./ne":29344,"./ne.js":29344,"./nl":44703,"./nl-be":84641,"./nl-be.js":84641,"./nl.js":44703,"./nn":79873,"./nn.js":79873,"./oc-lnc":61217,"./oc-lnc.js":61217,"./pa-in":24612,"./pa-in.js":24612,"./pl":24457,"./pl.js":24457,"./pt":1089,"./pt-br":79146,"./pt-br.js":79146,"./pt.js":1089,"./ro":45950,"./ro.js":45950,"./ru":27292,"./ru.js":27292,"./sd":56774,"./sd.js":56774,"./se":87493,"./se.js":87493,"./si":3761,"./si.js":3761,"./sk":49711,"./sk.js":49711,"./sl":88558,"./sl.js":88558,"./sq":8633,"./sq.js":8633,"./sr":90688,"./sr-cyrl":47903,"./sr-cyrl.js":47903,"./sr.js":90688,"./ss":31991,"./ss.js":31991,"./sv":27020,"./sv.js":27020,"./sw":15891,"./sw.js":15891,"./ta":45714,"./ta.js":45714,"./te":30206,"./te.js":30206,"./tet":24768,"./tet.js":24768,"./tg":28276,"./tg.js":28276,"./th":57977,"./th.js":57977,"./tk":56928,"./tk.js":56928,"./tl-ph":8046,"./tl-ph.js":8046,"./tlh":41361,"./tlh.js":41361,"./tr":64367,"./tr.js":64367,"./tzl":10627,"./tzl.js":10627,"./tzm":12636,"./tzm-latn":98148,"./tzm-latn.js":98148,"./tzm.js":12636,"./ug-cn":68823,"./ug-cn.js":68823,"./uk":40461,"./uk.js":40461,"./ur":41366,"./ur.js":41366,"./uz":83454,"./uz-latn":18374,"./uz-latn.js":18374,"./uz.js":83454,"./vi":78572,"./vi.js":78572,"./x-pseudo":80464,"./x-pseudo.js":80464,"./yo":93709,"./yo.js":93709,"./zh-cn":65873,"./zh-cn.js":65873,"./zh-hk":17549,"./zh-hk.js":17549,"./zh-mo":52240,"./zh-mo.js":52240,"./zh-tw":90405,"./zh-tw.js":90405};function a(t){var e=o(t);return n(e)}function o(t){if(!n.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}a.keys=function(){return Object.keys(s)},a.resolve=o,t.exports=a,a.id=35358},47930:function(t,e){"use strict";var n;e.gX=e.Pu=e.eV=void 0,function(t){t["String"]="TableTidier.String",t["Number"]="TableTidier.Number",t["None"]="TableTidier.None"}(n||(n={})),e.eV=n;const s=1,a=1,o="current",l="topLeft",r=0,i=0,c=null,u=null,f="top",d="cellValue",p=[],h=n.String,b=null;function m(t){return{referenceAreaLayer:t.referenceAreaLayer||o,referenceAreaPosi:t.referenceAreaPosi||l,xOffset:t.xOffset||r,yOffset:t.yOffset||i}}function v(t){const e=m(t);return Object.assign(Object.assign({},e),{valueCstr:t.valueCstr||h})}function g(t){return{position:t.position||f,targetCol:t.targetCol||d}}function y(t){var e,n,o,l,r,i;return{startCell:m(t.startCell),size:{width:void 0===(null===(e=t.size)||void 0===e?void 0:e.width)?s:t.size.width,height:void 0===(null===(n=t.size)||void 0===n?void 0:n.height)?a:t.size.height},constraints:(null===(o=t.constraints)||void 0===o?void 0:o.map(v))||[],traverse:{xDirection:void 0===(null===(l=t.traverse)||void 0===l?void 0:l.xDirection)?c:t.traverse.xDirection,yDirection:void 0===(null===(r=t.traverse)||void 0===r?void 0:r.yDirection)?u:t.traverse.yDirection},transform:t.transform?{context:t.transform.context?g(t.transform.context):null,targetCols:t.transform.targetCols||p}:null,fill:void 0===t.fill?b:t.fill,children:(null===(i=t.children)||void 0===i?void 0:i.map(y))||[]}}function j(t){return y(t)}e.gX=m,e.Pu=j},37340:function(t,e,n){"use strict";var s=n(45130),a=n(56768);const o={class:"wrapper"};function l(t,e,n,s,l,r){const i=(0,a.g2)("panel-view");return(0,a.uX)(),(0,a.CE)("div",o,[(0,a.bF)(i)])}var r=n(90144),i=n(30328),c=(n(19830),n(78945)),u=n(8153),f=(n(44114),n(93367)),d=n(14206),p=n(47930);function h(t,e,n){let s=t.map(((t,e)=>({value:t,index:e})));s.sort(((t,e)=>"asc"===n?t.value-e.value:e.value-t.value));let a=s.map((t=>e[t.index]));return a}const b=(t,e)=>"function"===typeof e.valueCstr?e.valueCstr(t):e.valueCstr===p.eV.String?"string"===typeof t&&""!==t&&isNaN(Number(t)):e.valueCstr===p.eV.Number?"number"===typeof t||"string"===typeof t&&""!==t&&!isNaN(Number(t)):e.valueCstr===p.eV.None?null===t||""===t:t===e.valueCstr,m=(t,e,n)=>"number"===typeof t?t:t(e,n),v=(t,e,n)=>{let s=e;if("current"===t.referenceAreaLayer)s=e;else if("root"===t.referenceAreaLayer)s=n;else if("parent"===t.referenceAreaLayer)s=e.parent;else{const n=e.areaLayer-t.referenceAreaLayer(e);for(let t=0;t<n;t++)s=s.parent}let a={x:s.x+m(t.xOffset,e,n),y:s.y+m(t.yOffset,e,n)};if("bottomLeft"===t.referenceAreaPosi?a.y+=s.height-1:"topRight"===t.referenceAreaPosi?a.x+=s.width-1:"bottomRight"===t.referenceAreaPosi&&(a.x+=s.width-1,a.y+=s.height-1),a.x<0||a.y<0||a.x>=n.width||a.y>=n.height)throw new Error(`Invalid cell selection:\n Table size (${n.width}, ${n.height}), Position (${a.x}, ${a.y}) is out of bounds.`);return{...a,value:n.areaTbl[a.y][a.x]}},g=(t,e,n,s)=>"number"===typeof t?t:"toParentX"===t?s.width-e:"toParentY"===t?s.height-n:1,y=(t,e,n,s,a)=>{const o=[];for(let l=n;l<n+a;l++){const n=t[l].slice(e,e+s);o.push(n)}return o},j=(t,e)=>{if(null===e)return;const n=Math.max(...Object.values(t).map((t=>t.length)));for(const s in t){const a=t[s],o="forward"===e?a[a.length-1]:{x:-1,y:-1,value:e};while(a.length<n)a.push(o)}},w=(t,e,n,s,a,o,l,r,i,c,u)=>{let f=e,d=e+o-1,p=n,h=n+l-1,b=null;while(h<=a){const n=h-p+1;while(d<=s){const e=d-f+1;if(b=x(t,f,p,e,n,r,i,c,u),null===b)d+=1,null!=t.size.width?f+=1:d===s&&(f+=1,d=f);else{if(r.instanceIndex+=1,null===t.traverse.xDirection)break;r.xIndex+=1,f+=e,d=f+o-1}}if(r.xIndex=0,null===b)h+=1,null!=t.size.height?p+=1:h===a&&(p+=1,h=p);else{if(null===t.traverse.yDirection)break;r.yIndex+=1,p+=n,h=p+l-1}f=e,d=e+o-1}},x=(t,e,n,s,a,o,l,r,i)=>{let c=l.x+e,u=l.y+n;if("current"!==t.startCell.referenceAreaLayer){const e=v(t.startCell,l,r);if(null===e)return null;c=e.x,u=e.y}const f={parent:l,areaLayer:l.areaLayer+1,templateRef:o.templateRef.slice(),instanceIndex:o.instanceIndex,xIndex:o.xIndex,yIndex:o.yIndex,xOffset:e,yOffset:n,x:c,y:u,width:s,height:a,areaTbl:y(r.areaTbl,c,u,s,a),children:[]};for(let d of t.constraints){const t=v(d,f,r);if(null===t)return null;if(!b(t.value,d))return null}return l.children.push(f),k(t,f,r,i),f},k=(t,e,n,s)=>{const a=e.areaTbl.flat();if(t.transform){const o=t.transform.context,l=[],r=[];if(o){const t=[];if("top"===o.position)e.areaTbl.forEach(((e,n)=>{e.forEach(((e,s)=>{t.push([(0,p.gX)({xOffset:s,yOffset:n-1})])}))}));else if("bottom"===o.position)e.areaTbl.forEach(((e,n)=>{e.forEach(((e,s)=>{t.push([(0,p.gX)({xOffset:s,yOffset:n+1})])}))}));else if("left"===o.position)e.areaTbl.forEach(((e,n)=>{e.forEach(((e,s)=>{t.push([(0,p.gX)({xOffset:s-1,yOffset:n})])}))}));else if("right"===o.position)e.areaTbl.forEach(((e,n)=>{e.forEach(((e,s)=>{t.push([(0,p.gX)({xOffset:s+1,yOffset:n})])}))}));else{const s=o.position;e.areaTbl.forEach(((a,o)=>{a.forEach(((a,l)=>{const r=s({xOffset:l,yOffset:o,value:a},e,n),i=r.map((t=>(0,p.gX)(t)));t.push(i)}))}))}if(t.length>0&&t[0].length>0?t.forEach((t=>{const s=[];t.forEach((t=>{const a=v(t,e,n);if(null===a)return null;s.push(a)})),r.push(s)})):console.log("No context cells found"),"cellValue"===o.targetCol)r.forEach((t=>{l.push(t[0].value.toString())}));else{const t=o.targetCol;r.forEach((e=>{l.push(t(e))}))}}let i;i="object"===typeof t.transform.targetCols?t.transform.targetCols:"context"===t.transform.targetCols?l:t.transform.targetCols(e.areaTbl),i.forEach(((t,n)=>{if(t){const o={x:e.x+n%e.width,y:e.y+Math.floor(n/e.width),value:a[n]};s.hasOwnProperty(t)?s[t].push(o):s[t]=[o]}}))}},_=(t,e,n,s,a=0)=>{const o={templateRef:[...e.templateRef,a],instanceIndex:0,xIndex:0,yIndex:0},l=t.traverse.xDirection,r=t.traverse.yDirection,i=v(t.startCell,e,n);if(null===i)return null;const c=i.x-e.x,u=i.y-e.y,f=g(t.size.width,c,u,e),d=g(t.size.height,c,u,e);let p,h,b,m;"before"===l?(p=0,b=c):"after"===l?(p=c,b=e.width-1):"whole"===l?(p=0,b=e.width-1):(p=c,b=null===t.size.width?e.width-1:p+f-1),"before"===r?(h=0,m=u):"after"===r?(h=u,m=e.height-1):"whole"===r?(h=0,m=e.height-1):(h=u,m=null===t.size.height?e.height-1:h+d-1),w(t,p,h,b,m,f,d,o,e,n,s);for(let v of e.children)t.children.forEach(((t,e)=>{_(t,v,n,s,e)})),j(s,t.fill)};function C(t,e){const n=(0,p.Pu)(e),s={parent:null,areaLayer:0,templateRef:[],instanceIndex:0,xIndex:0,yIndex:0,xOffset:0,yOffset:0,x:0,y:0,width:t[0].length,height:t.length,areaTbl:t,children:[]},a={};return _(n,s,s,a),{rootArea:s,tidyData:a}}var O=n(17844),L=n(8230);const T={"posi-mapping":{fill:"#37bc6c",stroke:"#37bc6c",text:"#fff"},"ambiguous-cell":{fill:"#83e4aa",stroke:"#83e4aa",text:"#e91010"},"determined-cell":{fill:"#37bc6c",stroke:"#37bc6c",text:"#e91010",weight:"bold"},default:{fill:"#f9f7ff",stroke:"#cccccc",text:"#000"}},z=(0,f.nY)("table",{state(){return{caseList:["case1","case2","case3","case4","case5"],currentCase:"",caseData:{},editor:{mapping_spec:{code:"",instance:(0,r.IJ)(null)},transform_script:{code:"",instance:(0,r.IJ)(null)}},input_tbl:{instance:{},cells:[],tbl:(0,r.IJ)([]),in2out:(0,r.IJ)({})},output_tbl:{instance:{},cells:[],tbl:(0,r.IJ)([]),cols:(0,r.IJ)([]),out2in:(0,r.IJ)({cells:{},cols:[],rows:[]})}}},actions:{async loadCaseData(t){let e=[],n=`/${t}/`;try{const[s,a,o]=await Promise.all([fetch(n+"data.json"),fetch(n+"spec.js"),fetch(n+"script.py")]),[l,r,i]=await Promise.all([s.ok?s.text():Promise.resolve(null),a.ok?a.text():Promise.resolve(null),o.ok?o.text():Promise.resolve(null)]);this.output_tbl.tbl=[],this.output_tbl.cols=[],this.output_tbl.instance.updateData(this.output_tbl.tbl),this.output_tbl.instance.updateSettings({colHeaders:this.output_tbl.cols}),null!==l?(this.caseData=JSON.parse(l),this.input_tbl.tbl=this.caseData.input_tbl):e.push(`Failed to load data from ${t}`),null!==r?this.editor.mapping_spec.code=r:e.push(`Failed to load spec from ${t}`),null!==i?this.editor.transform_script.code=i:e.push(`Failed to load script from ${t}`)}catch(s){e.push(`Error loading data: ${s}`)}return this.currentCase=t,e},async loadCaseSpec(t){let e=!1,n="";try{const s=await fetch(`/caseSpecs/${t}.js`);s.ok?(e=!0,n=await s.text()):(e=!1,n=`Failed to load script from ${t}`)}catch(s){e=!1,n=`Error loading script: ${s}`}return{status:e,spec:n}},highlightTblCells(t,e){if(this[t].instance.updateSettings({cell:e}),this[t].cells=e.map((t=>[t.row,t.col])),this[t].cells.length){let e=this.startPoint(this[t].cells);this[t].instance.scrollViewportTo({row:e[0],col:e[1],verticalSnap:"top",horizontalSnap:"start"})}},highlightMinimapCells(t){d.Ubm("g.matrix rect.grid-cell").attr("fill",T.default.fill).attr("stroke",T.default.stroke),d.Ubm("g.matrix text.grid-text").attr("fill",T.default.text).attr("font-weight","normal"),t.forEach((t=>{t.className&&(d.Ltv(`g.matrix #grid-${t.row}-${t.col}`).attr("fill",T[t.className].fill).attr("stroke",T[t.className].stroke),d.Ltv(`g.matrix #text-${t.row}-${t.col}`).attr("fill",T[t.className].text).attr("font-weight",T[t.className].weight||"normal"))}))},out2in_mapping(t){this.caseData;let e=[];if(t.row<0)this.output_tbl.out2in.cols[t.col]&&this.output_tbl.out2in.cols[t.col].forEach((t=>{if(t.startsWith("[")&&t.endsWith("]")){let n=JSON.parse(t);e.push({row:n[0],col:n[1],className:"posi-mapping"})}}));else if(t.col<0)this.output_tbl.out2in.rows[t.row].forEach((t=>{if(t.startsWith("[")&&t.endsWith("]")){let n=JSON.parse(t);e.push({row:n[0],col:n[1],className:"posi-mapping"})}}));else{let n=`[${t.row},${t.col}]`,s=this.output_tbl.out2in.cells[n];if(s.startsWith("[")&&s.endsWith("]")){let t=JSON.parse(s);e.push({row:t[0],col:t[1],className:"posi-mapping"})}}return e},in2out_mapping(t){let e=[],n=this.input_tbl.in2out[`[${t.row},${t.col}]`];return n&&n.forEach((t=>{let n=JSON.parse(t);e.push({row:n[0],col:n[1],className:"posi-mapping"})})),e},grid_cell_click(t){const e=this.input_tbl.instance.getCell(t.row,t.col);if(e){let n=[{...t,className:"posi-mapping"}];this.highlightTblCells("input_tbl",n),e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0}))}},startPoint(t){let e=t[0];for(let n=1;n<t.length;n++){let s=t[n];(s[0]<e[0]||s[0]===e[0]&&s[1]<e[1])&&(e=s)}return e},transformTablebyCode(){let t;try{let e=this.editor.mapping_spec.instance.getValue()+"\nreturn option;";const n=L.transpileModule(e,{compilerOptions:{target:L.ScriptTarget.ES2015,module:L.ModuleKind.CommonJS}}),s=new Function("ValueType","sortWithCorrespondingArray",n.outputText);t=s(p.eV,h)}catch(e){O.Ay.error({content:`Failed to parse the specification:\n ${e}`,style:{whiteSpace:"pre-line"}})}try{const{rootArea:e,tidyData:n}=C(this.input_tbl.tbl,t);this.convertDictToArray(n),this.derivePosiMapping(n),this.output_tbl.instance.updateData(this.output_tbl.tbl),this.output_tbl.instance.updateSettings({colHeaders:this.output_tbl.cols})}catch(e){O.Ay.error({content:`Failed to transform the table based on the specification:\n ${e}`,style:{whiteSpace:"pre-line"}})}},convertDictToArray(t){this.output_tbl.cols=Object.keys(t);const e=t[this.output_tbl.cols[0]].length;this.output_tbl.tbl=[];for(let n=0;n<e;n++){const e=this.output_tbl.cols.map((e=>t[e][n]));this.output_tbl.tbl.push(e.map((t=>t.value)))}},derivePosiMapping(t){this.input_tbl.in2out={},this.output_tbl.out2in={cells:{},cols:[],rows:[]};const e=Object.keys(t);this.output_tbl.cols=e;const n=t[e[0]].length;for(let s=0;s<n;s++){const n=[];this.output_tbl.out2in.rows.push([]);for(let a=0;a<e.length;a++){const o=e[a],l=t[o][s];n.push(l.value);let r=`[${l.y},${l.x}]`;const i=`[${s},${a}]`;console.log(r,i),l.x<0||l.y<0?r="":this.input_tbl.in2out.hasOwnProperty(r)?this.input_tbl.in2out[r].push(i):this.input_tbl.in2out[r]=[i],this.output_tbl.out2in.cells[i]=r,this.output_tbl.out2in.rows[s].push(r),this.output_tbl.out2in.cols.length<=a?this.output_tbl.out2in.cols.push([r]):this.output_tbl.out2in.cols[a].push(r)}}console.log(t),console.log(this.output_tbl.out2in,this.input_tbl.in2out)}},getters:{}}),E={class:"view"},M={class:"view-title"},N=(0,a.Lk)("span",{class:"head-text"}," Input Table ",-1),S={class:"toolbar",style:{float:"right","margin-right":"50px"}},D={class:"controller"},$={class:"view-content"},A={id:"input-tbl"},I={class:"view"},P=(0,a.Lk)("div",{class:"view-title"},"Output Table",-1),R={class:"view-content"},F={id:"output-tbl"};var V=(0,a.pM)({__name:"InOutTable",setup(t){(0,c.um)();const e=z();let n=e.caseData,s=(0,r.KR)(n.output_col),o=(0,r.KR)([]);o.value=e.caseList.map((t=>({value:t,label:t})));let l,f,d=(0,r.KR)(e.caseList[0]);function p(t,e,n,s,a,o,l){u.Ay.renderers.TextRenderer.apply(this,arguments),e.innerHTML=`<div class="truncated">${o}</div>`}function h(){}function b(){}async function m(t){d.value=t,await e.loadCaseData(t),l.updateData(e.input_tbl.tbl)}return(0,a.sV)((()=>{const t=(0,a.nI)()?.proxy;l=t.$refs.inputTbl.hotInstance,f=t.$refs.outputTbl.hotInstance,e.input_tbl.instance=l,e.output_tbl.instance=f,f.updateSettings({outsideClickDeselects:t=>"wtHolder"!==t?.className&&(l.updateSettings({cell:[]}),e.highlightMinimapCells([]),!0)}),f.addHook("afterOnCellMouseDown",(()=>{l.updateSettings({cell:[]})})),f.addHook("afterOnCellMouseUp",((t,n,s)=>{const a=e.out2in_mapping(n);e.highlightTblCells("input_tbl",a),e.highlightMinimapCells(a)})),l.updateSettings({outsideClickDeselects:t=>"wtHolder"!==t?.className&&(f.updateSettings({cell:[]}),!0)}),l.addHook("afterOnCellMouseDown",(()=>{f.updateSettings({cell:[]})})),l.addHook("afterOnCellMouseUp",((t,n,s)=>{const a=e.in2out_mapping(n);e.highlightTblCells("output_tbl",a),e.highlightMinimapCells([{...n,className:"posi-mapping"}])})),m(d.value)})),(t,e)=>{const l=(0,a.g2)("a-select");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",E,[(0,a.Lk)("div",M,[N,(0,a.Lk)("span",S,[(0,a.Lk)("span",D,[(0,a.bF)(l,{ref:"select",value:(0,r.R1)(d),options:(0,r.R1)(o),size:"small",onChange:m,onMouseenter:h,onMouseleave:b},null,8,["value","options"])])])]),(0,a.Lk)("div",$,[(0,a.Lk)("div",A,[(0,a.bF)((0,r.R1)(i.sH),{ref:"inputTbl",data:(0,r.R1)(n).input_tbl,rowHeaders:!0,colHeaders:!0,manualColumnResize:!0,renderer:p,contextMenu:!0,licenseKey:"non-commercial-and-evaluation"},null,8,["data"])])])]),(0,a.Lk)("div",I,[P,(0,a.Lk)("div",R,[(0,a.Lk)("div",F,[(0,a.bF)((0,r.R1)(i.sH),{ref:"outputTbl",data:(0,r.R1)(n).output_tbl,rowHeaders:!0,colHeaders:(0,r.R1)(s),manualColumnResize:!0,renderer:p,contextMenu:!0,licenseKey:"non-commercial-and-evaluation"},null,8,["data","colHeaders"])])])])],64)}}});const H=V;var K=H,J=n(42336),X=n(78626),W=(0,a.pM)({__name:"CodeView",props:{codeType:{}},setup(t){const{codeType:e}=t,n=z(),s={value:"",language:"mapping_spec"===e?"typescript":"python",theme:"vs",fontSize:14,glyphMargin:!1,automaticLayout:!1,autoIndent:"advanced",readOnly:!1,minimap:{enabled:!1},lineNumbersMinChars:1,scrollBeyondLastLine:!1,padding:{bottom:80}},o=(0,r.KR)(null);let l=null;const i=()=>{l&&l.dispose();const t={...s,value:n.editor[e].code};l=J.EN.create(o.value,t)};(0,a.wB)((()=>n.currentCase),(t=>{l?.setValue(n.editor[e].code)}));const c=(0,X.debounce)((()=>{l&&l.layout()}),100),u=new ResizeObserver((()=>{c()}));if("mapping_spec"===e){const t="ts:grammar.ts",e=J.EN.getModels().find((e=>e.uri.toString()===t));e||fetch("/grammar.ts").then((e=>{e.text().then((e=>{J.eo.typescript.javascriptDefaults.setDiagnosticsOptions({noSemanticValidation:!0,noSyntaxValidation:!1}),J.eo.typescript.javascriptDefaults.setCompilerOptions({target:J.eo.typescript.ScriptTarget.ES2015,allowNonTsExtensions:!0}),J.eo.typescript.javascriptDefaults.addExtraLib(e,t),J.EN.createModel(e,"typescript",J.zn.parse(t))}))}))}return(0,a.sV)((()=>{i(),u.observe(o.value),l&&(n.editor[e].instance=l)})),(0,a.hi)((()=>{l&&l.dispose()})),(t,e)=>((0,a.uX)(),(0,a.CE)("div",{ref_key:"editorWrapper",ref:o,class:"editor-container"},null,512))}}),U=n(71241);const B=(0,U.A)(W,[["__scopeId","data-v-31ed6103"]]);var q=B;const G={class:"view"},Y={class:"view-title"},Q=(0,a.Lk)("span",null,"Mapping Minimap",-1),Z={class:"view-content"};var tt=(0,a.pM)({__name:"Minimap",setup(t){const e=z(),n=(0,r.KR)(null);let s,o=0,l=0,i=null;function c(){i&&n.value&&d.Ltv(n.value).select("svg").transition().duration(750).call(i.transform,d.GSI)}function u(t,e){const n=[];for(let s=0;s<t;s++)for(let t=0;t<e;t++)n.push({row:s,col:t});return n}const f=(t,a)=>{if(!n.value)return;d.Ltv(n.value).selectAll("svg").remove();const r=n.value.clientWidth,c=n.value.clientHeight;let f=Math.max(5,Math.min(45,Math.floor(r/a))),p=Math.max(5,Math.min(20,Math.floor(c/t)));f=p=Math.min(f,p),i=d.s_O().on("zoom",(function(t){d.Ltv("g.matrix").attr("transform",`translate(${o+t.transform.x}, ${l+t.transform.y}) scale(${t.transform.k})`),g(t.transform.k)}));const h=d.Ltv(n.value).append("svg").attr("width",r).attr("height",c).call(i),b=h.append("g").classed("matrix",!0);let m=null;const v=u(t,a);b.selectAll("rect").data(v).enter().append("rect").classed("grid-cell",!0).attr("x",(t=>t.col*f)).attr("y",(t=>t.row*p)).attr("id",(t=>`grid-${t.row}-${t.col}`)).attr("width",f).attr("height",p).attr("fill","#f9f7ff").attr("stroke","#cccccc").on("mouseover",(function(){d.Ltv(this).raise().attr("stroke-width",2),m&&m.raise()})).on("mouseout",(function(){d.Ltv(this).attr("stroke-width",1)})).on("click",(function(t,n){e.grid_cell_click({row:n.row,col:n.col})}));o=Math.max((r-b.node().getBBox().width)/2,0),l=Math.max((c-b.node().getBBox().height)/2,0),b.attr("transform",`translate(${o}, ${l})`),s=d.GSI;const g=t=>{const e=f*t,n=p*t;e>=45&&n>=20?m?m.style("display","block"):m=b.selectAll("text").data(v).enter().append("text").classed("grid-text",!0).attr("x",(t=>t.col*f+f/2)).attr("y",(t=>t.row*p+p/2)).attr("id",(t=>`text-${t.row}-${t.col}`)).attr("dy",".30em").attr("font-size",15/t).attr("fill","#000").attr("text-anchor","middle").text((t=>`(${t.row}, ${t.col})`)).style("display","block").style("pointer-events","none"):m&&m.style("display","none")};g(1)},p=(0,X.debounce)((()=>{e.caseData.input_tbl&&f(e.caseData.input_tbl.length,e.caseData.input_tbl[0].length)}),100),h=new ResizeObserver((()=>{p()}));return(0,a.sV)((()=>{n.value&&h.observe(n.value)})),(0,a.wB)((()=>e.currentCase),(t=>{f(e.caseData.input_tbl.length,e.caseData.input_tbl[0].length)})),(t,e)=>{const s=(0,a.g2)("a-button");return(0,a.uX)(),(0,a.CE)("div",G,[(0,a.Lk)("div",Y,[Q,(0,a.bF)(s,{size:"small",style:{float:"right","margin-right":"20px"},onClick:c},{default:(0,a.k6)((()=>[(0,a.eW)("Reset")])),_:1})]),(0,a.Lk)("div",Z,[(0,a.Lk)("div",{ref_key:"container",ref:n,class:"grid-container"},null,512)])])}}});const et=tt;var nt=et;const st={id:"panel"},at=(0,a.Lk)("div",{class:"system-name"},"TableTidier",-1),ot={class:"main-views"},lt={class:"column left"},rt={class:"column center"},it=(0,a.Lk)("div",{class:"view"},[(0,a.Lk)("h2",{class:"view-title"},"Mapping Template Visualization"),(0,a.Lk)("div",{class:"view-content"})],-1),ct={class:"column right"},ut={class:"view"},ft={class:"view-title"},dt=(0,a.Lk)("span",null,"Code Panel",-1),pt={style:{float:"right","margin-right":"50px"}},ht={class:"view-content"},bt=(0,a.Lk)("span",null," Mapping Specification ",-1),mt=(0,a.Lk)("span",null," Transformation Script ",-1);var vt=(0,a.pM)({__name:"PanelView",setup(t){const e=z(),n=(0,r.KR)("1"),s=(0,r.KR)(!1);function o(){s.value=!0,e.transformTablebyCode(),s.value=!1}return(t,e)=>{const l=(0,a.g2)("a-button"),r=(0,a.g2)("a-tab-pane"),i=(0,a.g2)("a-tabs");return(0,a.uX)(),(0,a.CE)("div",st,[at,(0,a.Lk)("div",ot,[(0,a.Lk)("div",lt,[(0,a.bF)(K)]),(0,a.Lk)("div",rt,[it,(0,a.bF)(nt)]),(0,a.Lk)("div",ct,[(0,a.Lk)("div",ut,[(0,a.Lk)("div",ft,[dt,(0,a.Lk)("span",pt,[(0,a.bF)(l,{size:"small",loading:s.value,onClick:o},{default:(0,a.k6)((()=>[(0,a.eW)("Run")])),_:1},8,["loading"])])]),(0,a.Lk)("div",ht,[(0,a.bF)(i,{activeKey:n.value,"onUpdate:activeKey":e[0]||(e[0]=t=>n.value=t),type:"card"},{default:(0,a.k6)((()=>[(0,a.bF)(r,{key:"1"},{tab:(0,a.k6)((()=>[bt])),default:(0,a.k6)((()=>[(0,a.bF)(q,{codeType:"mapping_spec"})])),_:1}),(0,a.bF)(r,{key:"2"},{tab:(0,a.k6)((()=>[mt])),default:(0,a.k6)((()=>[(0,a.bF)(q,{codeType:"transform_script"})])),_:1})])),_:1},8,["activeKey"])])])])])])}}});const gt=vt;var yt=gt,jt=(0,a.pM)({name:"overView",components:{PanelView:yt}});const wt=(0,U.A)(jt,[["render",l]]);var xt=wt,kt=n(87086),_t=n(8336),Ct=n(92278),Ot=n(58730),Lt=n(35678),Tt=n(91328),zt=n(73918),Et=n(34770);const Mt=(0,f.Ey)(),Nt=(0,s.Ef)(xt);Nt.use(Mt).use(kt.Ay).use(_t.A).use(Ct.A).use(Ot.A).use(Lt.A).use(Tt.A).use(zt.Ay).use(Et.A),Nt.mount("#app")},89387:function(t){function e(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=function(){return[]},e.resolve=e,e.id=89387,t.exports=e},530:function(){},72615:function(){},84021:function(){},66247:function(){},82202:function(){},18641:function(){},97664:function(){}},e={};function n(s){var a=e[s];if(void 0!==a)return a.exports;var o=e[s]={id:s,loaded:!1,exports:{}};return t[s].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=t,function(){n.amdO={}}(),function(){var t=[];n.O=function(e,s,a,o){if(!s){var l=1/0;for(u=0;u<t.length;u++){s=t[u][0],a=t[u][1],o=t[u][2];for(var r=!0,i=0;i<s.length;i++)(!1&o||l>=o)&&Object.keys(n.O).every((function(t){return n.O[t](s[i])}))?s.splice(i--,1):(r=!1,o<l&&(l=o));if(r){t.splice(u--,1);var c=a();void 0!==c&&(e=c)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[s,a,o]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){n.f={},n.e=function(t){return Promise.all(Object.keys(n.f).reduce((function(e,s){return n.f[s](t,e),e}),[]))}}(),function(){n.u=function(t){return"js/"+t+"."+{9:"0eb45d16",293:"16888f42",703:"dbf69444",1034:"fd1ba391",1157:"10c8f73c",1461:"849cd3de",1477:"bd607d38",1813:"4d15f492",1915:"4e1a5f91",2149:"de48b7bc",2365:"fce0cfa6",2412:"d3741863",2501:"609e1b41",2591:"c50d8490",2689:"e4b75d6d",2709:"cac49c05",2799:"e1dbe219",2965:"d7dfd0e9",2999:"df850aaf",3051:"f14d6281",3061:"d399cda5",3071:"a303a28e",3445:"0ff7e9b4",3473:"a7537b09",3577:"e2ca1d28",3691:"33cf0d23",3717:"79a36ece",3753:"01925c0b",3765:"759df618",3775:"b3df24ad",3948:"52b3e958",4205:"24b198b8",4261:"6956a853",4341:"8f9322e5",4373:"3b06e083",4485:"7b59acba",4605:"51ec011b",4621:"31cd9af3",4805:"a9f68a4a",4977:"8288ffd6",5077:"f39d5cf4",5081:"a53416e4",5083:"c394f624",5093:"90618cb2",5282:"08fc09bc",5285:"773f587c",5287:"aa8f3de9",5303:"bd9e8dd0",5365:"45daba38",5521:"647b10a4",5589:"57207c2d",5609:"58111415",5653:"50566b72",5749:"8427442b",5841:"31d174b0",6059:"df92538a",6121:"1a3a1618",6181:"e36a77ec",6229:"6291c48d",6309:"430f1630",6325:"3d043424",6613:"2dfa5db1",6757:"c5514908",6821:"321025c8",6845:"d2590b8e",7045:"c844481a",7217:"ff15130f",7219:"e0c4a0ce",7449:"379ad554",7461:"260b935b",7525:"24dc0392",7623:"4e577647",7641:"dd97b582",8175:"35d86c7b",8285:"c20339cc",8329:"6bbe3b90",8387:"6869ef81",8533:"29375b9c",8653:"07e5d352",8981:"9c06e434",9009:"49384fbf",9437:"1f553a12",9445:"bde299da",9626:"e73f15dd",9717:"547c11f4"}[t]+".js"}}(),function(){n.miniCssF=function(t){}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="frontend:";n.l=function(s,a,o,l){if(t[s])t[s].push(a);else{var r,i;if(void 0!==o)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var f=c[u];if(f.getAttribute("src")==s||f.getAttribute("data-webpack")==e+o){r=f;break}}r||(i=!0,r=document.createElement("script"),r.charset="utf-8",r.timeout=120,n.nc&&r.setAttribute("nonce",n.nc),r.setAttribute("data-webpack",e+o),r.src=s),t[s]=[a];var d=function(e,n){r.onerror=r.onload=null,clearTimeout(p);var a=t[s];if(delete t[s],r.parentNode&&r.parentNode.removeChild(r),a&&a.forEach((function(t){return t(n)})),e)return e(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=d.bind(null,r.onerror),r.onload=d.bind(null,r.onload),i&&document.head.appendChild(r)}}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){n.p="/"}(),function(){var t={3524:0};n.f.j=function(e,s){var a=n.o(t,e)?t[e]:void 0;if(0!==a)if(a)s.push(a[2]);else{var o=new Promise((function(n,s){a=t[e]=[n,s]}));s.push(a[2]=o);var l=n.p+n.u(e),r=new Error,i=function(s){if(n.o(t,e)&&(a=t[e],0!==a&&(t[e]=void 0),a)){var o=s&&("load"===s.type?"missing":s.type),l=s&&s.target&&s.target.src;r.message="Loading chunk "+e+" failed.\n("+o+": "+l+")",r.name="ChunkLoadError",r.type=o,r.request=l,a[1](r)}};n.l(l,i,"chunk-"+e,e)}},n.O.j=function(e){return 0===t[e]};var e=function(e,s){var a,o,l=s[0],r=s[1],i=s[2],c=0;if(l.some((function(e){return 0!==t[e]}))){for(a in r)n.o(r,a)&&(n.m[a]=r[a]);if(i)var u=i(n)}for(e&&e(s);c<l.length;c++)o=l[c],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return n.O(u)},s=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=n.O(void 0,[504],(function(){return n(37340)}));s=n.O(s)})();
//# sourceMappingURL=app.1524f81d.js.map