(function(){var e={35358:function(e,t,n){var a={"./af":22190,"./af.js":22190,"./ar":7218,"./ar-dz":85785,"./ar-dz.js":85785,"./ar-kw":29417,"./ar-kw.js":29417,"./ar-ly":56904,"./ar-ly.js":56904,"./ar-ma":98617,"./ar-ma.js":98617,"./ar-ps":91318,"./ar-ps.js":91318,"./ar-sa":82699,"./ar-sa.js":82699,"./ar-tn":36789,"./ar-tn.js":36789,"./ar.js":7218,"./az":23050,"./az.js":23050,"./be":8316,"./be.js":8316,"./bg":70310,"./bg.js":70310,"./bm":58884,"./bm.js":58884,"./bn":83469,"./bn-bd":46672,"./bn-bd.js":46672,"./bn.js":83469,"./bo":39118,"./bo.js":39118,"./br":13113,"./br.js":13113,"./bs":23626,"./bs.js":23626,"./ca":40921,"./ca.js":40921,"./cs":17799,"./cs.js":17799,"./cv":12828,"./cv.js":12828,"./cy":93521,"./cy.js":93521,"./da":56962,"./da.js":56962,"./de":93294,"./de-at":16158,"./de-at.js":16158,"./de-ch":95960,"./de-ch.js":95960,"./de.js":93294,"./dv":47963,"./dv.js":47963,"./el":3432,"./el.js":3432,"./en-au":20998,"./en-au.js":20998,"./en-ca":15931,"./en-ca.js":15931,"./en-gb":45930,"./en-gb.js":45930,"./en-ie":58081,"./en-ie.js":58081,"./en-il":71594,"./en-il.js":71594,"./en-in":23904,"./en-in.js":23904,"./en-nz":1507,"./en-nz.js":1507,"./en-sg":19409,"./en-sg.js":19409,"./eo":22177,"./eo.js":22177,"./es":84805,"./es-do":39155,"./es-do.js":39155,"./es-mx":69791,"./es-mx.js":69791,"./es-us":76098,"./es-us.js":76098,"./es.js":84805,"./et":96240,"./et.js":96240,"./eu":20391,"./eu.js":20391,"./fa":20612,"./fa.js":20612,"./fi":4220,"./fi.js":4220,"./fil":65570,"./fil.js":65570,"./fo":5466,"./fo.js":5466,"./fr":14461,"./fr-ca":66306,"./fr-ca.js":66306,"./fr-ch":27081,"./fr-ch.js":27081,"./fr.js":14461,"./fy":73484,"./fy.js":73484,"./ga":76957,"./ga.js":76957,"./gd":72978,"./gd.js":72978,"./gl":89866,"./gl.js":89866,"./gom-deva":65011,"./gom-deva.js":65011,"./gom-latn":84724,"./gom-latn.js":84724,"./gu":71601,"./gu.js":71601,"./he":79802,"./he.js":79802,"./hi":9358,"./hi.js":9358,"./hr":13907,"./hr.js":13907,"./hu":10218,"./hu.js":10218,"./hy-am":20533,"./hy-am.js":20533,"./id":52844,"./id.js":52844,"./is":97353,"./is.js":97353,"./it":6364,"./it-ch":20774,"./it-ch.js":20774,"./it.js":6364,"./ja":6008,"./ja.js":6008,"./jv":68221,"./jv.js":68221,"./ka":92417,"./ka.js":92417,"./kk":42071,"./kk.js":42071,"./km":76149,"./km.js":76149,"./kn":94572,"./kn.js":94572,"./ko":60659,"./ko.js":60659,"./ku":66285,"./ku-kmr":59398,"./ku-kmr.js":59398,"./ku.js":66285,"./ky":81609,"./ky.js":81609,"./lb":119,"./lb.js":119,"./lo":81748,"./lo.js":81748,"./lt":71973,"./lt.js":71973,"./lv":81347,"./lv.js":81347,"./me":53023,"./me.js":53023,"./mi":65747,"./mi.js":65747,"./mk":64341,"./mk.js":64341,"./ml":63840,"./ml.js":63840,"./mn":62058,"./mn.js":62058,"./mr":19182,"./mr.js":19182,"./ms":45197,"./ms-my":89136,"./ms-my.js":89136,"./ms.js":45197,"./mt":36408,"./mt.js":36408,"./my":51683,"./my.js":51683,"./nb":53141,"./nb.js":53141,"./ne":29344,"./ne.js":29344,"./nl":44703,"./nl-be":84641,"./nl-be.js":84641,"./nl.js":44703,"./nn":79873,"./nn.js":79873,"./oc-lnc":61217,"./oc-lnc.js":61217,"./pa-in":24612,"./pa-in.js":24612,"./pl":24457,"./pl.js":24457,"./pt":1089,"./pt-br":79146,"./pt-br.js":79146,"./pt.js":1089,"./ro":45950,"./ro.js":45950,"./ru":27292,"./ru.js":27292,"./sd":56774,"./sd.js":56774,"./se":87493,"./se.js":87493,"./si":3761,"./si.js":3761,"./sk":49711,"./sk.js":49711,"./sl":88558,"./sl.js":88558,"./sq":8633,"./sq.js":8633,"./sr":90688,"./sr-cyrl":47903,"./sr-cyrl.js":47903,"./sr.js":90688,"./ss":31991,"./ss.js":31991,"./sv":27020,"./sv.js":27020,"./sw":15891,"./sw.js":15891,"./ta":45714,"./ta.js":45714,"./te":30206,"./te.js":30206,"./tet":24768,"./tet.js":24768,"./tg":28276,"./tg.js":28276,"./th":57977,"./th.js":57977,"./tk":56928,"./tk.js":56928,"./tl-ph":8046,"./tl-ph.js":8046,"./tlh":41361,"./tlh.js":41361,"./tr":64367,"./tr.js":64367,"./tzl":10627,"./tzl.js":10627,"./tzm":12636,"./tzm-latn":98148,"./tzm-latn.js":98148,"./tzm.js":12636,"./ug-cn":68823,"./ug-cn.js":68823,"./uk":40461,"./uk.js":40461,"./ur":41366,"./ur.js":41366,"./uz":83454,"./uz-latn":18374,"./uz-latn.js":18374,"./uz.js":83454,"./vi":78572,"./vi.js":78572,"./x-pseudo":80464,"./x-pseudo.js":80464,"./yo":93709,"./yo.js":93709,"./zh-cn":65873,"./zh-cn.js":65873,"./zh-hk":17549,"./zh-hk.js":17549,"./zh-mo":52240,"./zh-mo.js":52240,"./zh-tw":90405,"./zh-tw.js":90405};function r(e){var t=i(e);return n(t)}function i(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=i,e.exports=r,r.id=35358},40315:function(e,t,n){"use strict";var a=n(45130),r=n(56768);const i={class:"wrapper"};function s(e,t,n,a,s,l){const o=(0,r.g2)("panel-view");return(0,r.uX)(),(0,r.CE)("div",i,[(0,r.bF)(o)])}var l,o=n(90144),c=(n(44114),n(14603),n(47566),n(98721),n(30328)),u=(n(19830),n(48355)),d=n(8153),h=n(55234),f=n(24770);(function(e){e["String"]="TableTidier.String",e["Number"]="TableTidier.Number",e["None"]="TableTidier.None"})(l||(l={}));const p=1,g=1,b="current",v="topLeft",m=0,y=0,x=null,k=null,j="above",$="cellValue",w=[],A=l.String,L=null;function _(e){return e?{referenceAreaLayer:e.referenceAreaLayer||b,referenceAreaPosi:e.referenceAreaPosi||v,xOffset:e.xOffset||m,yOffset:e.yOffset||y}:{referenceAreaLayer:b,referenceAreaPosi:v,xOffset:m,yOffset:y}}function C(e){const t=_(e);return{...t,valueCstr:e.valueCstr||A}}function T(e){return{position:e.position||j,targetCol:e.targetCol||$}}function S(e){return{startCell:_(e.startCell),size:{width:void 0===e.size?.width?p:e.size.width,height:void 0===e.size?.height?g:e.size.height},constraints:e.constraints?.map(C)||[],traverse:{xDirection:void 0===e.traverse?.xDirection?x:e.traverse.xDirection,yDirection:void 0===e.traverse?.yDirection?k:e.traverse.yDirection},transform:e.transform?{context:e.transform.context?T(e.transform.context):null,targetCols:e.transform.targetCols||w}:null,fill:void 0===e.fill?L:e.fill,children:e.children?.map(S)||[]}}class z extends Error{constructor(e,t="CustomError"){super(e),this.name=t,Object.setPrototypeOf(this,new.target.prototype)}}var M;function O(e,t,n){let a=e.map(((e,t)=>({value:e,index:t})));a.sort(((e,t)=>"asc"===n?e.value-t.value:t.value-e.value));let r=a.map((e=>t[e.index]));return r}function F(e){const t=new WeakSet;return JSON.stringify(e,(function(e,n){if("object"===typeof n&&null!==n){if(t.has(n))return`[Circular reference: ${e}]`;t.add(n)}return n}),2)}(function(e){e[e["String"]=0]="String",e[e["Number"]=1]="Number",e[e["None"]=2]="None"})(M||(M={}));const E=(e,t)=>"function"===typeof t.valueCstr?t.valueCstr(e):t.valueCstr===l.String?"string"===typeof e&&""!==e&&isNaN(Number(e)):t.valueCstr===l.Number?"number"===typeof e||"string"===typeof e&&""!==e&&!isNaN(Number(e)):t.valueCstr===l.None?null===e||""===e:e===t.valueCstr,R=(e,t,n)=>"number"===typeof e?e:e(t,n),N=(e,t,n)=>{let a=t;if("current"===e.referenceAreaLayer)a=t;else if("root"===e.referenceAreaLayer)a=n;else if("parent"===e.referenceAreaLayer)a=t.parent;else{const n=t.areaLayer-e.referenceAreaLayer(t);for(let e=0;e<n;e++)a=a.parent}let r={x:a.x+R(e.xOffset,t,n),y:a.y+R(e.yOffset,t,n)};if("bottomLeft"===e.referenceAreaPosi?r.y+=a.height-1:"topRight"===e.referenceAreaPosi?r.x+=a.width-1:"bottomRight"===e.referenceAreaPosi&&(r.x+=a.width-1,r.y+=a.height-1),r.x<0||r.y<0||r.x>=n.width||r.y>=n.height)throw new z(`Invalid cell selection:\n Table size is (width: ${n.width}, height: ${n.height}), Position (${r.x}, ${r.y}) is out of bounds.`,"OutOfBoundsError");return{...r,value:n.areaTbl[r.y][r.x]}},P=(e,t,n,a)=>"number"===typeof e?e:"toParentX"===e?a.width-t:"toParentY"===e?a.height-n:1,D=(e,t,n,a,r)=>{const i=[];for(let s=n;s<n+r;s++){const n=e[s].slice(t,t+a);i.push(n)}return i},I=(e,t)=>{if(null===t)return;const n=Math.max(...Object.values(e).map((e=>e.length)));for(const a in e){const r=e[a],i="forward"===t?r[r.length-1]:{x:-1,y:-1,value:t};while(r.length<n)r.push(i)}},W=(e,t,n,a,r,i,s,l,o,c,u)=>{let d=t,h=t+i-1,f=n,p=n+s-1,g=null;while(p<=r){const n=p-f+1;while(h<=a){const t=h-d+1;if(g=H(e,d,f,t,n,l,o,c,u),null===g)h+=1,null!=e.size.width?d+=1:h===a&&(d+=1,h=d);else{if(l.instanceIndex+=1,null===e.traverse.xDirection)break;l.xIndex+=1,d+=t,h=d+i-1}}if(l.xIndex=0,null===g)p+=1,null!=e.size.height?f+=1:p===r&&(f+=1,p=f);else{if(null===e.traverse.yDirection)break;l.yIndex+=1,f+=n,p=f+s-1}d=t,h=t+i-1}},H=(e,t,n,a,r,i,s,l,o)=>{let c=s.x+t,u=s.y+n;if("current"!==e.startCell.referenceAreaLayer){const t=N(e.startCell,s,l);if(null===t)return null;c=t.x,u=t.y}const d={parent:s,areaLayer:s.areaLayer+1,templateRef:i.templateRef.slice(),instanceIndex:i.instanceIndex,xIndex:i.xIndex,yIndex:i.yIndex,xOffset:t,yOffset:n,x:c,y:u,width:a,height:r,areaTbl:D(l.areaTbl,c,u,a,r),children:[]};for(let h of e.constraints){const e=N(h,d,l);if(null===e)return null;if(!E(e.value,h))return null}return s.children.push(d),B(e,d,l,o),d},B=(e,t,n,a)=>{const r=t.areaTbl.flat();if(e.transform){const i=e.transform.context,s=[],l=[];if(i){const e=[];if("above"===i.position)t.areaTbl.forEach(((t,n)=>{t.forEach(((t,a)=>{e.push([_({xOffset:a,yOffset:n-1})])}))}));else if("below"===i.position)t.areaTbl.forEach(((t,n)=>{t.forEach(((t,a)=>{e.push([_({xOffset:a,yOffset:n+1})])}))}));else if("left"===i.position)t.areaTbl.forEach(((t,n)=>{t.forEach(((t,a)=>{e.push([_({xOffset:a-1,yOffset:n})])}))}));else if("right"===i.position)t.areaTbl.forEach(((t,n)=>{t.forEach(((t,a)=>{e.push([_({xOffset:a+1,yOffset:n})])}))}));else{const a=i.position;t.areaTbl.forEach(((r,i)=>{r.forEach(((r,s)=>{const l=a({xOffset:s,yOffset:i,value:r},t,n),o=l.map((e=>_(e)));e.push(o)}))}))}if(e.length>0&&e[0].length>0?e.forEach((e=>{const a=[];e.forEach((e=>{const r=N(e,t,n);if(null===r)return null;a.push(r)})),l.push(a)})):console.log("No context cells found"),"cellValue"===i.targetCol)l.forEach((e=>{s.push(void 0===e[0].value?null:e[0].value.toString())}));else{const e=i.targetCol;l.forEach((t=>{s.push(e(t))}))}}let o;o="object"===typeof e.transform.targetCols?e.transform.targetCols:"context"===e.transform.targetCols?s:e.transform.targetCols(t.areaTbl),o.forEach(((e,n)=>{if(e){const i={x:t.x+n%t.width,y:t.y+Math.floor(n/t.width),value:r[n]};a.hasOwnProperty(e)?a[e].push(i):a[e]=[i]}}))}},K=(e,t,n,a,r=0)=>{const i={templateRef:[...t.templateRef,r],instanceIndex:0,xIndex:0,yIndex:0},s=e.traverse.xDirection,l=e.traverse.yDirection,o=N(e.startCell,t,n);if(null===o)return null;const c=o.x-t.x,u=o.y-t.y,d=P(e.size.width,c,u,t),h=P(e.size.height,c,u,t);let f,p,g,b;if("before"===s?(f=0,g=c):"after"===s?(f=c,g=t.width-1):"whole"===s?(f=0,g=t.width-1):(f=c,g=null===e.size.width?t.width-1:f+d-1),"before"===l?(p=0,b=u):"after"===l?(p=u,b=t.height-1):"whole"===l?(p=0,b=t.height-1):(p=u,b=null===e.size.height?t.height-1:p+h-1),W(e,f,p,g,b,d,h,i,t,n,a),e.children.length>0&&t.children.length>0)if(null===e.transform)for(let v of t.children)e.children.forEach(((e,t)=>{K(e,v,n,a,t)})),null===e.fill&&e.children.length>1?I(a,""):I(a,e.fill);else for(let v of e.children)t.children.forEach(((e,t)=>{K(v,e,n,a,t)})),null===e.fill?I(a,""):I(a,e.fill)};function V(e,t){const n={parent:null,areaLayer:0,templateRef:[],instanceIndex:0,xIndex:0,yIndex:0,xOffset:0,yOffset:0,x:0,y:0,width:e.length>0?e[0].length:0,height:e.length,areaTbl:e,children:[]},a={};return t.forEach(((e,t)=>{const r=S(e);K(r,n,n,a,t),null===r.fill&&r.children.length>1?I(a,""):I(a,r.fill)})),{rootArea:n,tidyData:a}}var J=n(17844),U=n(8230);const X={"posi-mapping":{fill:"#37bc6c",stroke:"#37bc6c",text:"#fff"},"ambiguous-cell":{fill:"#83e4aa",stroke:"#83e4aa",text:"#e91010"},"determined-cell":{fill:"#37bc6c",stroke:"#37bc6c",text:"#e91010",weight:"bold"},default:{fill:"#f9f7ff",stroke:"#cccccc",text:"#000"}},G=(0,h.nY)("table",{state(){return{specMode:!1,caseList:["case1","case2","case3","case4","case5"],currentCase:"",spec:{rawSpecs:(0,o.IJ)([]),visTree:(0,o.IJ)({id:"root",children:[]}),selectNode:(0,o.IJ)(null),selectAreaFlag:!1,dragConfigOpen:!1,areaConfig:(0,o.IJ)({startCell:{},size:{},traverse:{},transform:null,constraints:[],fill:"",children:[]}),areaFormData:(0,o.IJ)({referenceAreaLayer:null,referenceAreaPosi:null,position:{x:null,y:null},traverse:{xDirection:null,yDirection:null},size:{width:null,height:null}})},editor:{mappingSpec:{code:"",codePref:"const option: TableTidierTemplate[] = ",codeSuff:"\nreturn option;",language:"typescript",instance:(0,o.IJ)(null)},rootArea:{code:"",object:(0,o.IJ)(null),language:"json",instance:(0,o.IJ)(null)},transformScript:{code:"",language:"python",instance:(0,o.IJ)(null)}},input_tbl:{instance:{},cells:[],tbl:(0,o.IJ)([]),in2out:(0,o.IJ)({})},output_tbl:{instance:{},cells:[],tbl:(0,o.IJ)([]),cols:(0,o.IJ)([]),out2in:(0,o.IJ)({})},tree:{contextMenuVisible:!1,menuAllList:[{key:"0",label:"Select Area",title:"Select Area"},{key:"1",label:"Add Constraints",title:"Add Constraints"},{key:"2",label:"Set Target Cols",title:"Set Target Cols",children:[{key:"2-0",label:"Position Based",title:"Position Based"},{key:"2-1",label:"Context Based",title:"Context Based"},{key:"2-2",label:"Value Based",title:"Value Based"}]},{key:"3",label:"Add Sub-Template",title:"Add Sub-Template"},{key:"4",label:"Delete Template",title:"Delete Template"}],menuList:[]}}},actions:{async loadCaseData(e){let t=[],n=`./${e}/`;try{const[a,r,i]=await Promise.all([fetch(n+"data.json"),fetch(n+"spec.js"),fetch(n+"script.py")]),[s,l,o]=await Promise.all([a.ok?a.text():Promise.resolve(null),r.ok?r.text():Promise.resolve(null),i.ok?i.text():Promise.resolve(null)]);this.initTblInfo(),null!==s?(this.input_tbl.tbl=JSON.parse(s).input_tbl,this.input_tbl.instance.updateData(this.input_tbl.tbl),this.updateRootArea()):t.push(`Failed to load data from ${e}`),null!==l?this.editor.mappingSpec.code=l:t.push(`Failed to load spec from ${e}`),null!==o?this.editor.transformScript.code=o:t.push(`Failed to load script from ${e}`)}catch(a){t.push(`Error loading data: ${a}`)}return this.currentCase=e,t},updateRootArea(e=[]){const{rootArea:t,tidyData:n}=V(this.input_tbl.tbl,e);return this.editor.rootArea.object=t,this.editor.rootArea.code=F(t),n},highlightTblCells(e,t){if(this[e].instance.updateSettings({cell:t}),this[e].cells=t.map((e=>[e.row,e.col])),this[e].cells.length){let t=this.startPoint(this[e].cells);this[e].instance.scrollViewportTo({row:t[0],col:t[1],verticalSnap:"top",horizontalSnap:"start"})}},highlightMinimapCells(e){f.Ubm("g.matrix rect.grid-cell").attr("fill",X.default.fill).attr("stroke",X.default.stroke),f.Ubm("g.matrix text.grid-text").attr("fill",X.default.text).attr("font-weight","normal"),e.forEach((e=>{e.className&&(f.Ltv(`g.matrix #grid-${e.row}-${e.col}`).attr("fill",X[e.className].fill).attr("stroke",X[e.className].stroke),f.Ltv(`g.matrix #text-${e.row}-${e.col}`).attr("fill",X[e.className].text).attr("font-weight",X[e.className].weight||"normal"))}))},in_out_mapping(e,t){const n="input_tbl"===t?this.input_tbl.in2out:this.output_tbl.out2in;if(0===Object.keys(n).length)return[];let a=[],r=[];for(let i in e)e[i].forEach((e=>{r=r.concat(n[`[${e[0]},${e[1]}]`])}));return r&&r.forEach((e=>{if(e&&e.startsWith("[")&&e.endsWith("]")){let t=JSON.parse(e);a.push({row:t[0],col:t[1],className:"posi-mapping"})}})),a},grid_cell_click(e){const t=this.input_tbl.instance.getCell(e.row,e.col);if(t){let n=[{...e,className:"posi-mapping"}];this.highlightTblCells("input_tbl",n),t.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0}))}},startPoint(e){let t=e[0];for(let n=1;n<e.length;n++){let a=e[n];(a[0]<t[0]||a[0]===t[0]&&a[1]<t[1])&&(t=a)}return t},getSpec(){try{let e=this.editor.mappingSpec.code;if(""===e.trim())return!1;e+=this.editor.mappingSpec.codeSuff;const t=U.transpileModule(e,{compilerOptions:{target:U.ScriptTarget.ES2015,module:U.ModuleKind.CommonJS}}),n=new Function("ValueType","sortWithCorrespondingArray",t.outputText),a=n(l,O);return a.forEach((e=>{e.hasOwnProperty("children")||(e.children=[])})),a}catch(e){const t=`Failed to parse the specification:\n ${e}`;return J.Ay.error({content:t,style:{whiteSpace:"pre-line"}}),!1}},transformTablebyCode(){try{const e=this.getSpec();if(!1===e)return;const t=this.updateRootArea(e);if(this.initTblInfo(!1),0===Object.keys(t).length)return void J.Ay.warning({content:"The output table is empty based on the specification.",style:{whiteSpace:"pre-line"}});this.derivePosiMapping(t),this.output_tbl.instance.updateData(this.output_tbl.tbl),this.output_tbl.instance.updateSettings({colHeaders:this.output_tbl.cols})}catch(e){let t;console.log(e),t=e instanceof z?`Failed to transform the table based on the specification:\n ${e}`:`Failed to parse the specification:\n ${e}`,J.Ay.error({content:t,style:{whiteSpace:"pre-line"}})}},derivePosiMapping(e){const t=Object.keys(e);this.output_tbl.cols=t;const n=Math.max(...t.map((t=>e[t].length)));for(let a=0;a<n;a++){const n=[];for(let r=0;r<t.length;r++){const i=t[r];let s;s=e[i].length<=a?{x:-1,y:-1,value:void 0}:e[i][a],n.push(s.value);let l=`[${s.y},${s.x}]`;const o=`[${a},${r}]`;s.x<0||s.y<0?l="":this.input_tbl.in2out.hasOwnProperty(l)?this.input_tbl.in2out[l].push(o):this.input_tbl.in2out[l]=[o],this.output_tbl.out2in.hasOwnProperty(o)?this.output_tbl.out2in[o].push(l):this.output_tbl.out2in[o]=[l]}this.output_tbl.tbl.push(n)}},initTblInfo(e=!0){e&&(this.input_tbl.tbl=[],this.input_tbl.instance.updateData(this.input_tbl.tbl)),this.input_tbl.cells=[],this.input_tbl.in2out={},this.output_tbl.tbl=[],this.output_tbl.cols=[],this.output_tbl.cells=[],this.output_tbl.out2in={},this.output_tbl.instance.updateData(this.output_tbl.tbl),this.output_tbl.instance.updateSettings({colHeaders:this.output_tbl.cols})},deleteChildrenByPath(e){if(0===e.length)return;const t=e.slice(0,-1),n=e[e.length-1];if(0===t.length)return void(this.spec.visTree.children=[]);const a=this.getSpecbyPath(t);a&&a.children&&(a.children.splice(n,1),0===a.children.length&&delete a.children)},getSpecbyPath(e){if(0===e.length)return this.spec.visTree;let t=this.spec.visTree.children;for(let n=0;n<e.length;n++){const a=e[n];if(!t[a])return null;if(n===e.length-1)return t[a];t=t[a].children||[]}return null},stringifySpec(){let e=[],t=JSON.stringify(this.spec.visTree.children,i,2);e.forEach((e=>{t=t.replace('"$TableTidier$"',e)}));const n=/"(\w+)":/g;t=t.replace(n,"$1:");const a=/"TableTidier\.(\w+)"/g;function r(e){return e.replace(/ {2,}/g,(e=>{const t=e.length,n=t/2;return" ".repeat(n)}))}function i(t,n){return"function"===typeof n?(e.push(r(n.toString())),"$TableTidier$"):n}t=t.replace(a,"ValueType.$1"),this.editor.mappingSpec.code=this.editor.mappingSpec.codePref+t},selectArea(){const e=this.spec.selectNode,t=this.getSpecbyPath(e.path);console.log(e.path,t,this.spec.visTree),null!==t?(t.children?t.children.push({}):t.children=[{}],this.stringifySpec()):J.Ay.error("The node path is invalid")}},getters:{}});var q=n(93230);const Y={class:"view"},Z={class:"view-title"},Q=(0,r.Lk)("span",{class:"head-text"}," Input Table ",-1),ee={class:"toolbar",style:{float:"right","margin-right":"5px"}},te={class:"controller"},ne=(0,r.Lk)("span",null,"Upload",-1),ae={class:"view-content"},re={id:"input-tbl"},ie={class:"view"},se={class:"view-title"},le=(0,r.Lk)("span",null,"Output Table",-1),oe={style:{float:"right","margin-right":"30px"}},ce=(0,r.Lk)("span",null,"Download",-1),ue={class:"view-content"},de={id:"output-tbl"};var he=(0,r.pM)({__name:"InOutTable",setup(e){(0,u.um)();const t=G(),n=(0,o.KR)(t.output_tbl.cols),a=(0,o.KR)(t.output_tbl.tbl),i=(0,o.KR)(t.input_tbl.tbl);let s=(0,o.KR)([]);s.value=t.caseList.map((e=>({value:e,label:e})));let l,h,f=(0,o.KR)(t.caseList[0]);function p(e,t,n,a,r,i,s){d.Ay.renderers.TextRenderer.apply(this,arguments),t.innerHTML=`<div class="truncated">${i}</div>`}const g=(0,o.KR)([]),b=e=>{try{const n=new FileReader;n.onload=n=>{const a=n.target?.result,r=q.LF(a,{type:"array"}),i=r.SheetNames[0],s=r.Sheets[i],l=q.Wp.sheet_to_json(s,{header:1}),o=Math.max(...l.map((e=>e.length))),c=l.map((e=>{while(e.length<o)e.push(void 0);return e}));t.initTblInfo(),t.input_tbl.tbl=c,t.input_tbl.instance.updateData(c),t.updateRootArea(),e.onSuccess("ok")},n.readAsArrayBuffer(e.file)}catch(n){J.Ay.error({content:`${e.file.name} file uploaded failed.\n${n}`,style:{whiteSpace:"pre-line"}})}},v=()=>{t.initTblInfo(),t.updateRootArea()};function m(e){return e.map((e=>e.map((e=>`${void 0===e?"":e}`)).join(","))).join("\n")}const y=()=>{if(0===t.output_tbl.cols.length)return void J.Ay.warning("The output table is empty.");const e=m([t.output_tbl.cols,...t.output_tbl.tbl]),n=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(n),r=document.createElement("a");r.href=a,r.download="tidy table.csv",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a),J.Ay.success("The output table has been downloaded successfully.")};function x(e){let n,a;const r="input_tbl"===e?"output_tbl":"input_tbl";"input_tbl"===e?(n=l,a=h):(n=h,a=l),n.updateSettings({outsideClickDeselects:n=>"wtHolder"!==n?.className&&(a.updateSettings({cell:[]}),"output_tbl"===e&&t.highlightMinimapCells([]),!0)}),n.addHook("afterOnCellMouseDown",(()=>{a.updateSettings({cell:[]})})),n.addHook("afterOnCellMouseUp",((a,i,s)=>{if(t.specMode)return;const l=n.getSelected()||[];let o={},c=[];l.forEach((e=>{let t=e[0],n=e[1],a=e[2],r=e[3];t>a&&([t,a]=[a,t]),n>r&&([n,r]=[r,n]),o[e.toString()]=[];for(let i=t;i<=a;i++)for(let t=n;t<=r;t++)o[e.toString()].push([i,t]),c.push({row:i,col:t,className:"posi-mapping"})}));const u=t.in_out_mapping(o,e);if(t.highlightTblCells(r,u),"output_tbl"===e?t.highlightMinimapCells(u):t.highlightMinimapCells(c),"input_tbl"===e&&t.spec.selectAreaFlag){const e=t.spec.areaConfig;e.startCell={referenceAreaLayer:"root",referenceAreaPosi:"topLeft",xOffset:l[0][1],yOffset:l[0][0]},e.size={width:l[0][3]-l[0][1]+1,height:l[0][2]-l[0][0]+1};const n=t.spec.areaFormData;n.referenceAreaLayer=e.startCell?.referenceAreaLayer,n.referenceAreaPosi=e.startCell?.referenceAreaPosi,n.position={x:e.startCell?.xOffset,y:e.startCell?.yOffset},n.traverse={xDirection:e.traverse?.xDirection,yDirection:e.traverse?.yDirection},n.size={width:e.size?.width,height:e.size?.height},t.spec.dragConfigOpen=!0}}))}function k(e){f.value=e,g.value=[],t.loadCaseData(e)}return(0,r.sV)((()=>{const e=(0,r.nI)()?.proxy;l=e.$refs.inputTbl.hotInstance,h=e.$refs.outputTbl.hotInstance,t.input_tbl.instance=l,t.output_tbl.instance=h,x("input_tbl"),x("output_tbl"),k(f.value)})),(e,t)=>{const l=(0,r.g2)("a-select"),u=(0,r.g2)("v-icon"),d=(0,r.g2)("a-button"),h=(0,r.g2)("a-upload"),m=(0,r.g2)("a-space");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("div",Y,[(0,r.Lk)("div",Z,[Q,(0,r.Lk)("span",ee,[(0,r.Lk)("span",te,[(0,r.bF)(m,null,{default:(0,r.k6)((()=>[(0,r.bF)(l,{ref:"select",value:(0,o.R1)(f),options:(0,o.R1)(s),size:"small",onChange:k},null,8,["value","options"]),(0,r.bF)(h,{"file-list":g.value,"onUpdate:fileList":t[0]||(t[0]=e=>g.value=e),"max-count":1,accept:".csv, .txt, .xls, .xlsx",customRequest:b,onRemove:v},{default:(0,r.k6)((()=>[(0,r.bF)(d,{size:"small"},{default:(0,r.k6)((()=>[(0,r.bF)(u,{name:"bi-upload",scale:"0.85"}),ne])),_:1})])),_:1},8,["file-list"])])),_:1})])])]),(0,r.Lk)("div",ae,[(0,r.Lk)("div",re,[(0,r.bF)((0,o.R1)(c.sH),{ref:"inputTbl",data:i.value,rowHeaders:!0,colHeaders:!0,manualColumnResize:!0,renderer:p,contextMenu:!0,licenseKey:"non-commercial-and-evaluation"},null,8,["data"])])])]),(0,r.Lk)("div",ie,[(0,r.Lk)("div",se,[le,(0,r.Lk)("span",oe,[(0,r.bF)(d,{size:"small",onClick:y},{default:(0,r.k6)((()=>[(0,r.bF)(u,{name:"bi-download",scale:"0.85"}),ce])),_:1})])]),(0,r.Lk)("div",ue,[(0,r.Lk)("div",de,[(0,r.bF)((0,o.R1)(c.sH),{ref:"outputTbl",data:a.value,rowHeaders:!0,colHeaders:n.value,manualColumnResize:!0,renderer:p,contextMenu:!0,licenseKey:"non-commercial-and-evaluation"},null,8,["data","colHeaders"])])])])],64)}}});const fe=he;var pe=fe,ge=n(42336),be=n(78626),ve=(0,r.pM)({__name:"CodeView",props:{codeType:{}},setup(e){const{codeType:t}=e,n=G(),a={value:"",language:n.editor[t].language,theme:"vs",fontSize:14,glyphMargin:!1,automaticLayout:!1,autoIndent:"advanced",readOnly:!1,minimap:{enabled:"rootArea"===t},lineNumbersMinChars:1,scrollBeyondLastLine:!1,padding:{bottom:80}},i=(0,o.KR)(null);let s=null;const l=/\s+/g,c=(e,t)=>e.replace(l,"")===t.replace(l,""),u=()=>{s&&s.dispose();const e={...a,value:n.editor[t].code};s=ge.EN.create(i.value,e),s.onDidBlurEditorText((async()=>{const e=ge.EN.getModelMarkers({});if(e.length>0){const t=e[0].startLineNumber;return void J.Ay.error(`Invalid syntax at Line ${t}: ${e[0].message}`)}const a=s.getValue();c(n.editor[t].code,a)||(n.editor[t].code=a)}))};(0,r.wB)((()=>n.editor[t].code),(e=>{s?.setValue(e)}));const d=(0,be.debounce)((()=>{s&&s.layout()}),100);new ResizeObserver((()=>{d()}));if("mappingSpec"===t){const e="ts:grammar.ts",t=ge.EN.getModels().find((t=>t.uri.toString()===e));t||fetch("./grammar.ts").then((t=>{t.text().then((t=>{ge.eo.typescript.javascriptDefaults.setDiagnosticsOptions({noSemanticValidation:!0,noSyntaxValidation:!1}),ge.eo.typescript.javascriptDefaults.setCompilerOptions({target:ge.eo.typescript.ScriptTarget.ES2015,allowNonTsExtensions:!0}),ge.eo.typescript.javascriptDefaults.addExtraLib(t,e),ge.EN.createModel(t,"typescript",ge.zn.parse(e))}))}))}return(0,r.sV)((()=>{u(),s&&(n.editor[t].instance=s)})),(0,r.hi)((()=>{s&&s.dispose()})),(e,t)=>((0,r.uX)(),(0,r.CE)("div",{ref_key:"editorWrapper",ref:i,class:"editor-container"},null,512))}}),me=n(71241);const ye=(0,me.A)(ve,[["__scopeId","data-v-3a5c560d"]]);var xe=ye;const ke={class:"view"},je={class:"view-title"},$e=(0,r.Lk)("span",null,"Mapping Minimap",-1),we=(0,r.Lk)("span",null,"Reset",-1),Ae={class:"view-content"};var Le=(0,r.pM)({__name:"Minimap",setup(e){const t=G(),n=(0,o.KR)(null);let a,i=0,s=0,l=null;function c(){l&&n.value&&f.Ltv(n.value).select("svg").transition().duration(750).call(l.transform,f.GSI)}function u(e,t){const n=[];for(let a=0;a<e;a++)for(let e=0;e<t;e++)n.push({row:a,col:e});return n}const d=(e,r)=>{if(!n.value)return;f.Ltv(n.value).selectAll("svg").remove();const o=n.value.clientWidth,c=n.value.clientHeight;let d=Math.max(5,Math.min(45,Math.floor(o/r))),h=Math.max(5,Math.min(20,Math.floor(c/e)));d=h=Math.min(d,h),l=f.s_O().on("zoom",(function(e){f.Ltv("g.matrix").attr("transform",`translate(${i+e.transform.x}, ${s+e.transform.y}) scale(${e.transform.k})`),m(e.transform.k)}));const p=f.Ltv(n.value).append("svg").attr("width",o).attr("height",c).call(l),g=p.append("g").classed("matrix",!0);let b=null;const v=u(e,r);g.selectAll("rect").data(v).enter().append("rect").classed("grid-cell",!0).attr("x",(e=>e.col*d)).attr("y",(e=>e.row*h)).attr("id",(e=>`grid-${e.row}-${e.col}`)).attr("width",d).attr("height",h).attr("fill","#f9f7ff").attr("stroke","#cccccc").on("mouseover",(function(){f.Ltv(this).raise().attr("stroke-width",2),b&&b.raise()})).on("mouseout",(function(){f.Ltv(this).attr("stroke-width",1)})).on("click",(function(e,n){t.grid_cell_click({row:n.row,col:n.col})}));i=Math.max((o-g.node().getBBox().width)/2,0),s=Math.max((c-g.node().getBBox().height)/2,0),g.attr("transform",`translate(${i}, ${s})`),a=f.GSI;const m=e=>{const t=d*e,n=h*e;t>=45&&n>=20?b?b.style("display","block"):b=g.selectAll("text").data(v).enter().append("text").classed("grid-text",!0).attr("x",(e=>e.col*d+d/2)).attr("y",(e=>e.row*h+h/2)).attr("id",(e=>`text-${e.row}-${e.col}`)).attr("dy",".30em").attr("font-size",15/e).attr("fill","#000").attr("text-anchor","middle").text((e=>`(${e.row}, ${e.col})`)).style("display","block").style("pointer-events","none"):b&&b.style("display","none")};m(1)},h=(0,be.debounce)((()=>{0===t.input_tbl.tbl.length?f.Ltv(n.value).selectAll("svg").remove():d(t.input_tbl.tbl.length,t.input_tbl.tbl[0].length)}),100);new ResizeObserver((()=>{h()}));return(0,r.sV)((()=>{n.value})),(0,r.wB)((()=>t.input_tbl.tbl),(e=>{0===e.length?f.Ltv(n.value).selectAll("svg").remove():d(e.length,e[0].length)})),(e,t)=>{const a=(0,r.g2)("v-icon"),i=(0,r.g2)("a-button");return(0,r.uX)(),(0,r.CE)("div",ke,[(0,r.Lk)("div",je,[$e,(0,r.bF)(i,{size:"small",style:{float:"right","margin-right":"20px"},onClick:c},{default:(0,r.k6)((()=>[(0,r.bF)(a,{name:"bi-arrow-clockwise",scale:"0.9"}),we])),_:1})]),(0,r.Lk)("div",Ae,[(0,r.Lk)("div",{ref_key:"container",ref:n,class:"grid-container"},null,512)])])}}});const _e=Le;var Ce=_e,Te=n(91114);const Se={position:"#83b5ed",context:"#7EAA55",value:"#D07C94",null:"#EEB189"},ze={nodeWidth:105,nodeHeight:30,nodeRectFillColor:"#7EAA55",nodeCircleFillColor:"#83b5ed",nodeCircleRadius:15,nodeBorderRadius:5,verticalLineLength:40,verticalLineWidth:5,nodeSpacing:30,connectorLineColor:"#0000004D",connectorLineWidth:1.5},Me={color:"white",fontSize:15,yAxisAdjust:2};function Oe(e){const{startx:t,starty:n,rectWidth:a,rectHeight:r,rounded:i,radius:s}=e;let l;switch(i){case"left":l=`\n      M${t+s},${n+s}\n      a${s},${s} 0 0 1 ${s},-${s}\n      h${a-s}\n      v${r}\n      h${-a+s}\n      a${s},${s} 0 0 1 -${s},-${s}\n      z\n      `;break;case"right":l=`\n      M${t},${n}\n      h${a-s}\n      a${s},${s} 0 0 1 ${s},${s}\n      v${r-2*s}\n      a${s},${s} 0 0 1 ${-s},${s}\n      h ${s-a}\n      z\n      `;break;case"top":l=`\n      M${t},${n+s}\n      a${s},${s} 0 0 1 ${s},-${s}\n      h${a-2*s}\n      a${s},${s} 0 0 1 ${s},${s}\n      v${r-s}\n      h${-a}\n      z`;break;case"bottom":l=`\n      M${t},${n}\n      h${a}\n      v${r-s}\n      a${s},${s} 0 0 1 ${-s},${s}\n      h${2*s-a}\n      a${s},${s} 0 0 1 -${s},-${s}\n      z`;break;case"all":l=`\n      M${t},${n+s}\n      a${s},${s} 0 0 1 ${s},-${s}\n      h${a-2*s}\n      a${s},${s} 0 0 1 ${s},${s}\n      v${r-2*s}\n      a${s},${s} 0 0 1 ${-s},${s}\n      h${2*s-a}\n      a${s},${s} 0 0 1 -${s},-${s}\n      z`;break;default:l=`\n      M${t}${n}\n      h${a}\n      v${r}\n      h${-a}\n      v${-r}\n      z\n      `;break}return l}class Fe{constructor(e,t,n,a,r=1,i="h"){(0,Te.A)(this,"svgWidth",void 0),(0,Te.A)(this,"svgHeight",void 0),(0,Te.A)(this,"margins",void 0),(0,Te.A)(this,"container",void 0),(0,Te.A)(this,"data",void 0),(0,Te.A)(this,"zoomLevel",void 0),(0,Te.A)(this,"depth",void 0),(0,Te.A)(this,"calculated",void 0),(0,Te.A)(this,"treeLayout",void 0),(0,Te.A)(this,"realChart",void 0),(0,Te.A)(this,"previousTransform",void 0),(0,Te.A)(this,"centerG",void 0),(0,Te.A)(this,"centerX",void 0),(0,Te.A)(this,"root",void 0),(0,Te.A)(this,"allNodes",void 0),(0,Te.A)(this,"defaultFont",void 0),(0,Te.A)(this,"duration",void 0),(0,Te.A)(this,"store",void 0),(0,Te.A)(this,"orient",void 0),this.svgWidth=500,this.svgHeight=500,this.margins=e,this.container=t,this.zoomLevel=r,this.orient=i,this.depth=10,this.calculated={},this.treeLayout=null,this.realChart=null,this.previousTransform=null,this.centerX=0,this.root=null,this.allNodes=null,this.defaultFont="Helevtica",this.duration=600,this.data=n,this.store=a,this.zoomed.bind(this),this.setZoomFactor.bind(this),this.batchEnterExitUpdate()}setZoomFactor(){const e=this.centerG.node().getBoundingClientRect().width;let t=this.svgWidth/e;t=t>1?1:t,this.zoomLevel=t,"h"===this.orient?this.centerG.attr("transform",`translate(${this.calculated.nodeMaxWidth/2}, ${this.calculated.centerY}) scale(${t})`):this.centerG.attr("transform",`translate(${this.calculated.centerX}, ${this.calculated.nodeMaxHeight/2}) scale(${t})`)}zoomed(e){this.previousTransform=e.transform,this.realChart.attr("transform",e.transform)}declareContextMenu(e,t){e.preventDefault(),null===t.parent?this.store.tree.menuList=[this.store.tree.menuAllList[3]]:this.store.tree.menuList=this.store.tree.menuAllList,this.store.spec.selectNode=t,this.store.tree.contextMenuVisible=!0}batchEnterExitUpdate(){f.r1M.prototype.patternify=function(e){const{tag:t,selector:n}=e,a=e.targetData||[n],r=this.selectAll(`.${n}`).data(a,((e,t)=>"object"===typeof e&&e.id?e.id:t));r.exit().remove();const i=r.enter().append(t).merge(r);return i.attr("class",n),i}}addPathToNodes(e,t=[]){e&&e.forEach(((e,n)=>{const a=[...t,n];e.path=a,this.addPathToNodes(e.children,a)}))}render(){const e=f.Ltv(this.container);e.node().replaceChildren();const t=e.node().getBoundingClientRect();t.width>0&&(this.svgWidth=t.width,this.svgHeight=t.height);const n=ze.nodeWidth,a=ze.nodeHeight;if(this.calculated={id:`ID${Math.floor(1e6*Math.random())}`,chartVerticalMargin:this.margins[0],chartHorizontalMargin:this.margins[1],chartWidth:this.svgWidth-2*this.margins[0],chartHeight:this.svgHeight-2*this.margins[1],nodeMaxWidth:n,nodeMaxHeight:a,centerX:(this.svgWidth-2*this.margins[0])/2,centerY:(this.svgHeight-2*this.margins[1])/2},this.depth="h"===this.orient?n/2:a+20,this.treeLayout=f.B22().size([this.calculated.chartWidth,this.calculated.chartHeight]),"h"===this.orient?this.treeLayout.nodeSize([this.calculated.nodeMaxHeight+ze.nodeSpacing,this.calculated.nodeMaxWidth+this.depth]):this.treeLayout.nodeSize([this.calculated.nodeMaxWidth+ze.nodeSpacing,this.calculated.nodeMaxHeight+this.depth]),Array.isArray(this.data))this.root=f.zTO().id((e=>e.nodeId)).parentId((e=>e.parentNodeId))(this.data);else{this.root=f.Sk5(this.data,(e=>e.children));let e=0;this.root.each((t=>{t.id=e++;const n=t.data;void 0===n.transform||null===n.transform?t.type="null":Array.isArray(n.transform.targetCols)?t.type="position":"context"===n.transform.targetCols?t.type="context":t.type="value"})),this.root.path=[],this.addPathToNodes(this.root.children)}this.root.x0=0,this.root.y0=0;const r=f.s_O().on("zoom",this.zoomed.bind(this)).bind(this),i=e.patternify({tag:"svg",selector:"svg-chart-container"}).attr("width",this.svgWidth).attr("height",this.svgHeight).attr("font-family",this.defaultFont).call(r.bind(this)).on("dblclick.zoom",null),s=i.patternify({tag:"g",selector:"chart"}).attr("transform",`translate(${this.calculated.chartHorizontalMargin}, ${this.calculated.chartVerticalMargin})`);this.realChart=s;const l=s.patternify({tag:"g",selector:"center-group"}).attr("transform","h"===this.orient?`translate(${n}, ${this.calculated.centerY}) scale(${this.zoomLevel})`:`translate(${this.calculated.centerX}, ${this.calculated.nodeMaxHeight/2}) scale(${this.zoomLevel})`);return this.centerG=l,this.update(this.root),this}update(e){const t=this.treeLayout(this.root),n=t.descendants().slice(1),a=t.descendants();"h"===this.orient&&a.forEach(((e,t)=>{const n=e.x;e.x=e.y,e.y=n,0===t&&(e.x=2*ze.nodeCircleRadius)}));const{x0:r,y0:i,x:s,y:l}=e,o=this.centerG.selectAll("path.link").data(n,(e=>e.id)),c=f.pqs(),u=o.enter().insert("path","g").attr("class","link").attr("d",(()=>{const e={source:[r,i],target:[r,i]};return c(e)})),d=u.merge(o);d.attr("fill","none").attr("stroke-width",ze.connectorLineWidth).attr("stroke",ze.connectorLineColor),d.transition().duration(this.duration).attr("d",(e=>{let t=ze.nodeWidth/2;const n=0,a=-ze.nodeWidth/2,r=0;"0"==e.parent.id&&(t=ze.nodeCircleRadius);const i={source:[e.parent.x+t,e.parent.y+n],target:[e.x+a,e.y+r]};return c(i)}));o.exit().transition().duration(this.duration).attr("d",(()=>{const e={source:[s,l],target:[s,l]};return c(e)})).remove();const h=this.centerG.selectAll("g.node").data(a,(e=>e.id)),p=h.enter().append("g").attr("class","node").attr("transform",(()=>`translate(${r}, ${i})`)).attr("cursor","pointer"),g=p.patternify({tag:"g",selector:"node-group",targetData:e=>[e]}),b=p.merge(h);b.transition().attr("opaicty",0).duration(this.duration).attr("transform",(e=>`translate(${e.x}, ${e.y})`)).attr("opacity",1),g.attr("transform",(()=>`translate(${-ze.nodeWidth/2}, ${-ze.nodeHeight/2})`)),g.each((function(e){const t=f.Ltv(this);if(null===e.parent)return t.patternify({tag:"circle",selector:`node-circle-${e.id}`}),void g.select(`.node-circle-${e.id}`).attr("class",`node-circle-${e.id} type-node`).attr("r",ze.nodeCircleRadius).attr("fill",(({type:e})=>Se[e])).attr("transform",`translate(${ze.nodeWidth/2}, ${ze.nodeHeight/2})`).attr("cursor","pointer");const n={rectHeight:ze.nodeHeight,rectWidth:ze.nodeWidth,starty:0,startx:0,radius:5,rounded:"all"};t.patternify({tag:"path",selector:`multi-type-rect-${e.id}`}),g.select(`.multi-type-rect-${e.id}`).attr("class",`multi-type-rect-${e.id} type-node`).attr("d",Oe(n)).attr("fill",(({type:e})=>Se[e])).attr("cursor","pointer")}));const v=b.patternify({tag:"g",selector:"node-text-g",targetData:e=>[e]});v.patternify({tag:"text",selector:"node-text"}),v.patternify({tag:"svg:title",selector:"node-tooltip"}),v.select(".node-text").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("fill",Me.color).attr("font-size",Me.fontSize).attr("y",(()=>Me.yAxisAdjust)).attr("cursor","pinter").attr("pointer-events","auto").text((e=>{if(0===e.id)return"0";{const t=S(e.data),n=t.size.width,a=t.size.height;return`(${n}, ${a})`}})),v.select(".node-tooltip").text((e=>"Path: "+JSON.stringify(e.path))),f.Ubm(".type-node, .node-text-g").on("contextmenu",this.declareContextMenu.bind(this)).on("click",((e,t)=>{e.stopPropagation(),console.log(e,t)}));h.exit().attr("opacity",1).transition().duration(this.duration).attr("transform",`translate(${s},${l})`).on("end",(function(){f.Ltv(this).remove()})).attr("opacity",0);a.forEach((e=>{e.x0=e.x,e.y0=e.y}))}}const Ee=e=>((0,r.Qi)("data-v-60e23df2"),e=e(),(0,r.jt)(),e),Re={class:"view"},Ne={class:"view-title"},Pe=Ee((()=>(0,r.Lk)("span",null,"Template Visualization",-1))),De=Ee((()=>(0,r.Lk)("span",null,"Reset",-1))),Ie={class:"view-content"};var We=(0,r.pM)({__name:"TemplateVis",setup(e){const t=G(),n=(0,r.EW)((()=>t.tree.menuList)),a=(0,r.EW)((()=>t.tree.contextMenuVisible&&t.tree.menuList.length>0)),i=e=>{t.tree.contextMenuVisible=e,setTimeout((()=>{t.tree.menuList=[]}),200)},s=e=>{const n=t.spec.selectNode;switch(e.key){case"0":break;case"1":break;case"2-0":break;case"2-1":break;case"2-2":break;case"3":J.Ay.info("Please select an area in the input table."),t.spec.selectAreaFlag=!0;break;case"4":t.deleteChildrenByPath(n.path),t.stringifySpec();break}t.tree.contextMenuVisible=!1},l=(0,o.KR)(null);function c(){u(t.spec.visTree)}const u=e=>{const n=new Fe([2,1],".tree-container",e,t,1,"h");n.render()},d=(0,be.debounce)((()=>{u(t.spec.visTree)}),100);new ResizeObserver((()=>{d()}));return(0,r.wB)((()=>t.editor.mappingSpec.code),(e=>{const n=t.getSpec();!1!==n&&(t.spec.visTree["children"]=n,u(t.spec.visTree))})),(0,r.sV)((()=>{l.value,u(t.spec.visTree)})),(e,t)=>{const o=(0,r.g2)("v-icon"),u=(0,r.g2)("a-button"),d=(0,r.g2)("a-menu"),h=(0,r.g2)("a-dropdown");return(0,r.uX)(),(0,r.CE)("div",Re,[(0,r.Lk)("div",Ne,[Pe,(0,r.bF)(u,{size:"small",style:{float:"right","margin-right":"20px"},onClick:c},{default:(0,r.k6)((()=>[(0,r.bF)(o,{name:"bi-arrow-clockwise",scale:"0.9"}),De])),_:1})]),(0,r.Lk)("div",Ie,[(0,r.bF)(h,{trigger:["contextmenu"],open:a.value,onOpenChange:i},{overlay:(0,r.k6)((()=>[(0,r.bF)(d,{onClick:s,items:n.value},null,8,["items"])])),default:(0,r.k6)((()=>[(0,r.Lk)("div",{class:"tree-container",ref_key:"treeContainer",ref:l},null,512)])),_:1},8,["open"])])])}}});const He=(0,me.A)(We,[["__scopeId","data-v-60e23df2"]]);var Be=He,Ke=n(24232),Ve=n(77398),Je=(0,r.pM)({__name:"DraggableModal",setup(e){const t=G(),n=(t.spec.areaConfig,(0,o.KR)(t.spec.areaFormData));t.spec.areaFormData=n.value;const a=(0,r.EW)((()=>t.spec.dragConfigOpen)),i=(0,o.KR)(),{x:s,y:l,isDragging:c}=(0,Ve.PMY)(i),u=()=>{t.spec.dragConfigOpen=!1,t.spec.selectAreaFlag=!1},d=(0,o.KR)(0),h=(0,o.KR)(0),f=(0,o.KR)(!1),p=(0,o.KR)(0),g=(0,o.KR)(0),b=(0,o.KR)(0),v=(0,o.KR)(0),m=(0,o.KR)({left:0,right:0,top:0,bottom:0});(0,r.wB)([s,l],(()=>{if(!f.value){d.value=s.value,h.value=l.value;const e=document.body.getBoundingClientRect(),t=i.value.getBoundingClientRect();m.value.right=e.width-t.width,m.value.bottom=e.height-t.height,b.value=p.value,v.value=g.value}f.value=!0})),(0,r.wB)(c,(()=>{c||(f.value=!1)})),(0,r.nT)((()=>{f.value&&(p.value=b.value+Math.min(Math.max(m.value.left,s.value),m.value.right)-d.value,g.value=v.value+Math.min(Math.max(m.value.top,l.value),m.value.bottom)-h.value)}));const y=(0,r.EW)((()=>({transform:`translate(${p.value}px, ${g.value}px)`})));return(e,t)=>{const s=(0,r.g2)("a-col"),l=(0,r.g2)("a-radio-button"),o=(0,r.g2)("a-radio-group"),c=(0,r.g2)("a-row"),d=(0,r.g2)("a-modal");return(0,r.uX)(),(0,r.Wv)(d,{ref:"modalRef",open:a.value,"onUpdate:open":t[2]||(t[2]=e=>a.value=e),"wrap-style":{overflow:"hidden"},onCancel:u,width:"600px"},{title:(0,r.k6)((()=>[(0,r.Lk)("div",{ref_key:"modalTitleRef",ref:i,style:{width:"100%",cursor:"move"}},"Template Area",512)])),modalRender:(0,r.k6)((({originVNode:e})=>[(0,r.Lk)("div",{style:(0,Ke.Tr)(y.value)},[((0,r.uX)(),(0,r.Wv)((0,r.$y)(e)))],4)])),default:(0,r.k6)((()=>[(0,r.Lk)("div",null,[(0,r.bF)(c,null,{default:(0,r.k6)((()=>[(0,r.bF)(s,{flex:"100px"},{default:(0,r.k6)((()=>[(0,r.eW)("referenceAreaLayer")])),_:1}),(0,r.bF)(s,{flex:"auto"},{default:(0,r.k6)((()=>[(0,r.bF)(o,{value:n.value.referenceAreaLayer,"onUpdate:value":t[0]||(t[0]=e=>n.value.referenceAreaLayer=e)},{default:(0,r.k6)((()=>[(0,r.bF)(l,{value:"current"},{default:(0,r.k6)((()=>[(0,r.eW)("current")])),_:1}),(0,r.bF)(l,{value:"parent"},{default:(0,r.k6)((()=>[(0,r.eW)("parent")])),_:1}),(0,r.bF)(l,{value:"root"},{default:(0,r.k6)((()=>[(0,r.eW)("root")])),_:1}),(0,r.bF)(l,{value:"function"},{default:(0,r.k6)((()=>[(0,r.eW)("areaLayerFn")])),_:1})])),_:1},8,["value"])])),_:1})])),_:1}),(0,r.bF)(c,null,{default:(0,r.k6)((()=>[(0,r.bF)(s,{flex:"100px"},{default:(0,r.k6)((()=>[(0,r.eW)("referenceAreaPosition")])),_:1}),(0,r.bF)(s,{flex:"auto"},{default:(0,r.k6)((()=>[(0,r.bF)(o,{value:n.value.referenceAreaPosi,"onUpdate:value":t[1]||(t[1]=e=>n.value.referenceAreaPosi=e)},{default:(0,r.k6)((()=>[(0,r.bF)(l,{value:"topLeft"},{default:(0,r.k6)((()=>[(0,r.eW)("topLeft")])),_:1}),(0,r.bF)(l,{value:"topRight"},{default:(0,r.k6)((()=>[(0,r.eW)("topRight")])),_:1}),(0,r.bF)(l,{value:"bottomLeft"},{default:(0,r.k6)((()=>[(0,r.eW)("bottomLeft")])),_:1}),(0,r.bF)(l,{value:"bottomRight"},{default:(0,r.k6)((()=>[(0,r.eW)("bottomRight")])),_:1})])),_:1},8,["value"])])),_:1})])),_:1})])])),_:1},8,["open"])}}});const Ue=Je;var Xe=Ue;const Ge={id:"panel"},qe=(0,r.Lk)("div",{class:"system-name"},[(0,r.Lk)("span",null,"TableTidier")],-1),Ye={class:"main-views"},Ze={class:"column left"},Qe={class:"column center"},et={class:"column right"},tt={class:"view"},nt={class:"view-title"},at=(0,r.Lk)("span",null,"Code Panel",-1),rt={style:{float:"right","margin-right":"30px"}},it=(0,r.Lk)("span",null,"Run",-1),st={class:"view-content"},lt=(0,r.Lk)("span",null," Mapping Specification ",-1),ot=(0,r.Lk)("span",null," Root Area ",-1),ct=(0,r.Lk)("span",null," Transformation Script ",-1);var ut=(0,r.pM)({__name:"PanelView",setup(e){const t=G(),n=(0,o.KR)("1"),a=(0,o.KR)(!1);(0,o.KR)(!1);function i(){a.value=!0,t.transformTablebyCode(),a.value=!1}return(e,t)=>{const s=(0,r.g2)("v-icon"),l=(0,r.g2)("a-button"),o=(0,r.g2)("a-tab-pane"),c=(0,r.g2)("a-tabs");return(0,r.uX)(),(0,r.CE)("div",Ge,[qe,(0,r.Lk)("div",Ye,[(0,r.Lk)("div",Ze,[(0,r.bF)(pe)]),(0,r.Lk)("div",Qe,[(0,r.bF)(Be),(0,r.bF)(Ce)]),(0,r.Lk)("div",et,[(0,r.Lk)("div",tt,[(0,r.Lk)("div",nt,[at,(0,r.Lk)("span",rt,[(0,r.bF)(l,{size:"small",loading:a.value,onClick:i},{default:(0,r.k6)((()=>[(0,r.bF)(s,{name:"la-rocket-solid",scale:"0.85"}),it])),_:1},8,["loading"])])]),(0,r.Lk)("div",st,[(0,r.bF)(c,{activeKey:n.value,"onUpdate:activeKey":t[0]||(t[0]=e=>n.value=e),type:"card"},{default:(0,r.k6)((()=>[(0,r.bF)(o,{key:"1"},{tab:(0,r.k6)((()=>[lt])),default:(0,r.k6)((()=>[(0,r.bF)(xe,{codeType:"mappingSpec"})])),_:1}),(0,r.bF)(o,{key:"2"},{tab:(0,r.k6)((()=>[ot])),default:(0,r.k6)((()=>[(0,r.bF)(xe,{codeType:"rootArea"})])),_:1}),(0,r.bF)(o,{key:"3"},{tab:(0,r.k6)((()=>[ct])),default:(0,r.k6)((()=>[(0,r.bF)(xe,{codeType:"transformScript"})])),_:1})])),_:1},8,["activeKey"])])])])]),(0,r.bF)(Xe)])}}});const dt=ut;var ht=dt,ft=(0,r.pM)({name:"overView",components:{PanelView:ht}});const pt=(0,me.A)(ft,[["render",s]]);var gt=pt,bt=n(96444),vt=n(34385),mt=n(92278),yt=n(13472),xt=n(35678),kt=n(91328),jt=n(58849),$t=n(25169),wt=n(54467),At=n(6311),Lt=n(52511),_t=n(50931),Ct=n(64089),Tt=n(86135),St=n(63372),zt=n(86789),Mt=n(90070),Ot=n(58856);const Ft=(0,h.Ey)(),Et=(0,a.Ef)(gt);Et.use(Ft).use(bt.Ay).use(vt.A).use(mt.A).use(yt.A).use(xt.A).use(kt.A).use(jt.Ay).use($t.A).use(wt.Ay).use(At.Ay).use(Lt.Ay).use(_t.Ay).use(Ct.A).use(Tt.A).use(St.Ay),(0,zt.oe)(Mt.tAF,Mt.Ah9,Ot.RqA,Mt.rLf),Et.component("v-icon",zt.Ly),Et.mount("#app")},89387:function(e){function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=function(){return[]},t.resolve=t,t.id=89387,e.exports=t},530:function(){},72615:function(){},84021:function(){},66247:function(){},82202:function(){},18641:function(){},97664:function(){}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var i=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=e,function(){n.amdO={}}(),function(){var e=[];n.O=function(t,a,r,i){if(!a){var s=1/0;for(u=0;u<e.length;u++){a=e[u][0],r=e[u][1],i=e[u][2];for(var l=!0,o=0;o<a.length;o++)(!1&i||s>=i)&&Object.keys(n.O).every((function(e){return n.O[e](a[o])}))?a.splice(o--,1):(l=!1,i<s&&(s=i));if(l){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[a,r,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,a){return n.f[a](e,t),t}),[]))}}(),function(){n.u=function(e){return"js/"+e+"."+{9:"3e2dd958",293:"cc93782e",703:"6b8db0f6",1034:"42caa4ea",1157:"54c726b5",1461:"e92bc401",1477:"0459dd6c",1813:"2f919813",1915:"ee11ac6c",2149:"c17c85f9",2365:"7690613b",2412:"5c741462",2501:"cdbbcd03",2591:"2f6c9f6b",2689:"caa4fbec",2709:"64937498",2799:"184b412d",2965:"d2f616e1",2999:"3dc7f79c",3051:"41b30810",3061:"95be68c2",3071:"70d11158",3445:"be87e6ab",3473:"fb9ef58c",3577:"bb18787e",3691:"6bf3f01f",3717:"963c4f9f",3753:"6c4ee3f4",3765:"1d3c04a7",3775:"432c2d2c",3948:"e9f9e8a8",4205:"df37ef01",4261:"e3ee4d76",4341:"e3ef6b64",4373:"b41ecc24",4485:"3ee3fb7e",4605:"41a293b9",4621:"3f170eab",4805:"d62fc659",4977:"c1e040d7",5077:"c5509291",5081:"190db17a",5083:"98214cf7",5093:"be4234f2",5282:"c8216716",5285:"d0610360",5287:"e589cdb8",5303:"8de5c195",5365:"56361d2a",5521:"cf7ee881",5589:"bcad7c5b",5609:"9e498ec2",5653:"70962a1f",5749:"738a857e",5841:"06c82430",6059:"200d1502",6121:"692266a1",6181:"fdb9b6c9",6229:"e201920c",6309:"6df26518",6325:"89f2a27d",6613:"4cf1f45b",6757:"29e39d58",6821:"0225ad68",6845:"9f91df90",7045:"5a9df01c",7217:"553f17c6",7219:"e1cb255c",7449:"bdc47760",7461:"0f9bd863",7525:"28161d09",7623:"4889f846",7641:"dceb5361",8175:"e179abe0",8285:"9d96eeac",8329:"0778de39",8387:"e5098648",8533:"4847834f",8653:"de07fe1d",8981:"61e6e714",9009:"7586e475",9437:"47c6455f",9445:"be745b28",9626:"328e2731",9717:"064a4313"}[e]+".js"}}(),function(){n.miniCssF=function(e){}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="TableTidier:";n.l=function(a,r,i,s){if(e[a])e[a].push(r);else{var l,o;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==a||d.getAttribute("data-webpack")==t+i){l=d;break}}l||(o=!0,l=document.createElement("script"),l.charset="utf-8",l.timeout=120,n.nc&&l.setAttribute("nonce",n.nc),l.setAttribute("data-webpack",t+i),l.src=a),e[a]=[r];var h=function(t,n){l.onerror=l.onload=null,clearTimeout(f);var r=e[a];if(delete e[a],l.parentNode&&l.parentNode.removeChild(l),r&&r.forEach((function(e){return e(n)})),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=h.bind(null,l.onerror),l.onload=h.bind(null,l.onload),o&&document.head.appendChild(l)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){n.p="/TableTidier/"}(),function(){var e={3524:0};n.f.j=function(t,a){var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)a.push(r[2]);else{var i=new Promise((function(n,a){r=e[t]=[n,a]}));a.push(r[2]=i);var s=n.p+n.u(t),l=new Error,o=function(a){if(n.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var i=a&&("load"===a.type?"missing":a.type),s=a&&a.target&&a.target.src;l.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",l.name="ChunkLoadError",l.type=i,l.request=s,r[1](l)}};n.l(s,o,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,a){var r,i,s=a[0],l=a[1],o=a[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(r in l)n.o(l,r)&&(n.m[r]=l[r]);if(o)var u=o(n)}for(t&&t(a);c<s.length;c++)i=s[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(u)},a=self["webpackChunkTableTidier"]=self["webpackChunkTableTidier"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[504],(function(){return n(40315)}));a=n.O(a)})();
//# sourceMappingURL=app.625a2cc9.js.map